"use strict";(self.webpackChunkapp_botstudio_main=self.webpackChunkapp_botstudio_main||[]).push([["62298"],{1333:function(e,t,n){n.d(t,{cg:()=>_,VF:()=>u,_5:()=>g,f:()=>d,HW:()=>a,jG:()=>m,C5:()=>c,Cx:()=>p,CG:()=>s});var i,o=n("938809"),l=n("16242"),r=n("378994");l.o.t("form_mode"),l.o.t("code_mode");var _=[{label:l.o.t("create_plugin_modal_header"),value:1},{label:l.o.t("create_plugin_modal_query"),value:2}],a={header_list:[{type:"title",text:l.o.t("create_plugin_modal_header_list")},{type:"text",text:l.o.t("create_plugin_modal_header_list1")}],auth:[{type:"title",text:l.o.t("create_plugin_modal_info_all")},{type:"br"},{type:"title",text:l.o.t("create_plugin_modal_info_None1")},{type:"text",text:l.o.t("create_plugin_modal_info_None2")},{type:"br"},{type:"title",text:l.o.t("create_plugin_modal_info_Service1")},{type:"text",text:l.o.t("create_plugin_modal_info_Service2")},{type:"br"},{type:"title",text:l.o.t("create_plugin_modal_info_Oauth1")},{type:"text",text:l.o.t("create_plugin_modal_info_Oauth2")}],location:[{type:"title",text:l.o.t("plugin_location_info_all")},{type:"br"},{type:"title",text:l.o.t("plugin_location_info_query")},{type:"text",text:l.o.t("plugin_location_info_query1")},{type:"demo",text:l.o.t("plugin_location_info_query2")},{type:"br"},{type:"title",text:l.o.t("plugin_location_header")},{type:"text",text:l.o.t("plugin_location_header1")},{type:"demo",text:l.o.t("plugin_location_header2")}],service_token:[{type:"title",text:l.o.t("create_plugin_modal_Servicetoken_info1")},{type:"text",text:l.o.t("create_plugin_modal_Servicetoken_info2")}],key:[{type:"title",text:l.o.t("create_plugin_modal_Parameter_info1")},{type:"text",text:l.o.t("create_plugin_modal_Parameter_info2")}],client_id:[{type:"text",text:l.o.t("create_plugin_modal_client_id4")},{type:"demo",text:l.o.t("create_plugin_modal_client_id5")}],client_secret:[{type:"text",text:l.o.t("create_plugin_modal_client_secret4")}],client_url:[{type:"text",text:l.o.t("create_plugin_modal_client_url_info1")},{type:"demo",text:l.o.t("create_plugin_modal_client_url_info2")}],scope:[{type:"text",text:l.o.t("create_plugin_modal_scope_info1")},{type:"demo",text:l.o.t("create_plugin_modal_scope_info2")}],authorization_url:[{type:"text",text:l.o.t("create_plugin_modal_authorization_url_info1")},{type:"demo",text:l.o.t("create_plugin_modal_authorization_url_info2")}],authorization_content_type:[{type:"text",text:l.o.t("create_plugin_modal_authorization_content_type_info1")},{type:"demo",text:l.o.t("create_plugin_modal_authorization_content_type_info2")}],creation_method:[{type:"title",text:l.o.t("plugin_creation_method_hover_tip_using_existing_services_title")},{type:"text",text:l.o.t("plugin_creation_method_hover_tip_using_existing_services_desc")}],private_link_id:[{type:"title",text:l.o.t("vpc_plugin_create_plugin_1")},{type:"text",text:l.o.t("vpc_plugin_tooltips")}],dns:[{type:"text",text:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:l.o.t("plugin_create_DNS_desc_floatingwindow")}),(0,o.jsx)("a",{className:"coz-fg-hglt no-underline",href:"https://www.coze.cn/open/docs/guides/private_plugin",target:"_blank",children:l.o.t("plugin_create_DNS_doc_desc_floatingwindow")})]})}]},u={client_id:l.o.t("create_plugin_modal_client_id2"),client_secret:l.o.t("create_plugin_modal_client_secret2"),client_url:l.o.t("create_plugin_modal_client_url_empty"),scope:l.o.t("create_plugin_modal_scope_empty"),authorization_url:l.o.t("create_plugin_modal_authorization_url_empty"),authorization_content_type:l.o.t("create_plugin_modal_authorization_content_type_empty"),service_token:l.o.t("create_plugin_modal_Servicetoken_empty"),key:l.o.t("create_plugin_modal_Parameter_empty")};"".concat(r.zV.PLUGIN,"-").concat(r.x9.COZE),"".concat(r.zV.PLUGIN,"-").concat(r.x9.IDE),"".concat(r.zV.LOCAL,"-").concat(r.x9.COZE),"".concat(r.zV.MCP,"-").concat(r.x9.COZE);var c=()=>a.creation_method,p=[{label:"TokenExchange",value:r.qJ.TokenExchange},{label:"ClientCredential",value:r.qJ.ClientCredential}],d="0",s=new Map([[r.vw.DebugWaiting,{label:l.o.t("plugin_api_type_fail"),color:"red"}],[r.vw.DebugPassed,{label:l.o.t("plugin_api_type_pass"),color:"green"}]]),g=new Map([[r.Yz.ONLINE,{label:l.o.t("plugin_service_status_online"),color:"var(--plugin-unpublished-color)"}],[r.Yz.OFFLINE,{label:l.o.t("plugin_service_status_offline"),color:"var(--plugin-published-color)"}]]);var m=((i={}).DEFAULT="default",i.CREATE_TOOL="create_tool",i.SELECT_TOOL="select_tool",i.PUHSLISH="publish",i)},172148:function(e,t,n){n.d(t,{ob:()=>z,pn:()=>U,A2:()=>R,Np:()=>H,A8:()=>L,RQ:()=>S,$M:()=>T,EA:()=>J,zO:()=>V,sF:()=>O,av:()=>A});var i,o,l=n("938809"),r=n("723530"),_=n("665298"),a=n("26272"),u=n("416611"),c=n("411960"),p=n("618016"),d=n("888953"),s=n("922321"),g=()=>(0,s.Ue)()((0,d.mW)((e,t)=>({isVisible:!1,setVisible:n=>e({isVisible:"boolean"==typeof n?n:n(t().isVisible)},!1,"setVisible")}),{enabled:!1,name:"botStudio.plugin-history-panel-ui"})),m=n("255721"),y=n("341333"),f=n("265489"),v=n("468745"),x=n("16242"),h=n("168074"),b=n("449001"),w=e=>"[PluginStore.Error]: ".concat(e),k=n("378994"),C={[k.wA.Owner]:x.o.t("team_management_role_owner",{},"Owner"),[k.wA.Admin]:x.o.t("team_management_role_admin",{},"Admin"),[k.wA.Member]:x.o.t("team_management_role_member",{},"Member"),[k.wA.Default]:"-"},E=e=>{var{pluginID:t,spaceID:n,projectID:i,version:o}=e;return(0,s.Ue)()((0,d.mW)((0,d.XR)((e,l)=>({version:o,canEdit:!o,isUnlocking:!1,pluginId:t,spaceID:n,projectID:i,pluginInfo:{},initSuccessed:!1,getIsIdePlugin:()=>{var{pluginInfo:e}=l();return(null==e?void 0:e.creation_method)===k.x9.IDE},setInitSuccessed:t=>e((0,v.Uy)(e=>{e.initSuccessed=t}),!1,"setInitSuccessed"),setPluginInfo:t=>e((0,v.Uy)(e=>{e.pluginInfo=t}),!1,"setPluginInfo"),setUpdatedInfo:t=>e((0,v.Uy)(e=>{e.updatedInfo=t}),!1,"setUpdatedInfo"),initUserPluginAuth:(0,m._)(function*(){var n,{setCanEdit:r}=l(),_=yield b.Js.GetUserAuthority({project_id:i,plugin_id:t,creation_method:k.x9.COZE});if(0!==_.code)throw new p.sH(c.b.normalError,w("auth init"));e((0,v.Uy)(e=>{e.auth=_.data}),!1,"initUserPluginAuth"),r(!!(null===(n=_.data)||void 0===n?void 0:n.can_edit)&&!o)}),setCanEdit(t){e((0,v.Uy)(e=>{e.canEdit=t}),!1,"setCanEdit")},wrapWithCheckLock:e=>(0,m._)(function*(){var{checkPluginIsLockedByOthers:t}=l();if(!(yield t()))e()}),initPlugin:(0,m._)(function*(){var{pluginId:e,setPluginInfo:t}=l(),n=yield b.Js.GetPluginInfo({plugin_id:e||"",preview_version_ts:o});if((null==n?void 0:n.code)!==0)throw new p.sH(c.b.normalError,w("getPluginInfo error"));t((0,f._)((0,y._)({},n),{plugin_id:e||""}))}),initTool:(0,m._)(function*(){var{pluginId:e,setUpdatedInfo:t}=l(),n=yield b.Js.GetUpdatedAPIs({plugin_id:e||""},{__disableErrorToast:!0});if((null==n?void 0:n.code)!==0)throw new p.sH(c.b.normalError,w("getToolInfo error"));t({updated_api_names:(null==n?void 0:n.updated_api_names)||[],created_api_names:(null==n?void 0:n.created_api_names)||[]})}),init:(0,m._)(function*(){var{initPlugin:e,initTool:t,initUserPluginAuth:n,setInitSuccessed:i}=l();yield Promise.all([e(),t(),n()]),i(!0)}),checkPluginIsLockedByOthers:(0,m._)(function*(){var{pluginId:e,getIsIdePlugin:t}=l();if(t())return!1;var n=yield b.Js.CheckAndLockPluginEdit({plugin_id:e});if(0!==n.code)return!1;var{data:i}=n,o=null==i?void 0:i.user;return(null==i?!!void 0:!!i.Occupied)&&!!o&&!o.self&&(h.M5.info({okText:x.o.t("guidance_got_it"),title:x.o.t("plugin_team_edit_tip_unable_to_edit"),content:"".concat(o.name,"(").concat(C[o.space_roly_type],") ").concat(x.o.t("plugin_team_edit_tip_another_user_is_editing")),hasCancel:!1}),!0)}),unlockPlugin:(0,m._)(function*(){var{pluginId:t,canEdit:n,isUnlocking:i,getIsIdePlugin:o}=l();if(!o()&&!!n&&!i)try{e((0,v.Uy)(e=>{e.isUnlocking=!0}),!1,"unlocking-true");var r=yield b.Js.UnlockPluginEdit({plugin_id:t});if(0!==r.code)throw new p.sH(c.b.normalError,w("unlock"))}finally{e((0,v.Uy)(e=>{e.isUnlocking=!1}),!1,"unlocking-false")}}),updatePluginInfoByImmer:t=>e((0,v.Uy)(e=>{t(e.pluginInfo)}),!1,"updatePluginInfoByImmer")})),{enabled:!1,name:"botStudio.botPlugin"}))},P=(0,r.createContext)({storeRef:{plugin:void 0},callbacks:{},resourceNavigate:{},memorizedStoreSet:null}),I=(0,r.createContext)({pluginHistoryController:{current:null},registryPluginHistoryController:()=>0}),U=e=>{var t,{pluginID:n,spaceID:i,projectID:o,version:_,children:a,onUpdateDisplayName:c,onStatusChange:p,resourceNavigate:d}=e,s=(0,r.useRef)({}),m=(0,u.Z)(()=>g(),[]),y=(0,r.useRef)(null);return!(null===(t=s.current)||void 0===t?void 0:t.plugin)&&(s.current.plugin=E({pluginID:n,spaceID:i,projectID:o,version:_})),(0,l.jsx)(P.Provider,{value:{storeRef:s.current,memorizedStoreSet:{usePluginHistoryPanelUIStore:m},callbacks:{onUpdateDisplayName:c,onStatusChange:p},resourceNavigate:d},children:(0,l.jsx)(I.Provider,{value:{pluginHistoryController:y,registryPluginHistoryController:e=>{y.current=e}},children:a})})},S=e=>{var t=(0,r.useContext)(P);if(!t.storeRef.plugin)throw new p.sH(c.b.normalError,"plugin store context");return(0,_.s)(t.storeRef.plugin,e,a.X)},z=()=>{var e=(0,r.useContext)(P);if(!e.storeRef.plugin)throw new p.sH(c.b.normalError,"plugin store context");return e.storeRef.plugin},O=()=>{var{callbacks:{onStatusChange:e,onUpdateDisplayName:t}}=(0,r.useContext)(P);return{onStatusChange:e,onUpdateDisplayName:t}},A=()=>{var{resourceNavigate:e}=(0,r.useContext)(P);return e},L=()=>{var{memorizedStoreSet:e}=(0,r.useContext)(P);if(!e)throw Error("plugin memorized store set not provided");return e},H=()=>{var{pluginHistoryController:e}=(0,r.useContext)(I);return e},T=()=>{var{registryPluginHistoryController:e}=(0,r.useContext)(I);return e},N=e=>fetch("/api/plugin_api/unlock_plugin_edit",{keepalive:!0,method:"POST",body:JSON.stringify({plugin_id:e}),headers:{"Content-Type":"application/json"}}),R=e=>{(0,r.useEffect)(()=>{var t=()=>N(e);return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[])};var J=(i=(0,m._)(function*(e){var t=yield b.Js.CheckAndLockPluginEdit({plugin_id:e});if(0!==t.code)return!1;var{data:n}=t,i=null==n?void 0:n.user;return(null==n?!!void 0:!!n.Occupied)&&!!i&&!i.self&&(h.M5.info({okText:x.o.t("guidance_got_it"),title:x.o.t("plugin_team_edit_tip_unable_to_edit"),content:"".concat(i.name,"(").concat(C[i.space_roly_type],") ").concat(x.o.t("plugin_team_edit_tip_another_user_is_editing")),hasCancel:!1}),!0)}),function(e){return i.apply(this,arguments)});var V=(o=(0,m._)(function*(e){if(0!==(yield b.Js.UnlockPluginEdit({plugin_id:e})).code)throw new p.sH(c.b.normalError,w("unlock out"))}),function(e){return o.apply(this,arguments)})}}]);
//# sourceMappingURL=https://sourcemap-redirect.coze.cn/obj/coze-sourcemap/ol-sourcemap/bot/1.0.2.2476/62298.f6c646f2.js.map