"use strict";(self.webpackChunkapp_botstudio_main=self.webpackChunkapp_botstudio_main||[]).push([["51770"],{682178:function(e,t,o){o.d(t,{n:()=>er});var r=o("938809"),i=o("723530"),a=o("856306"),n=o.n(a),l=o("559293"),s=o("753940"),d=o("16242"),c=o("988726"),u=o("182956"),p=o("299846"),m=o("897538"),f=o("449001"),v=o("717667");function g(e){var{ownerId:t,resourceType:o,resourceId:r}=e,a=(0,p.tN)(e=>{var t,i;return null!==(i=null===(t=e.collaboratorsMap[o])||void 0===t?void 0:t[r])&&void 0!==i?i:[]}),n=v.Z.useUserInfo(),l=(0,i.useMemo)(()=>a.find(e=>e.id===t),[t,a]),s=(0,i.useMemo)(()=>a.filter(e=>e.id!==t),[t,a]);return{ownerInfo:l,collaborators:s,isOwner:l&&(null==n?void 0:n.user_id_str)===l.id,isCollaborator:s.some(e=>e&&e.id===(null==n?void 0:n.user_id_str))}}var h=o("141421"),_=o("666428"),x=o("431009"),w=o("255721"),y=o("498842"),b=o("448082"),k=o("646411");function j(e){return{id:e.user_id,name:e.name,user_name:e.user_name,avatar_url:e.icon_url}}var{Text:C}=u.Typography,S=e=>{var{iconURL:t,name:o,userName:i,isOwner:a,collaborator:n}=e;return(0,r.jsxs)("div",{className:"w-full flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-[8px]",children:[(0,r.jsx)(u.Image,{src:t,width:16,height:16,preview:!1}),(0,r.jsx)(C,{ellipsis:{showTooltip:{opts:{style:{wordBreak:"break-word"},stopPropagation:!0}}},children:o}),(0,r.jsxs)(C,{ellipsis:{showTooltip:{opts:{style:{wordBreak:"break-word"},stopPropagation:!0}}},children:["@",i]})]}),n?(0,r.jsx)(h.uX,{collaborator:n,children:(0,r.jsx)("span",{children:d.o.t("collaborate_collaborater")})}):null,a?(0,r.jsx)("span",{children:d.o.t("team_management_role_owner")}):null]})},I=o("866466"),T=o.n(I),E=o("462669"),N=o.n(E),A=o("318249"),P=o.n(A),M=o("294754"),R=o.n(M),z=o("13355"),Z=o.n(z),L=o("876846"),B=o.n(L),D=o("753804"),O={};O.styleTagTransform=B(),O.setAttributes=R(),O.insert=P().bind(null,"head"),O.domAPI=N(),O.insertStyleElement=Z(),T()(D.Z,O);var F=D.Z&&D.Z.locals?D.Z.locals:void 0,W=e=>{var t,o,a,{resourceId:s,resourceType:c,ownerId:m,searchPlaceholder:v,onAdd:_}=e,{collaborators:x}=g({resourceId:s,resourceType:c,ownerId:m}),[C]=(0,b.V)(),I=(0,p.rY)(e=>e.space.id),[T,E]=(0,i.useState)(""),[N,A]=(0,i.useState)([]),{node:P,roles:M,notAllowAdd:R}=(0,h.x8)(c),[z,Z]=(0,i.useState)(!1),[L,B]=(0,i.useState)([]);(0,l.Z)((0,w._)(function*(){var e;if(!T)return[];return(null===(e=(yield f.pr.SpaceMemberDetailV2({space_id:null!=I?I:"",search_word:T,page:1,size:50})).data)||void 0===e?void 0:e.member_info_list)||[]}),{refreshDeps:[T,I],debounceWait:300,onSuccess:e=>B(e)});var D=T?null!==(a=null==L?void 0:L.filter(e=>!N.some(t=>t.user_id===e.user_id)))&&void 0!==a?a:[]:x.map(e=>{var t,o,r;return{user_id:null!==(t=e.id)&&void 0!==t?t:"",name:null!==(o=e.user_name)&&void 0!==o?o:"",icon_url:null!==(r=e.avatar_url)&&void 0!==r?r:"",space_role_type:k.wA.Admin}});var O=(t=(0,w._)(function*(){try{Z(!0),!T.length&&N.length&&((yield p.tN.getState().batchAddCollaboratorsServer({resource:{id:s,type:c},users:N.map(j),options:{__disableErrorToast:!0},roles:M}))&&u.Toast.success({content:d.o.t("collaborate_collaborater_added_toast"),showClose:!1}),_(),A([]))}catch(e){y.E7.error({namespace:"studio auth",message:"addCollaborator catch error\uFF1A".concat(e.message),error:e,meta:{selectedUsers:N}}),u.Toast.error({content:e.msg||d.o.t("unknown_error"),showClose:!1,zIndex:1050})}finally{Z(!1)}}),function(){return t.apply(this,arguments)}),W=(0,i.useRef)(null),[U,K]=(0,i.useState)(),Y={50004:"collaborate_toast_failed_no_permission",50003:"collaborate_toast_failed_toomany",50002:"collaborate_toast_failed_others",50001:"collaborate_toast_failed_others"};var H=(o=(0,w._)(function*(){try{if(Z(!0),!T.length&&N.length){var e={id:s,type:c};if(1===N.length){var t=j(N[0]);yield p.tN.getState().addCollaborator({resource:e,user:t,options:{__disableErrorToast:!0},roles:M}),u.Toast.success({content:d.o.t("collaborate_collaborater_added_toast"),showClose:!1})}else{var[o,r,i]=yield p.tN.getState().batchAddCollaborators({resource:e,users:N.map(j),options:{__disableErrorToast:!0},roles:M});if(r.length){var a=r.map(e=>e.name).join("\uFF0C"),n=Y[i];u.Toast.error({content:d.o.t(n||"collaborate_collaborater_added_partial_toast",{users:a}),showClose:!1,zIndex:1050});return}u.Toast.success({content:d.o.t("collaborate_collaborater_added_toast"),showClose:!1})}_(),A([])}}catch(e){y.E7.error({namespace:"studio auth",message:"addCollaborator catch error\uFF1A".concat(e.message),error:e,meta:{selectedUsers:N}}),u.Toast.error({content:e.msg||d.o.t("unknown_error"),showClose:!1,zIndex:1050})}finally{Z(!1)}}),function(){return o.apply(this,arguments)});return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:n()("flex items-center justify-between gap-[8px]",F["search-wrapper"]),ref:W,children:[P,(0,r.jsx)(u.Select,{maxTagCount:U,showTick:!1,className:"grow !h-[unset]",dropdownClassName:F["custom-dropdown-style"],placeholder:null!=v?v:d.o.t("collaborate_collaborater_add_placeholder"),value:N.map(e=>{var t;return null!==(t=e.user_id)&&void 0!==t?t:""}),multiple:!0,autoClearSearchValue:!0,emptyContent:T?d.o.t("bz_no_user"):null,filter:!0,remote:!0,expandRestTagsOnClick:!0,showRestTagsPopover:!0,restTagsPopoverProps:{className:F["custom-pop-style"]},onBlur:()=>{if(W.current){for(var e=W.current.querySelectorAll(".".concat(F.tag)),t=void 0,o=0;o<e.length;o++){var r=e[o].offsetTop;if("number"==typeof t){if(r>t){K(o);break}}else t=r}}},onSearch:e=>{E(e)},onSelect:e=>{var t=D.find(t=>t.user_id===e);t&&(E(""),B([]),A([...N,t]))},renderSelectedItem:e=>{var t,o=N.findIndex(t=>t.user_id===e.value);return{isRenderInTag:!1,content:(0,r.jsx)(V,{onClose:()=>{A(e=>(e.splice(o,1),[...e]))},children:null===(t=N[o])||void 0===t?void 0:t.name})}},children:D.map(e=>{var t=x.find(t=>t.id===e.user_id),o=m===e.user_id,i=o||!!t;return(0,r.jsx)(u.Select.Option,{value:e.user_id,disabled:i,className:"px-[8px] ".concat(i?"opacity-[0.3]":""),children:(0,r.jsx)(S,{iconURL:e.icon_url,name:e.name,userName:e.user_name,isOwner:o,collaborator:t})},e.user_id)})}),(0,r.jsx)("div",{className:"shrink-0 self-start",children:N.length>20?(0,r.jsx)(u.Tooltip,{stopPropagation:!0,content:d.o.t("bz_batch_add_limit_20",{limit_cnt:20}),theme:"dark",children:(0,r.jsx)(u.Button,{type:"primary",disabled:!0,children:d.o.t("add")})}):(0,r.jsx)(u.Button,{type:"primary",disabled:!!T.length||!N.length||R,onClick:C["bot.studio.collaboration_pay"]?O:H,loading:z,children:d.o.t("add")})})]})})},V=e=>{var{children:t,onClose:o}=e;return(0,r.jsxs)("div",{className:n()(F.tag,"inline-flex items-center gap-[4px] px-[8px] rounded-[3px] bg-[#06070914] h-[24px] leading-[24px]"),children:[t,(0,r.jsx)(c.rmE,{onClick:o})]})},U=o("345305"),K=o("467189"),Y={};Y.styleTagTransform=B(),Y.setAttributes=R(),Y.insert=P().bind(null,"head"),Y.domAPI=N(),Y.insertStyleElement=Z(),T()(K.Z,Y);var H=K.Z&&K.Z.locals?K.Z.locals:void 0,{Text:G}=u.Typography;function J(e){var t,{resourceId:o,resourceType:a,ownerId:n,showRemoveCollaborator:l,removeCollaboratorTip:s,creator:c,roles:m}=e,{removeCollaborators:f,editCollaborator:g}=(0,p.tN)((0,U.N)(e=>({removeCollaborators:e.removeCollaborators,editCollaborator:e.editCollaborator}))),_=(0,h.hI)(a),x=(0,h.DM)(a),b=v.Z.useUserInfo(),[k,j]=(0,i.useState)(!1),C=e=>{var t=(null==e?void 0:e.msg)||d.o.t("unknown_error");y.E7.error({error:e,namespace:"collaborator",message:t}),u.Toast.error({showClose:!1,content:t,zIndex:1300})};if(c.id===n)return(0,r.jsx)("div",{className:H["collaborator-role"],children:d.o.t("team_management_role_owner")});if((null==b?void 0:b.user_id_str)===c.id)return null;return(0,r.jsxs)(r.Fragment,{children:[_?(0,r.jsx)(h.tU,{roles:m,loading:k,onConfirm:(t=(0,w._)(function*(e){try{j(!0),yield g({resource:{id:o,type:a},user:c,options:{__disableErrorToast:!0},roles:e}),u.Toast.success({showClose:!1,content:d.o.t("cozedev_collaborator_modify_succeeded"),zIndex:1300})}catch(e){C(e)}j(!1)}),function(e){return t.apply(this,arguments)})}):null,x&&!1!==l?(0,r.jsx)(u.Popconfirm,{className:"remove-collaborator",position:"bottomLeft",title:d.o.t("collaborate_collaborater_removed_confirm_title"),content:"string"==typeof s?(0,r.jsx)(G,{className:"coz-fg-secondary",children:s}):null,okText:d.o.t("Remove"),cancelText:d.o.t("Cancel"),okButtonProps:{color:"red"},onConfirm:(0,w._)(function*(){try{var e;yield f({id:o,type:a},null!==(e=c.id)&&void 0!==e?e:"",{__disableErrorToast:!0}),u.Toast.success({showClose:!1,content:d.o.t("collaborate_collaborater_removed_toast"),zIndex:1300})}catch(e){C(e)}}),children:(0,r.jsx)(u.Button,{color:"primary",size:"small",children:d.o.t("Remove")})}):null]})}var q=e=>{var{resourceId:t,resourceType:o,ownerId:i,showRemoveCollaborator:a,removeCollaboratorTip:n}=e,{ownerInfo:l,collaborators:s}=g({resourceId:t,resourceType:o,ownerId:i}),d=[l,...s].filter(e=>!!e);return(0,r.jsx)("div",{className:"overflow-auto max-h-[260px]",children:d.map(e=>(0,r.jsxs)("div",{className:H["collaborator-item"],children:[(0,r.jsx)(u.Avatar,{size:"extra-extra-small",src:null==e?void 0:e.avatar_url}),(0,r.jsxs)("div",{className:H["collaborator-name-wrapper"],children:[(0,r.jsx)(G,{ellipsis:{showTooltip:{opts:{style:{wordBreak:"break-word"},stopPropagation:!0}}},children:e.name}),(0,r.jsxs)(G,{ellipsis:{showTooltip:{opts:{style:{wordBreak:"break-word"},stopPropagation:!0}}},children:["@",e.user_name]}),(0,r.jsx)(h.st,{roles:e.roles})]}),(0,r.jsx)(J,{ownerId:i,resourceId:t,resourceType:o,showRemoveCollaborator:a,removeCollaboratorTip:n,creator:e,roles:e.roles})]},e.id))})};o("168074");var X=o("511126"),Q={};Q.styleTagTransform=B(),Q.setAttributes=R(),Q.insert=P().bind(null,"head"),Q.domAPI=N(),Q.insertStyleElement=Z(),T()(X.Z,Q),X.Z&&X.Z.locals&&X.Z.locals;var $=e=>{var t,{isCollaboration:o,onChange:a,hasCollaborators:n,onCloseModalVisibleChange:l,disableTooltip:s}=e,[c,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1);var v=(t=(0,w._)(function*(e){if(!e){p(!0),null==l||l(!0);return}f(!0);try{yield null==a?void 0:a(e)}catch(e){y.kg.info("collaboration change error")}finally{f(!1)}}),function(e){return t.apply(this,arguments)});return(0,r.jsxs)(r.Fragment,{children:[s?(0,r.jsx)(u.Tooltip,{theme:"dark",content:s,children:(0,r.jsx)(u.Switch,{size:"small",checked:!1,disabled:!0})}):n&&o?(0,r.jsx)(u.Tooltip,{theme:"dark",content:d.o.t("devops_publish_multibranch_CollSwitchCloseInfo"),children:(0,r.jsx)(u.Switch,{checked:!0,disabled:!0,size:"small"})}):(0,r.jsx)(u.Switch,{size:"small",checked:o,onChange:v,loading:m}),(0,r.jsx)(u.Modal,{title:d.o.t("devops_publish_multibranch_DisableCollaMode"),visible:c,onOk:()=>{null==a||a(!1),p(!1),null==l||l(!1)},onCancel:()=>{p(!1),null==l||l(!1)},okText:d.o.t("devops_publish_multibranch_CollSwitchDisable"),cancelText:d.o.t("devops_publish_multibranch_CollSwitchCancel"),okButtonColor:"red",zIndex:3e3,children:(0,r.jsx)("span",{children:d.o.t("devops_publish_multibranch_DisableCollaModeInfo")})})]})},ee=e=>{var{resourceId:t,resourceType:o,ownerId:a,popupTip:l,showCollaborationSwitch:s,isCollaboration:c,showRemoveCollaborator:p,onAddCollaboration:m,onCloseModalVisibleChange:f,onCollaborationSwitchChange:v,shouldUpgrade:w,intro:y,disableTooltip:b,searchPlaceholder:k,removeCollaboratorTip:j}=e,{ownerInfo:C,collaborators:S}=g({resourceId:t,resourceType:o,ownerId:a}),I=S.length>0,T=(0,h.o$)(),[E,N]=(0,i.useState)(!1),A=T&&o===x._.Bot;return(0,r.jsx)("div",{className:n()("px-[16px] pt-[12px] pb-[16px] gap-[12px] flex flex-col",A?"w-[630px]":"w-[480px]",E?"pb-[0px]":""),children:E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-[8px] ml-[-8px]",children:[(0,r.jsx)(u.IconButton,{color:"secondary",size:"large",icon:(0,r.jsx)(_.D6v,{}),onClick:()=>{N(!1)}}),(0,r.jsx)("span",{className:"text-[20px] font-[500]",children:d.o.t("collaborate_collaborater_manage")})]}),(0,r.jsx)(q,{resourceId:t,resourceType:o,ownerId:a,showRemoveCollaborator:p,removeCollaboratorTip:j})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-[40px]",children:[(0,r.jsxs)("div",{className:"flex items-center font-medium text-[20px]",children:[d.o.t("collaborate"),(0,r.jsx)(u.Tooltip,{stopPropagation:!0,content:l,theme:"dark",children:(0,r.jsx)(u.IconButton,{className:"ml-[4px]",color:"secondary",size:"small",icon:(0,r.jsx)(_.eQN,{})})})]}),s?(0,r.jsx)($,{disableTooltip:b,isCollaboration:c,hasCollaborators:I,onChange:v,onCloseModalVisibleChange:f}):null]}),null,!c&&s?y:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-[32px]",children:[(0,r.jsx)("div",{className:"text-[14px]",children:d.o.t("project_permission_collaborator_1")}),(0,r.jsxs)("div",{className:n()("flex items-center gap-[6px] py-[4px] pl-[4px] pr-[8px] rounded-[16px] cursor-pointer","hover:coz-mg-primary-hovered active:coz-mg-primary-pressed"),onClick:()=>N(!0),children:[(0,r.jsx)(u.Tooltip,{theme:"dark",stopPropagation:!0,content:d.o.t("collaborate_collaborater_owner_tooltip",{username:(null==C?void 0:C.name)||"-"}),children:(0,r.jsx)(u.Avatar,{src:null==C?void 0:C.avatar_url,size:"extra-small"})}),I?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Divider,{layout:"vertical"}),S.slice(0,3).map((e,t)=>2===t&&S.length>3?(0,r.jsx)(u.Tooltip,{theme:"dark",stopPropagation:!0,content:d.o.t("collaborate_collaborater_count",{number_of_collaborators:S.length-3+1}),children:(0,r.jsxs)(u.CozAvatar,{size:"small",color:"grey",className:"text-[12px] select-none",children:["+",S.length-3+1]})},e.id):(0,r.jsx)(u.Tooltip,{theme:"dark",stopPropagation:!0,content:e.name,children:(0,r.jsx)(u.Avatar,{size:"extra-small",src:e.avatar_url},e.id)},e.id))]}):null,(0,r.jsx)(_.Ec8,{size:"extra-small"})]})]}),(0,r.jsx)(W,{resourceId:t,resourceType:o,ownerId:a,searchPlaceholder:k,onAdd:()=>{null==m||m()}})]})]})})},et=o("537659"),eo=o("941876"),er=e=>{var{border:t,resourceType:o,resourceId:a,ownerId:v,showCollaborationSwitch:h,isCollaboration:_,showRemoveCollaborator:x,onCollaborationSwitchChange:w,shouldUpgrade:y,textMap:b,testId:k,customWarn:j}=e,C=(0,p.tN)(e=>e.fetchCollaborators),S=(0,p.rY)(e=>{var t;return null!==(t=e.space.id)&&void 0!==t?t:""}),{data:I}=(0,l.Z)(()=>f.pr.SpaceMemberDetailV2({space_id:S,page:1,size:1})),{collaborators:T}=g({resourceId:a,resourceType:o,ownerId:v}),[E,N]=(0,i.useState)(!1),[A,P]=(0,i.useState)(!1),M=(0,i.useRef)(!1),{node:R,open:z}=(0,s.zv)({scene:s.ej.Collaborate}),Z=(0,s.Lo)({spaceID:S,scene:s.ej.Collaborate});(0,i.useEffect)(()=>{C({spaceId:S,resource:{id:a,type:o}})},[S,a,o]);var L=(0,et.G)(e=>e.create_time),B=(0,eo.useOverseaFeaturesOfflineStage)(L);return Z?B===eo.OfflineStage.Hide?null:(0,r.jsx)(u.Tooltip,{theme:"dark",content:T.length?d.o.t("collaborate_collaborater_count_1",{number_of_collaborators:T.length}):d.o.t("collaborate"),visible:E,trigger:"custom",children:(0,r.jsx)("span",{children:(0,r.jsx)(u.Popover,{onClickOutSide:()=>{requestAnimationFrame(()=>{!M.current&&0===document.getElementsByClassName("remove-collaborator").length&&P(!1)})},className:"!p-0 !coz-bg-plus",zIndex:1e3,content:(0,r.jsx)(ee,{resourceType:o,resourceId:a,ownerId:v,showCollaborationSwitch:h,isCollaboration:_,showRemoveCollaborator:x,onCollaborationSwitchChange:w,onCloseModalVisibleChange:e=>{M.current=e},shouldUpgrade:y,popupTip:b.titleTooltip,intro:b.intro,disableTooltip:b.disableTooltip,searchPlaceholder:b.searchPlaceholder,removeCollaboratorTip:b.removeCollaboratorTip}),trigger:"custom",visible:A,keepDOM:!0,children:(0,r.jsx)(u.Badge,{count:B===eo.OfflineStage.Warn||j?(0,r.jsx)(eo.OfflineDot,{}):null,children:(0,r.jsx)(u.IconButton,{color:"secondary",icon:(0,r.jsx)(c.Eo5,{}),onClick:()=>{P(!0),N(!1)},onMouseEnter:()=>{!A&&N(!0)},onMouseLeave:()=>{N(!1)},className:n()("hover:!bg-[var(--semi-color-fill-1)]",t?"!border !border-solid !border-[rgba(29,28,35,0.12)] hover:!border-transparent":""),"data-testid":k,children:_&&T.length>0?T.length:null})})})})}):(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.IconButton,{icon:(0,r.jsx)(c.Eo5,{}),onClick:()=>{var e;(null==I?void 0:null===(e=I.data)||void 0===e?void 0:e.space_role_type)===m.wA.Owner?z():u.Toast.warning(d.o.t("workspace_cooperation_permission_toast"))},"data-testid":k}),(0,r.jsx)(c.sWZ,{className:"coz-fg-hglt text-[12px] absolute top-[-2px] right-[-2px]"}),R]})}},911107:function(e,t,o){o.d(t,{e:function(){return r}});var r=(0,o(723530).createContext)({routerConfigList:[],registerShortcut:()=>[],getPromptContextInfo:()=>({botId:"",botDescription:"",botName:"",botChatHistory:""}),getDraftBotConversationId:()=>void 0,getPromptEditor:()=>void 0,getIsReadonly:()=>!1,sendTeaEvent:()=>void 0})},9475:function(e,t,o){o.d(t,{i:function(){return a}});var r=o(723530),i=o(911107),a=()=>(0,r.useContext)(i.e)},200625:function(e,t,o){o.d(t,{a:function(){return r}});var r=(0,o(723530).createContext)(null)},208647:function(e,t,o){o.d(t,{k:function(){return a}});var r=o(723530),i=o(200625),a=()=>{var e=(0,r.useContext)(i.a);if(!e)throw Error("nl prompt core is not provided");return e}},415804:function(e,t,o){o.d(t,{M:function(){return r}});var r=(0,o(723530).createContext)({getIsShowCloseModal:()=>!1,setIsShowCloseModal:()=>void 0})},474113:function(e,t,o){o.d(t,{i:function(){return r}});var r=(0,o(723530).createContext)(null)},924876:function(e,t,o){o.d(t,{p:function(){return a}});var r=o(723530),i=o(474113),a=()=>{var e=(0,r.useContext)(i.i);if(!e)throw Error("nl prompt service is not provided");return e}},739939:function(e,t,o){o.d(t,{l:function(){return r}});var r=(0,o(723530).createContext)(null)},230528:function(e,t,o){o.d(t,{Z:function(){return a}});var r=o(723530),i=o(739939),a=()=>{var e=(0,r.useContext)(i.l);if(!e)throw Error("store is not provided");return e}},981325:function(e,t,o){o.d(t,{r:()=>c});var r=o("27043"),i=o("230528"),a=o("924876"),n=o("723530"),l=o("415804"),s=()=>(0,n.useContext)(l.M),d=o("9475"),c=()=>{var{getPromptEditor:e}=(0,d.i)(),{nLPromptModalVisibilityService:t}=(0,a.p)(),o=(0,i.Z)(),{setIsShowCloseModal:n}=s();return{closeModal:i=>{var{forceClose:a}=i;return(0,r.H)({forceClose:a,onShowCloseModal:n,payload:{modalVisibilityService:t,storeSet:o,getPromptEditor:e}})}}}},459950:function(e,t,o){o.d(t,{B:function(){return i}});var r=o(9475),i=()=>{var e=(0,r.i)().getPromptEditor();if(!e)throw Error("prompt editor is not ready");return e}},923054:function(e,t,o){o.d(t,{O:function(){return a}});var r=o(166194),i=o(882979),a=e=>{var{openModalSource:t,sendSource:o}=e;if("editor-float-trigger"===t)return"replace";if("editor-shortcut"===t)return"insert";if("ai-button"===t||(0,r.Z)(t))return"auto-optimize"===o?"auto":"optimize-by-previewing-result"===o?"debug":"chat"!==o&&o?((0,i.Sn)(o),"auto"):"require";return(0,i.Sn)(t),"auto"}},905364:function(e,t,o){o.d(t,{r:function(){return n}});var r=o(832591),i=o(273094),a=o(882979),n=new class e{constructor(){this.messageTestFields=["content","type","role"],this.query={findMessageByIdStruct:(e,t)=>{var o=t.message_id,r=this.query.findMessageById(e,o);if(void 0!==r)return r;var i=t.extra_info.local_message_id;return this.query.findMessageById(e,i)},findMessageById:(e,t)=>{if(!!t)return e.find(e=>this.common.getMessageUniqueKey(e)===t)},findMessageIndexById:(e,t)=>t?e.findIndex(e=>this.common.getMessageUniqueKey(e)===t):-1,findMessageIndexByIdStruct:(e,t)=>{var o=t.message_id,r=this.query.findMessageIndexById(e,o);if(r>=0)return r;var i=t.extra_info.local_message_id;return this.query.findMessageIndexById(e,i)},findMessagesByReplyId:(e,t)=>e.filter(e=>e.reply_id===t)},this.predicate={getIsValidMessage:e=>void 0!==e&&this.messageTestFields.every(t=>t in e),isVerboseMessage:e=>"verbose"===e.type,isVerboseContent:e=>(0,r.Z)(e)&&"msg_type"in e&&"data"in e,isVerboseMessageType:(e,t)=>{if(!this.predicate.isVerboseMessage(e))return!1;var{content:o}=e,r=(0,a.WP)(o,()=>0);return this.predicate.isVerboseContent(r)&&r.msg_type===t},isAnswerFinishVerboseMessage:e=>this.predicate.isVerboseMessageType(e,i.kc.GENERATE_ANSWER_FINISH),getIsTextMessage:e=>(null==e?void 0:e.content_type)===i.zc.Text},this.common={getMessageUniqueKey:e=>{if(e.message_id)return e.message_id;var t=e.extra_info.local_message_id;if(!t)throw Error("message without any id");return t},getMessageSendSourceByReplyId:(e,t)=>{var o;return null===(o=e.find(e=>e.reply_id===t.reply_id&&e._sendSource))||void 0===o?void 0:o._sendSource},serializeIdStruct:e=>"message_id: ".concat(e.message_id,", local message id: ").concat(e.extra_info.local_message_id)}}}},27043:function(e,t,o){o.d(t,{H:function(){return s}});var r=o(166194),i=o(882979),a=o(16242),n=o(182956),l=e=>{var{modalVisibilityService:t,getPromptEditor:o}=e;t.close();var a=t.getOpenModalSource();if(!("ai-button"===a||"editor-float-trigger"===a||(0,r.Z)(a))){if("editor-shortcut"===a){setTimeout(()=>{var e;null===(e=o())||void 0===e||e.focus()});return}(0,i.Sn)(a)}},s=e=>{var{forceClose:t,payload:{modalVisibilityService:o,storeSet:{usePromptMessageStore:r,useWaitingStore:i},getPromptEditor:s},onShowCloseModal:d}=e,c=!!r.getState().promptMessage,{sending:u,waiting:p}=i.getState();if(!c&&!(u||p)||t){l({modalVisibilityService:o,getPromptEditor:s});return}d(!0),n.Modal.error({title:a.o.t("discard_ai_response"),onOk:()=>{l({modalVisibilityService:o,getPromptEditor:s}),d(!1)},onCancel:()=>{d(!1)},okText:a.o.t("Confirm"),cancelText:a.o.t("Cancel")})}},722880:function(e,t,o){o.d(t,{Ys:()=>tj,fP:()=>tb,ad:()=>T,rZ:()=>S,YN:()=>tS});var r,i,a,n,l,s=o("341333"),d=o("265489"),c=o("556923"),u=o("938809"),p=o("723530"),m=o("75591"),f=o("846321"),v=o("16242"),g=o("988726"),h=o("182956"),_=o("416611"),x=o("642385"),w=o("888953"),y=o("922321"),b=()=>(0,y.Ue)()((0,w.mW)((e,t)=>({visible:!1,position:{left:0,top:0,right:0,bottom:0},setVisible:t=>e({visible:t},!1,"setVisible"),updatePosition:o=>{var{position:r}=t();e({position:o(r)},!1,"updatePosition")}}),{enabled:!1,name:"botStudio.promptKit.NLPromptModal"})),k=o("320862");class j{constructor({setVisible:e,updateModalPosition:t,getIsVisible:o,sendTeaEvent:r}){this.eventCenter=(0,k.Z)(),this.openModalSource=null,this.open=(e,t)=>{this.setVisible(!0),this.updateModalPosition(()=>e),this.openModalSource=t,this.eventCenter.emit("visibilitychange",{isShow:!0,openModalSource:t})},this.updatePosition=e=>{this.updateModalPosition(e)},this.close=()=>{if(!!this.getIsVisible())this.setVisible(!1),this.eventCenter.emit("visibilitychange",{isShow:!1,openModalSource:null}),this.sendTeaEvent(x.Kg.prompt_optimize_front,{action:"exit"})},this.getOpenModalSource=()=>this.openModalSource,this.setVisible=e,this.updateModalPosition=t,this.getIsVisible=o,this.sendTeaEvent=r}}var C=(0,p.createContext)(null),S=e=>{var{children:t}=e,o=(0,_.Z)(()=>b(),[]),r=(0,_.Z)(()=>(0,f.qI)(),[]),i=(0,_.Z)(()=>{var{setVisible:e,updatePosition:t}=o.getState();return new j({setVisible:e,updateModalPosition:t,getIsVisible:()=>o.getState().visible,sendTeaEvent:x.Gg})},[]),a=(0,_.Z)(()=>{var{setModalToTopLayer:e,getModalIndex:t,registerModal:o,removeModal:i}=r.getState();return new f.gG({registerModal:o,removeModal:i,setModalToTopLayer:e,getModalIndex:t})},[]);return(0,u.jsx)(C.Provider,{value:{useNLPromptModalStore:o,nLPromptModalVisibilityService:i,freeGrabModalHierarchyService:a,useFreeGrabModalHierarchyStore:r},children:t})},I=()=>{var e=(0,p.useContext)(C);if(!e)throw Error("NLPrompt service not provided");return e},T=e=>{var{children:t,onlyIcon:o,tooltip:r,hideAIButton:i=!1}=e,a=(0,c._)(e,["children","onlyIcon","tooltip","hideAIButton"]),n=(0,p.useRef)(null),{nLPromptModalVisibilityService:l}=I(),_=(0,m.jE)(),x=(0,f.j8)(),w=o?{color:"secondary",icon:(0,u.jsx)(g.epB,{className:"!coz-fg-hglt !text-xxl"}),size:"default",onlyIcon:!0}:{color:"aihglt",iconPosition:"left",size:"small"};return(0,u.jsx)("div",{ref:n,children:i?null:(0,u.jsx)(h.Tooltip,{content:r||v.o.t("prompt_optimization_button_hover_tooltip"),children:(0,u.jsx)(h.AIButton,(0,d._)((0,s._)({},w,a),{disabled:!_||x,onClick:()=>{if(!!n.current){var e,{offsetHeight:t,clientWidth:o}=n.current,{top:r,left:i}=n.current.getBoundingClientRect(),a=(null===(e=window)||void 0===e?void 0:e.innerWidth)-i<456;l.open({top:r+t+4,left:a?i-456+o:i},"ai-button")}},children:t}))})})},E=o("453341"),N=o("345305"),A=o("856306"),P=o.n(A),M=o("27043"),R=o("665298"),z=o("468745"),Z=o("905364"),L=(e,t)=>t.find(t=>t.id===e.message_id),B=e=>({index:e.index,type:e.type,id:e.message_id,streamPlugin:e.extra_info.stream_plugin_running?{streamUuid:e.extra_info.stream_plugin_running}:null}),D=(e,t)=>{var{responding:o}=e,r=Z.r.predicate.isAnswerFinishVerboseMessage(t),i="answer"===t.type,a="answer"===t.type&&t.is_finish;if(!o){if(r||!i)return;e.responding={replyId:t.reply_id,response:[B(t)]};return}if(o.replyId!==t.reply_id){console.error("updateRespondingInImmer not match reply id, income: ".concat(t.reply_id,", record: ").concat(null==o?void 0:o.replyId));return}if(r){e.responding=null;return}if(i&&!L(t,o.response)&&o.response.push(B(t)),a){var n=L(t,o.response);if(!n)return;var l=o.response.indexOf(n);l>=0&&o.response.splice(l,1)}},O=()=>(0,R.F)()((0,w.mW)((0,w.XR)((e,t)=>({sending:null,waiting:null,responding:null,recentResponse:null,responseError:null,startSending:t=>e({sending:t},!1,"startSending"),clearSending:()=>e({sending:null},!1,"clearSending"),getIsOnlyWaitingSuggestions:()=>{var{waiting:e}=t();return(null==e?void 0:e.phase)==="suggestion"},startWaiting:t=>{var o;return e({waiting:{replyId:t.message_id,questionLocalMessageId:null===(o=t.extra_info)||void 0===o?void 0:o.local_message_id,phase:"formal"}},!1,"setWaitingId")},updateWaiting:o=>{var r,{reply_id:i}=o;if((null===(r=t().waiting)||void 0===r?void 0:r.replyId)===i)Z.r.predicate.isAnswerFinishVerboseMessage(o)&&e((0,z.Uy)(e=>{if(!e.waiting)throw Error("is not in waiting");e.waiting.phase="suggestion"}),!1,"updateWaiting")},updateResponding:t=>{e((0,z.Uy)(e=>{D(e,t)}),!1,"updateResponding")},setResponseError:t=>{e({responseError:t},!1,"setResponseError")},updateRecentResponse:t=>{e({recentResponse:t},!1,"updateRecentResponse")},clearUnsettledByReplyId:t=>{e((0,z.Uy)(e=>{var o,r;(null===(o=e.waiting)||void 0===o?void 0:o.replyId)===t&&(e.waiting=null),(null===(r=e.responding)||void 0===r?void 0:r.replyId)===t&&(e.responding=null)}),!1,"clearAllUnsettledByReplyId")},clearAllUnsettledUnconditionally:()=>{e((0,z.Uy)(e=>{e.waiting=null,e.responding=null,e.sending=null}),!1,"clearAllUnsettledUnconditionally")},clearWaitingStore:()=>{e({sending:null,waiting:null,responding:null},!1,"clearWaitingStore")},clearRecentResponse:()=>{e({recentResponse:null},!1,"clearRecentResponse")},getIsSending:()=>!!t().sending,getWaiting:()=>t().waiting,getIsWaiting:e=>{var o;return(null===(o=t().waiting)||void 0===o?void 0:o.phase)===e},getIsWaitingFormal:()=>{var e;return(null===(e=t().waiting)||void 0===e?void 0:e.phase)==="formal"},getIsResponding:()=>!!t().responding})),{name:"botStudio.NLPromptWaiting",enabled:!1})),F=e=>{var{useWaitingStore:t}=e;return t.subscribe(e=>e.responding,e=>{if(!!e)t.getState().updateRecentResponse(e)})},W=()=>(0,y.Ue)()((0,w.mW)(e=>({promptMessage:null,setPromptMessage:t=>{e({promptMessage:t},!1,"setPromptMessage")},clearPromptMessage:()=>{e({promptMessage:null},!1,"clearPromptMessage")}}),{name:"botStudio.NLPrompt_PromptMessage",enabled:!1})),V=e=>{var{getPromptMessageByReplyId:t,recentResponseReplyId:o,setPromptMessage:r,clearPromptMessage:i}=e;if(!o){i();return}var a=t(o);if(!a){i();return}r(a)},U=e=>{var{useMessagesStore:t,useWaitingStore:o,usePromptMessageStore:r}=e,{setPromptMessage:i,clearPromptMessage:a}=r.getState(),{getPromptMessageByReplyId:n}=t.getState(),l=t.subscribe(e=>e.messages,()=>{var{recentResponse:e}=o.getState();V({getPromptMessageByReplyId:n,recentResponseReplyId:null==e?void 0:e.replyId,setPromptMessage:i,clearPromptMessage:a})});return{unsubscribeMessageStore:l,unsubscribeWaitingStore:o.subscribe(e=>{var t;return null===(t=e.recentResponse)||void 0===t?void 0:t.replyId},e=>V({getPromptMessageByReplyId:n,recentResponseReplyId:e,setPromptMessage:i,clearPromptMessage:a}))}},K=e=>{var{index:t,messages:o}=e,r=o[t];if(!r)throw Error("get message exception: invalid index: ".concat(t));return{isSending:"user"===r.role&&!r.is_finish,isFail:!!r._sendFailed,isReceiving:"assistant"===r.role&&!r.is_finish,message_id:r.message_id,extra_info:{local_message_id:r.extra_info.local_message_id}}},Y=()=>(0,R.F)()((0,w.mW)((0,w.XR)((e,t)=>({metaList:[],getMetaByMessage:e=>{var o=Z.r.query.findMessageById(t().metaList,e);if(!o)throw Error("fail to find meta of ".concat(e));return o},updateMeta:t=>{e({metaList:t},!1,"updateMeta")},updateMetaByImmer:o=>{e({metaList:(0,z.Uy)(t().metaList,o)},!1,"updateMetaByImmer")},clear:()=>{e({metaList:[]},!1,"clear")}})),{name:"botStudio.NLPromptMessageMeta",enabled:!1})),H=e=>{var{useMessagesStore:t,useMessageMetaStore:o}=e;return t.subscribe(e=>e.messages,e=>{var t=e.map((t,o)=>K({index:o,messages:e}));o.getState().updateMeta(t)})},G=e=>{var{storeSet:t}=e;(0,p.useEffect)(()=>{var e=H(t),{unsubscribeMessageStore:o,unsubscribeWaitingStore:r}=U(t),i=F(t);return()=>{e(),o(),r(),i()}},[])},J=e=>{var{onResize:t}=e;(0,p.useEffect)(()=>(window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),[t])},q=e=>{var{ref:t,nlModalStore:o}=e,r=()=>document.body.clientHeight;(0,p.useEffect)(()=>{var e=t.current;if(!!e){var i=()=>{var t=e.clientHeight,i=o.getState().position.top;return{modalHeight:t,modalTop:i,bodyHeight:r()}},a=()=>{var{modalHeight:e,modalTop:t,bodyHeight:o}=i();return o-e-t>=36},n=()=>{var{modalHeight:e,modalTop:t,bodyHeight:o}=i();return Math.max(0,t+e+36-o)},l=new ResizeObserver(()=>{if(!a()){var e=n();o.getState().updatePosition(t=>(0,d._)((0,s._)({},t),{top:t.top-e}))}});return l.observe(e),()=>{l.disconnect()}}},[])},X=o("882979"),Q=()=>({messages:[]}),$=()=>(0,R.F)()((0,w.mW)((0,w.XR)((e,t)=>(0,d._)((0,s._)({},Q()),{getMessages:()=>t().messages,getMessagesByReplyId:e=>Z.r.query.findMessagesByReplyId(t().messages,e),getPromptMessageByReplyId:e=>{var o=t().getMessagesByReplyId(e),r=o.findIndex(e=>"answer"===e.type&&Z.r.predicate.getIsTextMessage(e));if(!(r<0))return o[r]},updateMessage:(t,o)=>{e((0,z.Uy)(e=>{if("string"==typeof t){if(!Z.r.predicate.getIsValidMessage(o)){(0,X.Cj)("message is required when use id to updateMessage");return}var r=Z.r.query.findMessageIndexById(e.messages,t);if(r<0){(0,X.Cj)("cannot find message with id ".concat(t));return}e.messages[r]=o;return}var i=Z.r.query.findMessageIndexByIdStruct(e.messages,t);if(i<0){(0,X.Cj)("cannot find message with id ".concat(Z.r.common.serializeIdStruct(t)));return}o?e.messages[i]=o:Z.r.predicate.getIsValidMessage(t)?e.messages[i]=t:(0,X.Cj)("id struct is not valid message")}),!1,"updateMessage")},findMessage:e=>{var{messages:o}=t();return"string"==typeof e?Z.r.query.findMessageById(o,e):Z.r.query.findMessageByIdStruct(o,e)},addMessage:t=>{e((0,z.Uy)(e=>{e.messages.unshift(t)}),!1,"addMessage")},deleteMessageByIdStruct:t=>{e((0,z.Uy)(e=>{var o=Z.r.query.findMessageIndexByIdStruct(e.messages,t);if(o<0){console.error("cannot find message ".concat(t.message_id));return}e.messages.splice(o,1)}),!1,"deleteMessageByIdStruct")},deleteMessageById:t=>{e((0,z.Uy)(e=>{var o=Z.r.query.findMessageIndexById(e.messages,t);if(o<0){console.error("cannot find message ".concat(t));return}e.messages.splice(o,1)}),!1,"deleteMessageById")},deleteMessageByIdList:o=>{e({messages:t().messages.filter(e=>0>o.findIndex(t=>t===Z.r.common.getMessageUniqueKey(e)))},!1,"deleteMessageByIdList")},clearMessage:()=>{t().clearMessageStore()},clearMessageStore:()=>{e(Q(),!1,"clearAll")}})),{name:"botStudio.NLPromptMessage",enabled:!1})),ee=()=>(0,y.Ue)()((0,w.mW)((e,t)=>({initStatus:"unInit",chatCore:null,conversationId:null,offChatCoreListen:()=>void 0,setInitStatus:t=>{e({initStatus:t},!1,"setInitStatus")},setConversationId:t=>{e({conversationId:t},!1,"")},setChatCore:t=>{e({chatCore:t},!1,"setChatCore")},setChatCoreOffListen:t=>{e({offChatCoreListen:t},!1,"setChatCoreOffListen")},getChatCore:()=>{var{chatCore:e}=t();return e},clearSideEffect:()=>{var o;t().offChatCoreListen(),null===(o=t().chatCore)||void 0===o||o.destroy(),e({initStatus:"unInit",chatCore:null,conversationId:null},!1,"clearInitStore")}}),{name:"botStudio.NLPromptInit",enabled:!1})),et=()=>{var e=(0,_.Z)(()=>ee(),[]),t=(0,_.Z)(()=>$(),[]),o=(0,_.Z)(()=>Y(),[]),r=(0,_.Z)(()=>O(),[]);return{useGlobalInitStore:e,useMessagesStore:t,useMessageMetaStore:o,useWaitingStore:r,usePromptMessageStore:(0,_.Z)(()=>W(),[])}},eo=o("255721"),er=o("306769"),ei=o("559293"),ea=o("273094"),en=o("999061"),el=o("449001"),es=o("211964"),ed=e=>"follow_up"===e.type,ec=o("832591"),eu=e=>(0,ec.Z)(e)&&"code"in e&&"msg"in e,ep=e=>{if(!!e){var t=(0,X.WP)(e,()=>0);if(eu(t))return t}};var em=((r={})[r.COZE_TOKEN_INSUFFICIENT=0x29d8ebe4]="COZE_TOKEN_INSUFFICIENT",r[r.COZE_TOKEN_INSUFFICIENT_WORKFLOW=0x29d91ee0]="COZE_TOKEN_INSUFFICIENT_WORKFLOW",r),ef=["success","error","timeout"],ev=e=>{var{chatCore:t,storeSet:{useMessagesStore:o,useWaitingStore:r}}=e,{updateResponding:i,updateWaiting:a,clearUnsettledByReplyId:n,setResponseError:l,getWaiting:s}=r.getState(),d=e=>{var{data:t}=e;t.forEach(e=>{i(e),ed(e)?n(e.reply_id):e_(e,o),a(e)})},c=e=>{var{data:t,abort:r,error:i}=e,a=t.pullingStatus;if("error"===a){var d=ep(null==i?void 0:i.message),c=s();d&&0!==d.code&&c&&l({error:d,replyId:c.replyId}),(null==d?void 0:d.code)&&[em.COZE_TOKEN_INSUFFICIENT,em.COZE_TOKEN_INSUFFICIENT_WORKFLOW].includes(d.code)&&(0,es.Dt)(es.wE.COZE_TOKEN_INSUFFICIENT)}ef.includes(a)&&(eg({data:t,useMessagesStore:o}),n(t.reply_id)),"timeout"===a&&(null==r||r())};return t.on(ea.ZP.EVENTS.MESSAGE_RECEIVED_AND_UPDATE,d),t.on(ea.ZP.EVENTS.MESSAGE_PULLING_STATUS,c),()=>{t.off(ea.ZP.EVENTS.MESSAGE_RECEIVED_AND_UPDATE,d),t.off(ea.ZP.EVENTS.MESSAGE_PULLING_STATUS,c)}},eg=e=>{var{data:t,useMessagesStore:o}=e,{messages:r,updateMessage:i}=o.getState(),a=t.reply_id,n=Z.r.query.findMessagesByReplyId(r,a);if(!!n.length){var l=eh(i);n.forEach(l)}},eh=e=>t=>{if(!t.is_finish)e((0,d._)((0,s._)({},t),{is_finish:!0}))},e_=(e,t)=>{var{updateMessage:o,findMessage:r,addMessage:i}=t.getState();r(e)?o(e):i(e)},ex=e=>{var{storeSet:t}=e,{useGlobalInitStore:o}=t,{setInitStatus:r,setChatCore:i,setChatCoreOffListen:a}=o.getState(),{data:n,refresh:l}=(0,ei.Z)((0,eo._)(function*(){return yield el.nA.GetConversation({preset_bot:"prompt_optimize",scene:en.xs.PromptOptimize,biz_kind:(0,er.x0)()})}),{onBefore:()=>{r("loading")},onError:()=>{r("error")}});return(0,p.useEffect)(()=>{if(!!(null==n?void 0:n.conversation_id)){var e=new ea.ZP({conversation_id:n.conversation_id,preset_bot:"prompt_optimize",env:"production",deployVersion:"release",logLevel:"error",scene:ea.xs.PromptOptimize,biz:"bot_editor",draft_mode:!1});return i(e),a(ev({chatCore:e,storeSet:t})),r("success"),()=>{o.getState().offChatCoreListen()}}},[n]),{retryInit:l}};class ew{constructor(){this.isLocked=!1,this.inputText="",this.getIsInputTextEmpty=()=>!this.inputText,this.updateInputText=e=>{this.inputText=e},this.lock=()=>{this.isLocked=!0},this.unLock=()=>{this.isLocked=!1},this.onTextAreaKeydown=(e,t)=>{if(!this.isLocked&&this.updateInputText(null!=t?t:""),"Backspace"!==e.key)return{closeNLModal:!1};this.lock();var o=this.getIsInputTextEmpty();return o&&this.unLock(),{closeNLModal:o}},this.onTextAreaKeyup=e=>{this.unLock()}}}var ey=()=>(0,_.Z)(()=>new ew,[]),eb=e=>{var{ref:t,onKeydown:o}=e;(0,p.useEffect)(()=>{if(!!t.current)return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[o])},ek=()=>{var e=(0,p.useRef)(null),t=(0,p.useRef)(null),o=(0,p.useRef)(!1),r=(0,p.useRef)(0);return{getGrabAnchorBufferExceed:()=>r.current>10,updateCheckState:r=>{var{currentLeft:i,currentTop:a}=r,n=i===e.current&&a===t.current;o.current=n,e.current=i,t.current=a},updateGrabAnchorBuffer:()=>{r.current+=1},getShouldUpdateGrabAnchor:()=>o.current,refreshCheckState:()=>{o.current=!1,r.current=0}}},ej=e=>{var{grabTarget:t,grabAnchor:o=t,isModifyStyle:r,onPositionChange:i}=e,[a,n]=(0,p.useState)(!1),l=(0,p.useRef)(!1),s=(0,p.useRef)(0),d=(0,p.useRef)(0),{getGrabAnchorBufferExceed:c,getShouldUpdateGrabAnchor:u,updateCheckState:m,updateGrabAnchorBuffer:f,refreshCheckState:v}=ek(),g=e=>{n(e),l.current=e},h=(0,p.useCallback)(e=>{var o=document.documentElement,a=t.current;if(!l.current||!a)return;e.preventDefault();var n=Math.min(Math.max(e.clientX-s.current,0),o.offsetWidth-a.offsetWidth),c=Math.min(Math.max(e.clientY-d.current,0),o.offsetHeight-a.offsetHeight);if(m({currentLeft:n,currentTop:c}),null==i||i({top:c,left:n}),!!r)a.style.left="".concat(n,"px"),a.style.top="".concat(c,"px")},[]),_=(0,p.useCallback)(()=>{g(!1),x(),v(),document.body.style.userSelect=""},[]),x=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",_)},w=()=>{document.addEventListener("mousemove",h),document.addEventListener("mouseup",_)},y=e=>{var o=t.current;if(!!o){var r=o.offsetLeft,i=o.offsetTop;s.current=e.clientX-r,d.current=e.clientY-i}};return{subscribeGrab:()=>{var e=o.current;if(!!e){var t=e=>{if(0===e.button)w(),g(!0),e.stopPropagation(),y(e),document.body.style.userSelect="none"},r=e=>{if(!l.current||!u())return;if(f(),!!c())y(e),v()};return e.addEventListener("mousedown",t),e.addEventListener("mousemove",r),()=>{e.removeEventListener("mousedown",t),e.removeEventListener("mousemove",r),v(),x()}}},grabbing:a}},eC=e=>{var{onClickOutside:t,ref:o}=e;(0,p.useEffect)(()=>{var e=o.current;if(!!e){var r=o=>{if(!(0!==o.button||e.contains(o.target)))t()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}}},[])};var eS=((i={})[i.ROUTER_STACK_CHANGE=0]="ROUTER_STACK_CHANGE",i[i.ROUTER_CONFIG_CHANGE=1]="ROUTER_CONFIG_CHANGE",i),eI=o("9475");var eT=((a={}).MAIN="__nl-prompt-main__",a.OPTIMIZE_BY_PREVIEWING_RESULT="__optimize-by-previewing-result",a),eE=e=>{var{routerConfigList:t}=(0,eI.i)(),[o,r]=(0,p.useState)();return(0,p.useEffect)(()=>(e.router.register(t),()=>{e.router.clearAllRouterConfig()}),[t]),(0,p.useEffect)(()=>{var t=e=>{var{currentRouteConfig:t}=e;r(()=>null==t?void 0:t.component)};return e.router.eventCenter.on(eS.ROUTER_STACK_CHANGE,t),e.router.push(eT.MAIN),()=>{e.router.eventCenter.off(eS.ROUTER_STACK_CHANGE,t),e.router.clearAll()}},[]),o},eN=o("618016");class eA{constructor(){this.routerConfigList=[],this.routerStack=[],this.emitRouterConfigListChange=()=>{this.eventCenter.emit(eS.ROUTER_CONFIG_CHANGE,{configList:this.routerConfigList})},this.emitRouterStackChange=()=>{this.eventCenter.emit(eS.ROUTER_STACK_CHANGE,{currentRouteConfig:this.getCurrentRouteConfig()})},this.register=e=>{this.routerConfigList=this.routerConfigList.concat(e),this.emitRouterConfigListChange()},this.removeRouterConfig=e=>{var t=this.routerConfigList.findIndex(t=>t.id===e);if(!(t<0))this.routerConfigList.splice(t,1),this.emitRouterConfigListChange()},this.clearAllRouterConfig=()=>{this.routerConfigList=[],this.emitRouterConfigListChange()},this.getCurrentRouteConfig=()=>{var e=this.routerStack.at(-1);if(!!e)return this.routerConfigList.find(t=>t.id===e)},this.push=e=>{this.routerStack.push(e),this.emitRouterStackChange()},this.pop=()=>{this.routerStack.pop(),this.emitRouterStackChange()},this.clearAllRouterStack=()=>{this.routerStack=[],this.emitRouterStackChange()},this.clearAll=()=>{this.clearAllRouterConfig(),this.clearAllRouterStack()},this.eventCenter=(0,k.Z)()}}var eP=o("416304"),eM=o("471882"),eR=o("923054");var ez=(n=(0,eo._)(function*(e){var{promptMessage:t,waiting:o,chatCore:r}=e;yield r.breakMessage({query_message_id:o.replyId,local_message_id:o.questionLocalMessageId||"",answer_message_id:t.message_id,broken_pos:t.content.length||0})}),function(e){return n.apply(this,arguments)});var eZ=(l=(0,eo._)(function*(e){var{waiting:t,chatCore:o}=e;yield o.breakMessage({query_message_id:t.replyId,local_message_id:t.questionLocalMessageId||""})}),function(e){return l.apply(this,arguments)}),eL=e=>"insert"===e?"\u5728\u8FD9\u91CC\u63D2\u5165: ":"replace"===e?"\u66FF\u6362: ":"global"===e?"\u81EA\u52A8\u4F18\u5316, \u7528\u6237\u8981\u6C42\u5982\u4E0B: ":((0,X.Sn)(e),""),eB=e=>{var{problem:t,expectation:o}=e;return"\u5E0C\u671B\u6839\u636E\u8C03\u8BD5\u7ED3\u679C\u4F18\u5316 Prompt\uFF1A\n\u7528\u6237\u5BF9\u5F53\u524DPrompt\u6548\u679C\u4E0D\u6EE1\u610F\u7684\u5730\u65B9\uFF1A".concat(t,"\n\u7528\u6237\u7684\u9884\u671F\u6548\u679C\uFF1A").concat(o)};class eD{constructor({promptEditor:e,getPromptContextInfo:t,getDraftBotConversationId:o,chatCore:r,waitingStoreAction:i,messageStoreAction:a,getOpenModalSource:n,sendTeaEvent:l}){var u,p,m,f,v,g,h=this;this.getChatExtra=()=>{var e;return{bot_conversation_id:null!==(e=this.getDraftBotConversationId())&&void 0!==e?e:"",draft_bot_id:this.getPromptContextInfo().botId,bot_chat_history:this.getPromptContextInfo().botChatHistory}},this.getCustomVariables=()=>{var e=this.promptEditor.$view.state.selection.main,{from:t,to:o}=e,r=this.promptEditor.$view.state.doc.toString(),{botName:i,botDescription:a}=this.getPromptContextInfo(),n={bot_name:i,bot_description:a,original_prompt:r};return"ai-button"===this.getOpenModalSource()?n:e.empty?(0,d._)((0,s._)({},n),{original_prompt_cursor_above:r.slice(0,t),original_prompt_cursor_below:r.slice(t)}):(0,d._)((0,s._)({},n),{original_prompt_cursor_above:r.slice(0,t),original_prompt_cursor_selected:r.slice(t,o),original_prompt_cursor_below:r.slice(o)})},this.sendMessageAndAutoUpdate=(u=(0,eo._)(function*(e){var{unsentMessage:t,options:o,sendSource:r}=e,{updateMessage:i}=h.messageStoreAction,{startSending:a,startWaiting:n,clearSending:l,clearRecentResponse:c}=h.waitingStoreAction,u=(0,d._)((0,s._)({},t),{is_finish:!1});delete u._sendFailed,i(u),a(u);var p={extendFiled:{custom_variables:h.getCustomVariables()}};try{var m=yield h.chatCore.sendMessage(u,(0,eP.Z)({},p,o));return!m._sendSource&&(m._sendSource=r),n(m),c(),i(u,m),m}catch(e){if(i((0,d._)((0,s._)({},u),{_sendFailed:!0,is_finish:!0})),(0,eM.Z)(e)){var f=ep(e.message);(null==f?void 0:f.code)&&[em.COZE_TOKEN_INSUFFICIENT,em.COZE_TOKEN_INSUFFICIENT_WORKFLOW].includes(null==f?void 0:f.code)&&(0,es.Dt)(es.wE.COZE_TOKEN_INSUFFICIENT)}throw e}finally{l()}}),function(e){return u.apply(this,arguments)}),this.sendNewMessage=(p=(0,eo._)(function*(e){var{unsentMessage:t,sendSource:o}=e,r=(0,c._)(e,["unsentMessage","sendSource"]),{addMessage:i}=h.messageStoreAction;h.waitingStoreAction,i(t);var a=yield h.sendMessageAndAutoUpdate((0,s._)({unsentMessage:t,sendSource:o},r));h.sendTeaEvent(x.Kg.prompt_optimize_front,{action:"send",reply_id:a.reply_id,type:(0,eR.O)({sendSource:o,openModalSource:h.getOpenModalSource()})})}),function(e){return p.apply(this,arguments)}),this.sendTextMessage=(m=(0,eo._)(function*(e){var{text:t}=e,o=(0,c._)(e,["text"]),r=h.chatCore.createTextMessage({payload:{text:t,mention_list:[]}});yield h.sendNewMessage((0,s._)({unsentMessage:r},o))}),function(e){return m.apply(this,arguments)}),this.firstSendMessage=(f=(0,eo._)(function*(e){var{text:t,scene:o}=e,r=(0,c._)(e,["text","scene"]),i=eL(o),a="".concat(i).concat(t);return h.sendTextMessage((0,s._)({text:a},r))}),function(e){return f.apply(this,arguments)}),this.sendAutoOptimizeMessage=(0,eo._)(function*(){return yield h.sendTextMessage({text:"\u81EA\u52A8\u4F18\u5316",sendSource:"auto-optimize"})}),this.sendOptimizeByPreviewingResultMessage=(v=(0,eo._)(function*(e){var t=eB(e);return yield h.sendTextMessage({text:t,sendSource:"optimize-by-previewing-result",options:{extendFiled:{extra:h.getChatExtra()}}})}),function(e){return v.apply(this,arguments)}),this.regenerateMessage=(g=(0,eo._)(function*(e){var t,o=h.messageStoreAction.getMessagesByReplyId(e),r=o.find(e=>"user"===e.role);if(!!r){var i=o.filter(e=>"user"!==e.role);h.messageStoreAction.deleteMessageByIdList(i.map(e=>e.message_id));var a=yield h.sendMessageAndAutoUpdate({unsentMessage:r,sendSource:null!==(t=r._sendSource)&&void 0!==t?t:"chat"});h.sendTeaEvent(x.Kg.prompt_optimize_front,{action:"regenerate",reply_id:a.reply_id,type:(0,eR.O)({sendSource:a._sendSource,openModalSource:h.getOpenModalSource()})})}}),function(e){return g.apply(this,arguments)}),this.stopResponding=(0,eo._)(function*(){var{getWaiting:e,clearAllUnsettledUnconditionally:t}=h.waitingStoreAction,{getPromptMessageByReplyId:o,updateMessage:r,getMessages:i}=h.messageStoreAction,a=e();if(!!a){t();var n=o(a.replyId);n?(yield ez({promptMessage:n,chatCore:h.chatCore,waiting:a}),r((0,d._)((0,s._)({},n),{is_finish:!0}))):yield eZ({waiting:a,chatCore:h.chatCore});var l=Z.r.common.getMessageSendSourceByReplyId(i(),{reply_id:a.replyId});h.sendTeaEvent(x.Kg.prompt_optimize_front,{action:"stop_response",reply_id:a.replyId,type:(0,eR.O)({sendSource:l,openModalSource:h.getOpenModalSource()})})}}),this.promptEditor=e,this.getPromptContextInfo=t,this.getDraftBotConversationId=o,this.chatCore=r,this.waitingStoreAction=i,this.messageStoreAction=a,this.getOpenModalSource=n,this.sendTeaEvent=l}}class eO{constructor(e){this.getChatCore=()=>this.chatCore,this.chatCore=e.chatCore,this.router=new eA,this.chat=new eD(e)}}var eF=o("230528"),eW=o("924876"),eV=o("459950"),eU=()=>{var{useGlobalInitStore:e,useMessagesStore:t,useWaitingStore:o}=(0,eF.Z)(),{getDraftBotConversationId:r,getPromptContextInfo:i,sendTeaEvent:a}=(0,eI.i)(),{nLPromptModalVisibilityService:n}=(0,eW.p)(),l=(0,eV.B)();return(0,_.Z)(()=>{var s=e.getState().getChatCore();if(!s)throw new eN.sH("normal_error","chat core is not provide");return new eO({chatCore:s,messageStoreAction:t.getState(),waitingStoreAction:o.getState(),promptEditor:l,getDraftBotConversationId:r,getPromptContextInfo:i,getOpenModalSource:n.getOpenModalSource,sendTeaEvent:a})},[])},eK=o("200625"),eY=()=>{var e=eU(),t=eE(e);return(0,u.jsx)(eK.a.Provider,{value:e,children:t?(0,u.jsx)(t,{nlPromptCore:e}):null})},eH=o("739939"),eG=o("474113"),eJ=o("415804"),eq=o("911107"),eX=e=>{var{onClick:t,disabled:o}=e,{useWaitingStore:r}=(0,eF.Z)(),i=r(e=>!!e.sending);return(0,u.jsx)(h.IconButton,{disabled:o,loading:i,icon:(0,u.jsx)(g.PdF,{}),onClick:t,color:"secondary",size:"small",wrapperClass:"flex",className:"!rounded-[36px]"})},eQ=e=>{var{children:t,className:o}=e,r=(0,c._)(e,["children","className"]);return(0,u.jsx)(h.Button,(0,d._)((0,s._)({color:"primary",size:"default",className:P()("!rounded-[200px] coz-stroke-primary border-solid !border-[1px]",o)},r),{children:t}))},e$=o("208647"),e0=[{key:"__AUTO_OPTIMIZE__",component:e=>{var{nlPromptCore:t}=e;return(0,u.jsx)(eQ,{onClick:()=>{t.chat.sendAutoOptimizeMessage()},children:v.o.t("nl2prompt_frame_auto_optimize")})}},{key:eT.OPTIMIZE_BY_PREVIEWING_RESULT,component:e=>{var{nlPromptCore:t}=e,{getPromptContextInfo:o,getDraftBotConversationId:r}=(0,eI.i)(),i=r(),{botId:a,botChatHistory:n}=o(),l=(!i||!a)&&!n;return l?null:(0,u.jsx)(eQ,{disabled:l,onClick:()=>{t.router.push(eT.OPTIMIZE_BY_PREVIEWING_RESULT)},children:v.o.t("nl2prompt_shortcut_preview")})}}],e1=()=>{var{registerShortcut:e}=(0,eI.i)(),t=(0,e$.k)(),{nLPromptModalVisibilityService:o}=(0,eW.p)();return"ai-button"!==o.getOpenModalSource()?null:(0,u.jsx)("div",{className:"flex items-center gap-x-[8px] mb-[12px]",children:e0.concat(e(t)).map(e=>{var o=e.component;return(0,u.jsx)(o,{nlPromptCore:t},e.key)})})},e2=o("649116"),e6=()=>{var e=(0,e$.k)(),{useWaitingStore:t}=(0,eF.Z)();return t(e=>!!e.waiting)?(0,u.jsx)(h.Button,{color:"highlight",icon:(0,u.jsx)(g.noE,{}),onClick:e.chat.stopResponding,className:"!coz-bg-max !coz-stroke-primary shadow-small",children:v.o.t("coze_home_stop_btn")}):null},e4=()=>{var[e,t]=(0,p.useState)(!1),{usePromptMessageStore:o}=(0,eF.Z)(),r=o(e=>!!e.promptMessage);return((0,p.useEffect)(()=>{if(!e&&!!r)t(!0)},[r]),e)?(0,u.jsx)("div",{className:"w-full mt-[12px] coz-fg-dim text-[12px] leading-[16px] text-center",children:v.o.t("chat_GenAI_tips")}):null},e3=e=>{var{openModalSource:t,isCollapsed:o}=e;return"ai-button"===t?"global":o?"insert":"replace"},e8=()=>{var{useMessagesStore:e}=(0,eF.Z)();return e(e=>{var t=e.messages.at(0);return(null==t?void 0:t.role)==="user"&&t._sendFailed})},e5=o("981325"),e9=e=>{var{onSubmit:t,defaultValue:o="",allowEmpty:r=!1,onBeforeSubmit:i,isDisabled:a=!1}=e,{inputBackspaceService:n}=(0,eW.p)(),{closeModal:l}=(0,e5.r)(),[s,d]=(0,p.useState)(o),c=(0,p.useRef)(!1),u=(0,p.useRef)(null),m=(0,p.useRef)({start:0,end:0}),f=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.resizableTextArea.textArea},v=()=>{var e=f();if(!!e){var t=e.selectionStart,o=e.selectionEnd;m.current={start:t,end:o}}},g=()=>{if((!!r||!!s.trim())&&!a&&(!i||!!i()))t(s),d("")},h=e=>{if(!("Enter"!==e.code||c.current||e7(e)))e.preventDefault(),g()},_=()=>{var e=f();if(!!e){var t=e.selectionStart;d("".concat(s.substring(0,t),"\n").concat(s.substring(t))),setTimeout(()=>{e.selectionStart=t+1,e.selectionEnd=t+1},0)}};return{onChange:e=>{v(),d(e.target.value)},setIsComposing:(e,t)=>{c.current=t},submit:g,onKeyDown:e=>{v();var t,{closeNLModal:o}=n.onTextAreaKeydown(e,null===(t=u.current)||void 0===t?void 0:t.resizableTextArea.textArea.value);if(o){l({forceClose:!1});return}if((e.metaKey||e.altKey||e.ctrlKey)&&"Enter"===e.code){_();return}h(e)},inputText:s,setInputText:d,rcTextareaRef:u,updateSelectPos:v,onKeyUp:e=>{n.onTextAreaKeyup(e),v()}}},e7=e=>"Enter"===e.code&&(e.shiftKey||e.altKey||e.metaKey),te=o("866466"),tt=o.n(te),to=o("462669"),tr=o.n(to),ti=o("318249"),ta=o.n(ti),tn=o("294754"),tl=o.n(tn),ts=o("13355"),td=o.n(ts),tc=o("876846"),tu=o.n(tc),tp=o("152854"),tm={};tm.styleTagTransform=tu(),tm.setAttributes=tl(),tm.insert=ta().bind(null,"head"),tm.domAPI=tr(),tm.insertStyleElement=td(),tt()(tp.Z,tm);var tf=tp.Z&&tp.Z.locals?tp.Z.locals:void 0,tv=()=>{var e=(0,e$.k)(),{useWaitingStore:t,useMessagesStore:o}=(0,eF.Z)(),r=(0,eV.B)(),{nLPromptModalVisibilityService:i}=(0,eW.p)(),a=t(e=>!!e.sending),n=t(e=>!!e.waiting),l=o(e=>e.messages.some(e=>"answer"===e.type)),s=e8(),d=(0,p.useRef)(null),[c,m]=(0,p.useState)(!1),{onChange:f,setIsComposing:h,onKeyDown:_,inputText:x,submit:w,rcTextareaRef:y,updateSelectPos:b,onKeyUp:k}=e9({onSubmit:t=>{if(!!t&&!a){if(l){e.chat.sendTextMessage({text:t,sendSource:"chat"});return}var o=i.getOpenModalSource(),n=r.$view.state.selection.main.empty;e.chat.firstSendMessage({text:t,scene:e3({isCollapsed:n,openModalSource:o}),sendSource:"chat"})}},isDisabled:a});return(0,p.useEffect)(()=>{if(!!d.current&&!!y.current){var e=d.current,t=y.current.resizableTextArea.textArea.clientWidth,o=new ResizeObserver(()=>{var o=e.clientWidth,r=e.clientHeight;o>t||r>22?m(!0):m(!1)});return o.observe(e),()=>{o.disconnect()}}},[]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:P()(tf.container,"p-[12px] coz-stroke-primary border-[1px] border-solid rounded-[24px] flex items-center !coz-bg-max relative gap-x-[4px]",c&&"flex-col",s&&"!coz-stroke-hglt-red"),children:[(0,u.jsx)("span",{ref:d,className:P()("absolute max-w-[100%] invisible text-[14px] leading-[20px] break-words",tf["mask-font-family"]),children:x}),(0,u.jsxs)("div",{className:P()("flex-[1] flex items-start w-full"),children:[(0,u.jsx)(g.epB,{className:"coz-fg-hglt text-[14px] mt-[5px] opacity-50"}),(0,u.jsx)(e2.Z,{className:P()("border-none py-[2px] px-[4px] text-[14px] leading-[20px] outline-none flex-[1]",tf.textarea),autoFocus:!0,autoSize:{minRows:1,maxRows:5},classNames:{textarea:tf.textarea},ref:y,placeholder:v.o.t("nl2prompt_frame_placeholder"),onChange:f,value:x,onCompositionStart:e=>h(e,!0),onCompositionEnd:e=>h(e,!1),onKeyDown:_,onKeyUp:k,onSelect:b})]}),(0,u.jsx)("div",{className:P()(c&&"self-end"),children:n?(0,u.jsx)(e6,{}):(0,u.jsx)(eX,{onClick:w,disabled:!x})})]}),s?(0,u.jsx)("div",{className:"coz-fg-hglt-red text-[12px] leading-[16px] mt-[4px]",children:v.o.t("store_chat_error_toast")}):null,(0,u.jsx)(e4,{})]})},tg=(0,p.lazy)((0,eo._)(function*(){var{PromptContent:e}=yield Promise.all([o.e("7179"),o.e("65931")]).then(o.bind(o,261208));return{default:e}})),th=(0,p.lazy)((0,eo._)(function*(){var{PromptAction:e}=yield Promise.all([o.e("89136"),o.e("13717"),o.e("74661")]).then(o.bind(o,800525));return{default:e}})),t_=[{id:eT.MAIN,component:()=>{var{useWaitingStore:e,usePromptMessageStore:t}=(0,eF.Z)(),o=e(e=>e.getIsWaitingFormal()),r=t(e=>!!e.promptMessage);return(0,u.jsxs)("div",{children:[(0,u.jsx)(p.Suspense,{fallback:null,children:(0,u.jsx)(tg,{})}),o||r?null:(0,u.jsx)(e1,{}),!o&&r?(0,u.jsx)(p.Suspense,{fallback:null,children:(0,u.jsx)(th,{})}):null,(0,u.jsx)(tv,{})]})}},{id:eT.OPTIMIZE_BY_PREVIEWING_RESULT,component:e=>{var t,{nlPromptCore:o}=e,[r,i]=(0,p.useState)(),[a,n]=(0,p.useState)(),l=()=>{o.router.pop()};var s=(t=(0,eo._)(function*(){if(!!r&&!!a)yield o.chat.sendOptimizeByPreviewingResultMessage({problem:r,expectation:a}),l()}),function(){return t.apply(this,arguments)});return(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"mb-[12px] flex items-center h-[28px] text-[14px] gap-x-[5px] leading-[20px] font-[500] cursor-pointer w-fit",onClick:l,children:[(0,u.jsx)(g.tWI,{className:"coz-fg-secondary"}),(0,u.jsx)("span",{children:v.o.t("nl2prompt_shortcut_preview")})]}),(0,u.jsxs)("div",{className:"px-[8px] pb-[6px] font-[500] text-[12px] leading-16px",children:[(0,u.jsx)("span",{className:"coz-fg-secondary",children:v.o.t("nl2prompt_shortcut_preview_describe_unsatisfied")}),(0,u.jsx)("span",{className:"coz-fg-hglt-red",children:"*"})]}),(0,u.jsx)(h.TextArea,{className:"mb-[18px]",autoFocus:!0,value:r,onChange:i,placeholder:v.o.t("nl2prompt_shortcut_preview_describe_unsatisfied_placeholder"),autosize:{minRows:1,maxRows:7}}),(0,u.jsxs)("div",{className:"px-[8px] pb-[6px] font-[500] text-[12px] leading-16px",children:[(0,u.jsx)("span",{className:"coz-fg-secondary",children:v.o.t("nl2prompt_shortcut_preview_describe_expectation")}),(0,u.jsx)("span",{className:"coz-fg-hglt-red",children:"*"})]}),(0,u.jsx)(h.TextArea,{className:"mb-[12px]",value:a,onChange:n,placeholder:v.o.t("nl2prompt_shortcut_preview_describe_expectation_placeholder"),autosize:{minRows:1,maxRows:7}}),(0,u.jsx)("div",{className:"w-[100%] flex justify-end",children:(0,u.jsx)(eX,{onClick:s,disabled:!r||!a})})]})}}],tx=e=>{var{nLPromptModalVisibilityService:t,useFreeDragModalHierarchy:o,routerConfigList:r=[],registerShortcut:i=()=>[],className:a,getDraftBotConversationId:n,getPromptContextInfo:l,getPromptEditor:d,getIsReadonly:c,sendTeaEvent:m,useNLPromptModalStore:f}=e,{left:g,top:_}=f((0,N.N)(e=>e.position)),x=(0,p.useRef)(!1),w=(0,p.useRef)(null),y=o({key:"nl-prompt-modal",ref:w}),{subscribeGrab:b}=ej({grabTarget:w,isModifyStyle:!1,onPositionChange:e=>{f.getState().updatePosition(t=>(0,s._)({},t,e))}}),k=()=>x.current,j=e=>{x.current=e},C=et(),S=ey();G({storeSet:C});var{retryInit:I}=ex({storeSet:C}),T=C.useGlobalInitStore(e=>e.initStatus),E=()=>{if(!k())(0,M.H)({forceClose:!1,onShowCloseModal:j,payload:{modalVisibilityService:t,storeSet:C,getPromptEditor:d}})};return(0,p.useEffect)(b,[]),eC({ref:w,onClickOutside:E}),eb({ref:w,onKeydown:e=>{if("Escape"===e.key)E()}}),J({onResize:E}),q({ref:w,nlModalStore:f}),(0,u.jsx)(eH.l.Provider,{value:C,children:(0,u.jsx)(eG.i.Provider,{value:{nLPromptModalVisibilityService:t,inputBackspaceService:S},children:(0,u.jsx)(eq.e.Provider,{value:{routerConfigList:t_.concat(r),registerShortcut:i,getDraftBotConversationId:n,getPromptContextInfo:l,getPromptEditor:d,getIsReadonly:c,sendTeaEvent:m},children:(0,u.jsx)(eJ.M.Provider,{value:{setIsShowCloseModal:j,getIsShowCloseModal:k},children:(0,u.jsx)("div",{className:"absolute left-0 top-0",style:{zIndex:y},children:(0,u.jsxs)("div",{style:{left:g,top:_},ref:w,className:P()("absolute coz-stroke-primary border-[1px] border-solid coz-bg-plus rounded-xl shadow-large overflow-hidden p-[16px] w-[422px] box-content pointer-events-auto",a),children:[(0,u.jsx)("div",{style:{width:0,height:0,position:"absolute",overflow:"hidden"},children:(0,u.jsx)("input",{autoFocus:!0})}),"error"===T?(0,u.jsxs)("div",{className:"text-[14px] flex items-center",children:[(0,u.jsx)("span",{children:v.o.t("coze_home_page_fail_text")}),(0,u.jsx)("span",{className:"coz-fg-hglt cursor-pointer",onClick:I,children:v.o.t("coze_home_page_fail_btn_retry")})]}):null,"loading"===T||"unInit"===T?(0,u.jsx)(h.Loading,{loading:!0}):null,"success"===T?(0,u.jsx)(eY,{}):null]})})})})})})},tw=e=>{var{useNLPromptModalStore:t}=e;return t(e=>e.visible)?(0,E.createPortal)((0,u.jsx)(tx,(0,s._)({},e)),document.body):null},ty=e=>{var{key:t,ref:o}=e,{freeGrabModalHierarchyService:r,useFreeGrabModalHierarchyStore:i}=I(),a=i(e=>r.getModalZIndex(e.getModalIndex(t)));return(0,p.useEffect)(()=>{r.registerModal(t);var e=o.current;if(!!e){var i=()=>{r.onFocus(t)};return e.addEventListener("focus",i),()=>{r.removeModal(t),e.removeEventListener("focus",i)}}},[t]),a},tb=e=>{var{getConversationId:t,getPromptContextInfo:o}=e,{nLPromptModalVisibilityService:r,useNLPromptModalStore:i}=I(),a=(0,m.jE)();return(0,u.jsx)(tw,{nLPromptModalVisibilityService:r,useFreeDragModalHierarchy:ty,useNLPromptModalStore:i,getPromptContextInfo:()=>{var{botId:e="",name:t="",description:r="",contextHistory:i=""}=(null==o?void 0:o())||{};return{botId:e,botName:t,botDescription:r,botChatHistory:i}},getDraftBotConversationId:()=>null==t?void 0:t(),getPromptEditor:()=>a,getIsReadonly:()=>a.$view.state.readOnly,sendTeaEvent:x.Gg})},tk=o("846955"),tj=e=>{var t=(0,m.jE)(),{className:o}=e,{nLPromptModalVisibilityService:r}=I(),{size:i,controller:a}=(0,tk.YE)();return(0,u.jsx)("div",{className:"hover:coz-mg-secondary-hovered coz-icon-button coz-icon-button-default rounded-little",children:(0,u.jsx)(h.Tooltip,{content:v.o.t("prompt_optimization_button_hover_tooltip"),position:"bottom",children:(0,u.jsx)(h.IconButton,{color:"primary",icon:(0,u.jsx)(g.epB,{}),className:P()("!bg-transparent",o),size:i,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:e=>{e.preventDefault(),e.stopPropagation();var o,i,n=(0,f.gV)(t);if(!!n)r.open({top:null!==(o=n.bottom)&&void 0!==o?o:0,left:null!==(i=n.left)&&void 0!==i?i:0},"editor-float-trigger"),a.rePosition("topLeft")}})})})},tC=o("112137"),tS=e=>{var t,o,{shortcutKey:r}=e,i=(0,m.jE)(),a=(0,m.G6)(),[n,l]=(0,p.useState)(null==i?void 0:null===(o=i.$view)||void 0===o?void 0:null===(t=o.state)||void 0===t?void 0:t.readOnly),s=!i||n,{nLPromptModalVisibilityService:d}=I(),c=(0,p.useCallback)(e=>{var{state:t}=e;l(t.readOnly)},[]);return(0,p.useEffect)(()=>(null==i||i.$on("viewUpdate",c),()=>{null==i||i.$off("viewUpdate",c)}),[i,c]),(0,p.useLayoutEffect)(()=>{if(!s)return a.inject([(0,tC.Hw)([{type:"character",triggerCharacter:"/",handler(e){var{from:t,to:o}=e;return setTimeout(()=>{var e,o=null==i?void 0:null===(e=i.$view)||void 0===e?void 0:e.coordsAtPos(t);if(!o)return!1;d.open({left:o.left,top:o.bottom},"editor-shortcut")},100),!1}}])])},[a,d,r,s]),null}},523192:function(e,t,o){o.d(t,{b:()=>w});var r=o("466759"),i=o("999016"),a=o("341333"),n=o("265489"),l=o("938809"),s=o("723530"),d=o("1179"),c=o("889707"),u=o("886073"),p=o("411960"),m=o("999061"),f=o("646411"),v=o("16242"),g=o("182956"),h=o("618016"),_=e=>{var{onReturn:t,value:o,onChange:r,file:i,onImport:a,spaceId:n,renderAutoGenerate:_}=e,x=(0,s.useRef)(null),{handleImport:w,loading:y}=(0,d._N)({value:o,onImport:a,spaceId:n}),b=(null==o?void 0:o.flow_mode)===m.wz.ChatFlow,[k,j]=(0,s.useState)(!1);return(0,l.jsxs)(g.Form,{ref:x,showValidateIcon:!1,onValueChange:e=>{var t,o;j(!(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.trim())||!(null==e?void 0:null===(o=e.desc)||void 0===o?void 0:o.trim())||!c.Pz_.test(null==e?void 0:e.name)),null==r||r(e)},className:"flex flex-col gap-4",initValues:o,children:[(0,l.jsx)(d.ut,{file:i}),(0,l.jsx)(g.FormInput,{field:"name",placeholder:b?v.o.t("wf_chatflow_91"):v.o.t("workflow_list_create_modal_name_placeholder"),label:b?v.o.t("wf_chatflow_85"):v.o.t("workflow_list_create_modal_name_label"),rules:[{required:!0,message:b?v.o.t("wf_chatflow_93"):v.o.t("workflow_list_create_modal_name_rule_required")},{validator:(e,t)=>!!c.Pz_.test(t)||new h.sH(p.b.formValidation,b?v.o.t("wf_chatflow_94"):v.o.t("imageflow_create_name_wrong_format"))}]}),(0,l.jsx)(g.FormTextArea,{field:"desc",label:b?v.o.t("wf_chatflow_86"):v.o.t("workflow_list_create_modal_description_label"),maxCount:600,maxLength:600,placeholder:b?v.o.t("wf_chatflow_92"):v.o.t("workflow_list_create_modal_description_placeholder"),rules:[{required:!0,message:b?v.o.t("wf_chatflow_122"):v.o.t("workflow_list_create_modal_description_rule_required")}]}),(0,l.jsx)(u.s,{label:v.o.t("export_import_agent_flow_33"),field:"icon",initValue:null==o?void 0:o.icon,iconType:b?f.Tu.ChatFlow:f.Tu.Workflow,fileBizType:f.ym.BIZ_BOT_WORKFLOW,withAutoGenerate:!0,renderAutoGenerate:_,generateInfo:{name:(null==o?void 0:o.name)||"",desc:null==o?void 0:o.desc},rules:[{required:!0,message:"Icon Required"}]}),(0,l.jsxs)("div",{className:"h-10 flex justify-end align-end gap-2",children:[(0,l.jsx)(g.Button,{onClick:()=>{j(!1),null==t||t()},children:v.o.t("export_import_agent_flow_34")}),(0,l.jsx)(g.Button,{onClick:()=>{w()},loading:y,disabled:k,children:v.o.t("export_import_agent_flow_1")})]})]})},x=o("808656"),w=e=>(0,l.jsx)(_,(0,n._)((0,a._)({},e),{renderAutoGenerate:e=>{var t=(0,r._)({},(0,i._)(e));return(0,l.jsx)(x.h,(0,n._)((0,a._)({},t),{onChange:e=>{if(t.setShowAiAvatar(!0),e){var o;null===(o=t.onChange)||void 0===o||o.call(t,e)}}}))}}))},209282:function(e,t,o){o.d(t,{ng:()=>W.n,Co:()=>eA.Co,LA:()=>eM.LA,xm:()=>n.x,YN:()=>eP.YN,lR:()=>eR,WC:()=>u.WC,fP:()=>eP.fP,uR:()=>eA.uR,ew:()=>eA.ew,PF:()=>F,Ys:()=>eP.Ys,kq:()=>eA.kq,Ur:()=>eZ,rZ:()=>eP.rZ,h5:()=>eN.h5,T7:()=>eE,ad:()=>eP.ad,nz:()=>u.nz,AK:()=>eM.AK});var r,i,a,n=o("522093"),l=o("938809"),s=o("723530"),d=o("559293"),c=o("449001"),u=o("596598"),p=o("771232"),m=o("16242"),f=o("988726"),v=o("182956"),g=o("64249"),h=o("255721"),_=o("341333"),x=o("265489"),w=o("387294"),y=o("765337"),b=o("221968"),k=o.n(b),j=o("213305"),C=o("448082"),{Text:S}=v.Typography,I=e=>{var t,o,r,i,a,d,u,{voice:p,onClick:g,isLibraryVoice:w,playingVoiceId:y,onGrabPlayingVoiceRight:b,workflowId:I}=e,{voice_name:T,voice_desc:E,create_time:N,create_user_info:A,icon_url:P,preview_audio:M,language_name:R,scene:z,support_emotions:Z,is_multi_emotion_voice:L}=p,[B]=(0,C.V)(),{isPlaying:D,play:O,stop:F,pause:W}=(0,n.x)(M),[V,U]=(0,s.useState)(!1),K=(0,s.useMemo)(()=>null==Z?void 0:Z.map(e=>{var t,o;return{label:null!==(t=e.display_name)&&void 0!==t?t:"",value:null!==(o=e.emotion)&&void 0!==o?o:""}}),[Z]),[Y,H]=(0,s.useState)(null!==(d=null==Z?void 0:null===(t=Z.at(0))||void 0===t?void 0:t.emotion)&&void 0!==d?d:""),[G,J]=(0,s.useState)(null!==(u=null==Z?void 0:null===(r=Z.at(0))||void 0===r?void 0:null===(o=r.emotion_scale_interval)||void 0===o?void 0:o.default)&&void 0!==u?u:4),q=(0,s.useMemo)(()=>null==Z?void 0:Z.find(e=>e.emotion===Y),[Z,Y]);return(0,s.useEffect)(()=>{D&&y!==p.voice_id&&F()},[y,p.voice_id,F,D,O]),(0,l.jsxs)("div",{className:"flex w-full items-center h-[90px]",children:[(0,l.jsxs)("div",{className:"flex pl-[16px] gap-2 items-center grow",children:[(0,l.jsx)(v.Avatar,{src:P,className:"w-[36px] h-[36px] rounded-[9px]",shape:"square"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center gap-1 mb-[6px]",children:[(0,l.jsx)(S,{className:"font-medium text-[var(--Fg-COZ-fg-primary,rgba(32,41,65,0.89))]",ellipsis:{showTooltip:!1,rows:1},children:T}),D?(0,l.jsx)(f.pjt,{color:"#4E40E5",className:"cursor-pointer",onClick:()=>{W()}}):(0,l.jsx)(v.Tooltip,{theme:"dark",disableFocusListener:!0,visible:L,style:{maxWidth:"none"},content:L?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{children:m.o.t("bot_edit_voices_modal_add_language_listen")}),(0,l.jsx)(j.A,{dark:!0,dismissKey:"workflow_voice_emotion",className:"mt-[12px]",description:m.o.t("voice_emo_audition_tips")})]}):m.o.t("bot_edit_voices_modal_add_language_listen"),children:(0,l.jsx)("div",{children:(0,l.jsx)(f.JE7,{color:"#4E40E5",className:"cursor-pointer",onClick:(0,h._)(function*(){if(!V){U(!0),null==b||b(p.voice_id);var e=M;if(L&&0!==G){var{data:t}=yield c.lv.APIAudioSpeech({input:p.preview_text||"",voice_id:p.voice_id,emotion:Y,emotion_scale:Number(G),extented:{entity_type:"workflow",entity_id:I||""}});e=(null==t?void 0:t.bas464_content)&&"data:audio/mpeg;base64,".concat(null==t?void 0:t.bas464_content)||M}setTimeout(()=>{O(e),U(!1)},0)}})})})})]}),(0,l.jsx)("div",{className:"flex items-center gap-1 mb-[6px]",children:w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.Tag,{size:"mini",className:"flex-shrink-0 flex-grow-0 font-medium",color:"primary",children:R}),E?(0,l.jsx)(S,{ellipsis:{showTooltip:!0,rows:1},fontSize:"12px",className:"text-[var(--Fg-COZ-fg-secondary,rgba(44,58,92,0.72))]",children:E}):null]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.Tag,{size:"mini",className:"flex-shrink-0 flex-grow-0 font-medium ",color:"primary",children:z}),(0,l.jsx)(v.Tag,{size:"mini",className:"flex-shrink-0 flex-grow-0 font-medium",color:"primary",children:R})]})}),w?(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(null==A?void 0:A.avatar_url)?(0,l.jsx)(v.Image,{width:14,height:14,className:"rounded-[8px]",src:null==A?void 0:A.avatar_url,fallback:(0,l.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAepSURBVHgB5VtbaxtHFD570826RHIdhzjQUJoWQslr/z8USimE0oc8tIFeaGljE7eKLUt7md1+32pWlm3JuuzMWko/GHa1Gmn3nDn3OeuIffgYzU6nU0vTNMDwsyxzMfz5SY7jJBip67rJaDQKcSnC4DERi3DEDkhwK47jA5x7k8mExHCkMiWIR3XrN54erkyZFjQaDZ9M8Txvcgng2lgMwyQD3B4QhmEPBJPIYgVjKYcAowZmtMiM8Xj8Dz5PxJBkmGBAQXgHhJNYrlIkdkBmtMCMeq1W+0BISUaUYkC/3+9hRfognERTRDOpBlSVdrPZ9LVEXMqW2JYBfqvVenx1dUV9Hcpdfa4KHpjQw9EBI/6SLaTB23B+vuo4HOGG1EOKYFWrvghZkiRjDBdqMcCR18JN/mAjBsCyH0LXuxB5ip0tPd8GMYgPwYT+wcGBi2ecrPvDtRnQbreP4IkauNG5TN3YroHSMEEc0aWRjKLoap0frcUA6NkJ9J324l/ZbeQq4ft+C6OH84tVP3BXTeDKQ9+54kPZE2CxhowZ+Oyr5t4rAXDv/YuLi6bs/srfAaLQEBFkB97Kh01YGkEuZQCtPYxdT+v8XoKGEZLw6D7vsIwBjMWPtLXfRYO3LjLtHciEkSygZaENwA+egnha0YcKcExCMVKFKiy0B4sYwJienFrLjewJRki/Ke2921/cZoDPYEL2yOKvC3iyoabtBs03bAAivb7298bz7h0A7QHppX2bRYrzDPARRR1hElffenwPZjdxvwECloN6ve7CbVURWsfaIDJAymmczwY7GG2xLP54gMfQxy9QFevMX4e7gtSpn+Gz/xS7oB2gBNDDXUsAHuyJ5ow1txcEBy9w+Ark1hd9jevHrlt30jS2GXtkWgry4K4oTDLaozRYK0CSeESnn8+eIkv+gNifT78LBo7jP+M556Dag1wm+k3sIGIBFscGxiSXAMTMNH7UwbL1uyXoNH0/fYUTVynF2OR7VIdJICXuAuenStVPPU+eco7jeI+Uin8XS9I4ZwzHrr5ACbBmhOr1aIA1z6VNKfkJhwUiPkJxJfmFZ7ARAaTgROyB0SEr1rMStFXxT1N3cP0pOl02b17sEbd0xR4o6bkUkAF1Xc2tCvfFGJU9B+wAJb5JBtTE8u4Llez6vDlYPu9gbtUTq8xAZEgG1FzU0OiSrN4sjv13xXkQyLNl84IgfX79G892Gk4D67vcqxPrkd/4XKk0F33HkRMdD8xh4AdB6yW/46fp3Mmp2EXCfYV8o1IqSHuV8l97XvY1vQF9fb3eOuFOF76K03RyWHiJ6dzwtdhHygyROIRvXlk8LI84BBMQfaWHrutwiyvIMqeJwfA7d8dFjCDVlOBIfddDMtLHjbfeWtoMyTjL1Dul3BjiHsAS5yExRP4qSdJfsyz6AR9HUhFAe9uX6gGxj97CL7yVHUAlDICxwbaVcwyLE6wzH3NjzH0HV2W9IOvrxIBRkXFDWKu1n0PnXyhFw5cxDF4Leu5zGEqbKbJH2j1kYh1YnqJ7wxiCoPkKhHwma2y+3Pc3TJGRKXbTNDkTs88I0gOfVaBkeiNz0eDUp2fap6sEq4kkJ6I4ryvSXTzcp0WKDK9xDIa+jOPxj2IOLlQs8ZCT0xIzGTISDaK8BcKdL3nOgEap6FucMajZpM4YTlPkBKLvHdNtwmt0lQrO6UnEDFgPiCmeeUwshqCU8+T6PPxOyhVYwUB3tuowjC/EEGCYKfUhGTBGbmyMASx08pim2XsxUl0enyNizAM1z7tZRywD3aYXkQFF25ohlzgNaadFTjNAPSEv1LJQImbAICxv2cstNOoBjL4a8v9BTbf4zFZ9BJ34BBfFFLBaralBLA/EEewRFFNgzyEWPU/RCwZMtE7QFpSqDcJ6X8AOdGC5B0h0BmIAro4kipS6JArxzyVgFqSAI0PsoDalJJLEfQMLYLzCNI0nnDdSEqCxpXsLc8wbviFWj1aWslaiQDI+jyL5BiddMZtrUGTLMtYDjYx7zooLtxWLbWa10WhUQX2gemDxe9j/YKfILCK9HacPIWpUg40bKPcAnrZzH25cvDWJW8gZPEKX7WbyEQE09aH7rDTdaKJclKmxxYyJa0s+EmDrj7tAVPc7la+Foo4EaaJ7b6kvD9kLbAIe3TK8HJup76TTy3Q9ZWsZW0r2XBUc0HAI4in6C+m4z9iFIN6H7nT2lQksxYF4erSlTR+rqjXvUToO6T5kz8BnhtGjCt9bYl9Zrrq8vDzj5sk+MYHPqjd8zlbNXcvfs3UGiU2TvbdsSZfdhUOxx8rz/YG/1/qBbIZHMCrsIWYktWtdpB49l9b5tcvpm0Z8E+0digbkKvsKloJ+Xrs66vtG22pbvzTFfmL9Ht+DvzSFZ+D9qe8bJ0tlqwwdxgrgfowkg1FWVYxwkLR1kLc0tDp+kC1hoszCBKMHRqAI4oZgBMtrtjpOaqxZ8B1kEE6iOUptlph8dTZ/SVo3JDu63d7Ey88+dLyB1a4xm9N6XprwArZenmaBleqRN2BqFSEjaDSZWyhZ/PI0n4eVX8YdfNOcDVycN9LDuAu2xYB5FLXGuj7ys4e44ka1CBugZBCJTfRgbXIslhu4/gPxX59LVZbYmwAAAABJRU5ErkJggg==",width:"100%",height:"100%"}),preview:!1}):null,A?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(S,{className:"text-[var(--Fg-COZ-fg-secondary,rgba(44,58,92,0.72))]",fontSize:"12px",children:null==A?void 0:A.nickname}),(0,l.jsx)(S,{className:"text-[var(--Fg-COZ-fg-dim,rgba(62,82,130,0.50))] pl-[4px]",fontSize:"12px",children:"@ ".concat(null==A?void 0:A.name)})]}):null,(0,l.jsx)(v.Divider,{layout:"vertical",className:"h-[8px]"}),N?(0,l.jsxs)(S,{className:"text-[var(--Fg-COZ-fg-dim,rgba(62,82,130,0.50))]",fontSize:"12px",children:[m.o.t("workflow_select_voice_published"),k().unix(N).format("YYYY-MM-DD HH:mm:ss")]}):null]}):null]})]}),L&&B["bot.studio.emtion_config"]?(0,l.jsxs)("div",{className:"flex gap-1 mr-[4px] w-[224px]",children:[(0,l.jsx)(v.Select,{optionList:K,placeholder:m.o.t("voice_select_emotion"),onChange:e=>{if(e){if(0===G){var t,o;J(null!==(o=null==q?void 0:null===(t=q.emotion_scale_interval)||void 0===t?void 0:t.default)&&void 0!==o?o:4)}}else J(0);H(e)},value:Y,className:"w-full",showClear:!0}),(0,l.jsx)(v.CozInputNumber,{placeholder:m.o.t("voice_emotion_value"),className:"w-full",onBlur:()=>{if(""===G||isNaN(Number(G))){var e,t;J(null!==(t=null==q?void 0:null===(e=q.emotion_scale_interval)||void 0===e?void 0:e.default)&&void 0!==t?t:4)}},onChange:e=>{J(e)},value:G,min:null==q?void 0:null===(i=q.emotion_scale_interval)||void 0===i?void 0:i.min,max:null==q?void 0:null===(a=q.emotion_scale_interval)||void 0===a?void 0:a.max,step:.1,precision:1,hideButtons:!1})]}):null,(0,l.jsx)(v.Button,{className:"w-[82px]",color:"primary",onClick:()=>null==g?void 0:g((0,x._)((0,_._)({},p),{emotion:Y,emotionValue:Number(G)})),children:m.o.t("workflow_select_voice_add")})]})};var T=(r=(0,h._)(function*(e){var{name:t,languageCode:o,selfCreated:r,voiceType:i,pageIndex:a,pageSize:n,scene:l,gender:s,age:d,spaceId:u,voiceState:p,modelType:m}=e,{data:{voices:f=[],has_more:v}={}}=yield c.lv.APIMGetVoice({prefix_voice_name:t,language_code:o,scene:l,gender:s,age:d,self_created:r,voice_type:i,page_index:a,page_size:n,space_id:u,voice_state:p,model_type:m});return{list:f,hasMore:v,nextPage:a?a+1:2}}),function(e){return r.apply(this,arguments)}),E=e=>{var t,o,{filter:r,voiceType:i,onSelectVoice:a,workflowId:n}=e,d=(0,s.useRef)(null),[c,u]=(0,s.useState)(null),{data:p,loading:f}=(0,w.Z)(e=>T((0,x._)((0,_._)({},r),{voiceType:i,pageSize:10,pageIndex:null==e?void 0:e.nextPage})),{target:d,reloadDeps:[r,i],isNoMore:e=>!(null==e?void 0:e.hasMore)});return(0,l.jsx)("div",{className:"w-full h-full overflow-y-auto",ref:d,children:f?(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(v.Loading,{loading:!0})}):Number(null==p?void 0:null===(t=p.list)||void 0===t?void 0:t.length)>0?(0,l.jsx)("div",{className:"divide-x-0 divide-y divide-slate-200 divide-solid",children:null==p?void 0:null===(o=p.list)||void 0===o?void 0:o.map(e=>(0,l.jsx)(I,{workflowId:n,isLibraryVoice:i===g.w8.UserVoice,voice:e,onClick:a,playingVoiceId:c,onGrabPlayingVoiceRight:u},e.voice_id))}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(y.Zo,{width:"120",height:"120"}),(0,l.jsx)(v.Typography.Title,{className:"!mt-[16px]",fontSize:"16px",children:m.o.t("workflow_select_voice_null")})]})})})},N=()=>{var e,t,o,r,i,a,n,l,s,u,{loading:p,data:{data:m}={}}=(0,d.Z)(()=>c.lv.APIGetVoiceMenu()),f=null!==(a=null==m?void 0:null===(e=m.scenes)||void 0===e?void 0:e.map(e=>({label:e,value:e})))&&void 0!==a?a:[],v=null!==(n=null==m?void 0:null===(t=m.languages)||void 0===t?void 0:t.map(e=>{var t,o;return{label:null!==(o=null!==(t=e.language_name)&&void 0!==t?t:e.language_code)&&void 0!==o?o:"",value:e.language_code}}))&&void 0!==n?n:[],g=null!==(l=null==m?void 0:null===(o=m.genders)||void 0===o?void 0:o.map(e=>({label:e,value:e})))&&void 0!==l?l:[],h=null!==(s=null==m?void 0:null===(r=m.ages)||void 0===r?void 0:r.map(e=>({label:e,value:e})))&&void 0!==s?s:[];return{loading:p,sceneOptions:f,languageOptions:v,genderOptions:g,ageOptions:h,modelTypes:null!==(u=null==m?void 0:null===(i=m.model_infos)||void 0===i?void 0:i.map(e=>({label:null==e?void 0:e.model_name,value:null==e?void 0:e.model_type})))&&void 0!==u?u:[]}},A=o("856306"),P=o.n(A),{Text:M}=v.Typography,R=e=>{var{value:t,prefix:o,children:r,selectedValue:i,onSelect:a}=e;return(0,l.jsxs)("div",{className:P()("w-full h-[32px] px-[8px] py-[6px] flex items-center gap-[8px] rounded-[8px] cursor-pointer coz-fg-plus","hover:coz-mg-primary-hovered active:hover:coz-mg-primary-pressed",{"coz-mg-primary":t===i}),onClick:()=>{a(t)},children:[o||null,(0,l.jsx)(M,{weight:500,ellipsis:!0,children:r})]})};function z(e){var{title:t,options:o,value:r,onChange:i,disabled:a}=e;return 0===o.length?null:(0,l.jsxs)("div",{className:"flex flex-col gap-[2px]",children:[(0,l.jsxs)("div",{className:"flex h-[24px] pl-[32px] items-center",children:[(0,l.jsx)(v.Typography.Text,{type:"secondary",fontSize:"14px",children:t}),a?null:(0,l.jsx)(v.Typography.Text,{link:void 0!==r,fontSize:"14px",className:"ml-[16px]",disabled:void 0===r,onClick:()=>i(void 0),style:{display:void 0===r?"none":void 0},children:m.o.t("Reset")})]}),(0,l.jsx)(v.Radio.Group,{direction:"vertical",value:r,disabled:a,onChange:e=>i(e.target.value),className:"gap-[2px]",children:o.map(e=>(0,l.jsx)(v.Radio,{value:e.value,className:"h-[28px] pl-[32px] flex items-center",children:e.label},e.value))})]})}function Z(e){var{visible:t=!0,children:o}=e;return t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.Divider,{layout:"horizontal",className:"mt-[8px] w-[calc(100%-16px)]"}),(0,l.jsx)("div",{className:"overflow-auto flex flex-col gap-[8px] py-[8px]",children:o}),(0,l.jsx)(v.Divider,{layout:"horizontal",className:"mb-[8px] w-[calc(100%-16px)]"})]}):null}var L=((i={})[i.All=1]="All",i[i.Mine=2]="Mine",i),B=[{label:m.o.t("workflow_select_voice_library_filter_all"),value:1},{label:m.o.t("workflow_select_voice_library_filter_mine"),value:2}],D=e=>{var{onCreate:t}=e;return(0,l.jsx)(v.Button,{size:"default",color:"highlight",className:"w-[208px]",onClick:()=>{null==t||t()},icon:(0,l.jsx)(f.PwN,{}),children:m.o.t("workflow_select_voice_create")})},O=e=>{var{visible:t,onClose:o,spaceId:r,onSelectVoice:i,isCozePro:a,voiceFgEnable:n,workflowId:d,modelType:c,modelTypeFilterDisabled:u}=e,[h,_]=(0,s.useState)(a?"library":"preset"),[x,w]=(0,s.useState)(""),y=(0,p.Z)(x,{wait:500}),[b,k]=(0,s.useState)(L.All),[j,C]=(0,s.useState)(),[S,I]=(0,s.useState)(),[T,A]=(0,s.useState)(),[P,M]=(0,s.useState)(c),[O,F]=(0,s.useState)(),W=(0,s.useMemo)(()=>({name:y,selfCreated:b===L.Mine,languageCode:O,spaceId:r,voiceState:g.lV.Cloned}),[y,b,O,r]),V=(0,s.useMemo)(()=>({name:y,scene:j,languageCode:O,gender:S,age:T,modelType:P}),[y,j,O,S,T,P]),{sceneOptions:U,languageOptions:K,genderOptions:Y,ageOptions:H,modelTypes:G}=N();return(0,l.jsx)(v.Modal,{className:"[&_.semi-modal-content]:!p-0 [&_.semi-modal-footer]:hidden",visible:t,header:null,footer:null,width:1040,height:740,children:(0,l.jsxs)("div",{className:"flex w-full h-full",children:[(0,l.jsxs)("div",{className:"flex flex-col w-[240px] h-full pt-[22px] px-4 gap-4 coz-bg-primary",children:[(0,l.jsx)("span",{className:"coz-fg-plus font-medium text-[20px] leading-[28px]",children:m.o.t("workflow_select_voice_title")}),(0,l.jsx)(D,{onCreate:()=>{window.open("/space/".concat(r,"/library?create_voice=1"))},isCozePro:a,voiceFgEnable:n}),(0,l.jsxs)("div",{className:"grow overflow-hidden w-full flex flex-col gap-[4px]",children:[a?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R,{value:"library",selectedValue:h,onSelect:()=>_("library"),prefix:(0,l.jsx)(f.Iqn,{}),children:m.o.t("workflow_select_voice_library")}),(0,l.jsx)(Z,{visible:"library"===h,children:(0,l.jsx)(z,{title:m.o.t("workflow_select_voice_official_filter_language"),options:K,value:O,onChange:F})})]}):null,(0,l.jsx)(R,{value:"preset",selectedValue:h,onSelect:()=>_("preset"),prefix:(0,l.jsx)(f.scq,{}),children:m.o.t("workflow_select_voice_official")}),(0,l.jsxs)(Z,{visible:"preset"===h,children:[(0,l.jsx)(z,{title:m.o.t("workflow_select_voice_official_filter_language"),options:K,value:O,onChange:F}),(0,l.jsx)(z,{title:m.o.t("workflow_select_voice_official_filter_scene"),options:U,value:j,onChange:C}),(0,l.jsx)(z,{title:m.o.t("voice_select_gender"),options:Y,value:S,onChange:I}),(0,l.jsx)(z,{title:m.o.t("voice_select_age"),options:H,value:T,onChange:A}),(0,l.jsx)(z,{title:m.o.t("voice_model_type"),options:G,value:P,onChange:M,disabled:u})]})]})]}),(0,l.jsxs)("div",{className:"grow pt-[16px] px-[24px] w-full h-full flex flex-col gap-[16px] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"flex shrink-0 items-center justify-between h-[40px]",children:[(0,l.jsx)("span",{className:"coz-fg-plus font-medium text-[20px] leading-[28px]",children:"library"===h?m.o.t("workflow_select_voice_library"):m.o.t("workflow_select_voice_official")}),(0,l.jsx)(v.IconButton,{color:"secondary",icon:(0,l.jsx)(f.rmE,{className:"text-[20px]"}),onClick:o})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:["library"===h?(0,l.jsx)(v.Select,{optionList:B,insetLabel:m.o.t("workflow_select_voice_library_creator"),onChange:e=>k(e),value:b,className:"min-w-[114px]"}):(0,l.jsx)(v.Typography.Text,{type:"secondary",className:"self-center",children:m.o.t("voice_select_tips")}),(0,l.jsx)(v.Input,{value:x,onChange:w,prefix:(0,l.jsx)(f.SHo,{}),placeholder:m.o.t("workflow_select_voice_search"),className:"w-[146px]"})]}),(0,l.jsx)("div",{className:"w-full grow overflow-hidden",children:"library"===h?(0,l.jsx)(E,{filter:W,voiceType:g.w8.UserVoice,onSelectVoice:i,workflowId:d},"library"):(0,l.jsx)(E,{filter:V,voiceType:g.w8.SystemVoice,onSelectVoice:i,workflowId:d},"preset")})]})]})})},F=e=>{var{spaceId:t,onSelectVoice:o,workflowId:r,modelType:i,modelTypeFilterDisabled:a}=e,[n,p]=(0,s.useState)(!1),{value:m}=(0,u.iv)(),{data:{data:{enable:f=!1}={}}={}}=(0,d.Z)(()=>c.lv.APIVoiceFeatureGateway());return{open:()=>{p(!0)},modal:n?(0,l.jsx)(O,{modelTypeFilterDisabled:a,modelType:i,spaceId:t,visible:n,isCozePro:m,voiceFgEnable:f,workflowId:r,onClose:()=>{p(!1)},onSelectVoice:e=>{null==o||o(e),p(!1)}}):null}},W=o("682178"),V=o("842197"),U=o("166011"),K=o("271886"),Y=o("797602"),H=o("972344"),G=o("743509"),J=o("197390"),q=o("411960"),X=o("642385"),Q=o("168074"),$=o("18862"),ee=o("811396"),et=o("822257"),eo=o("115558"),er=o("989637"),ei=o("543473"),ea=o("712783"),en=o("630587");var el=((a=(0,en.HA)("import-knowledge-source-text-radio-group")).registerSome([{type:"text-local",module:en.w1},{type:"text-custom",module:en.x0}]),a),es=e=>{var{formatType:t,value:o,onChange:r}=e,i=(0,s.useMemo)(()=>{if(t===ee.a5.Text)return el},[t]);return i?(0,l.jsx)(ea.O,{value:o,onChange:e=>{null==r||r(e.target.value)},children:i.entries().map(e=>{var[t,{Component:o}]=e;return(0,l.jsx)(o,{},t)})}):null},ed=o("808656"),ec=o("886073"),eu=o("841552"),ep=o("646411");function em(e){var t,{visible:o,onClose:r,onSuccess:i,spaceId:a,botId:n}=e,d=(0,s.useRef)(null),[u,p]=(0,s.useState)({name:"",desc:""}),[f,g]=(0,s.useState)({uri:"",url:""}),[_,x]=(0,s.useState)(er.Cm.TEXT_DOC),w=(0,eo.EV)();var y=(t=(0,h._)(function*(){yield null===(e=d.current)||void 0===e?void 0:e.formApi.validate();var e,t,o,r,i,l,{dataset_id:s}=yield c.MJ.CreateDataset({name:null===(t=d.current)||void 0===t?void 0:t.formApi.getValue("name"),format_type:eu.a5.Text,description:null===(o=d.current)||void 0===o?void 0:o.formApi.getValue("description"),icon_uri:null!==(l=null===(i=d.current)||void 0===i?void 0:null===(r=i.formApi.getValue("icon_uri"))||void 0===r?void 0:r[0].uid)&&void 0!==l?l:null==f?void 0:f.uri,space_id:a,storage_location:ee.Ac.Douyin,project_id:n});return s}),function(){return t.apply(this,arguments)});return(0,et.Z)((0,h._)(function*(){var e,t,o,r,i,a,{icon:n}=yield c.MJ.GetIcon({format_type:eu.a5.Text});g(n);var l=null===(e=d.current)||void 0===e?void 0:e.formApi.getValue("icon_uri");(!l||(null===(t=l[0])||void 0===t?void 0:t.isDefault))&&(null===(o=d.current)||void 0===o||o.formApi.setValue("icon_uri",[{url:null!==(r=null==n?void 0:n.url)&&void 0!==r?r:"",uri:null!==(i=null==n?void 0:n.uri)&&void 0!==i?i:"",uid:null!==(a=null==n?void 0:n.uri)&&void 0!==a?a:"",isDefault:!0}]))})),(0,l.jsxs)(v.Modal,{visible:o,title:m.o.t("datasets_model_create_title"),onCancel:r,footer:(0,l.jsxs)("div",{className:"flex w-full justify-end",children:[(0,l.jsx)(v.Button,{color:"primary",onClick:r,children:m.o.t("cancel")}),(0,l.jsx)(v.LoadingButton,{color:"primary",onClick:(0,h._)(function*(){var e,t=yield y();i?i({datasetId:t||"",unitType:_,shouldUpload:!1}):null===(e=w.toResource)||void 0===e||e.call(w,"knowledge",t)}),children:m.o.t("kl_write_108")}),(0,l.jsx)(v.LoadingButton,{onClick:(0,h._)(function*(){var e,t=yield y();i?i({datasetId:t||"",unitType:_,shouldUpload:!0}):null===(e=w.upload)||void 0===e||e.call(w,{type:_,is_douyin:"true"})}),children:m.o.t("kl_write_109")})]}),children:[(0,l.jsx)("div",{"data-testid":ei.w.CreateKnowledgeModal,children:(0,l.jsx)("div",{className:P()("py-[8px] flex items-center justify-center","text-[14px] leading-[20px]","rounded-[8px] coz-mg-hglt-secondary"),children:m.o.t("dy_avatar_create_knowledge_limit")})}),(0,l.jsxs)(v.Form,{ref:d,showValidateIcon:!1,onValueChange:e=>{var{name:t,description:o}=e;p({name:(null==t?void 0:t.trim())||"",desc:(null==o?void 0:o.trim())||""})},children:[(0,l.jsx)(Y.NB,{"data-testid":ei.w.CreateKnowledgeModalNameInput,field:"name",label:m.o.t("datasets_model_create_name"),maxLength:100,rules:[{required:!0,whitespace:!0,message:m.o.t("dataset-name-empty-tooltip")},{pattern:/^[^"'`\\]+$/,message:m.o.t("dataset-name-has-wrong-word-tooltip")}],placeholder:m.o.t("datasets_model_create_name_placeholder")}),(0,l.jsx)(Y.eI,{field:"description","data-testid":ei.w.CreateKnowledgeModalDescInput,label:m.o.t("datasets_model_create_description"),autosize:{minRows:1,maxRows:2},maxCount:2e3,maxLength:2e3,placeholder:m.o.t("datasets_model_create_description_placeholder")}),(0,l.jsxs)("div",{className:"semi-form-field","x-label-pos":"top","x-field-id":"name","x-extra-pos":"bottom",children:[(0,l.jsx)("label",{className:"semi-form-field-label semi-form-field-label-left",children:(0,l.jsx)("div",{className:"semi-form-field-label-text","x-semi-prop":"label",children:m.o.t("create-dataset-import-type")})}),(0,l.jsx)(es,{formatType:eu.a5.Text,value:_,onChange:x})]}),(0,l.jsx)(ec.s,{label:m.o.t("datasets_model_create_avatar"),field:"icon_uri",fileBizType:ep.ym.BIZ_DATASET_ICON,withAutoGenerate:!0,renderAutoGenerate:e=>{var{showAiAvatar:t,setShowAiAvatar:o,onChange:r,generateTooltip:i,maxCandidateCount:a}=e;return(0,l.jsx)(ed.h,{generateInfo:u,showAiAvatar:t,onChange:e=>{o(!0),e&&(null==r||r(e))},maxCandidateCount:a,generateTooltip:i})},iconType:ep.Tu.Dataset,generateInfo:u,generateTooltip:{generateBtnText:m.o.t("dataset_create_knowledge_generate_avatar_tips"),contentNotLegalText:m.o.t("dataset_create_knowledge_generate_content_tips")},initValue:[{url:null==f?void 0:f.url,uri:null==f?void 0:f.uri,isDefault:!0}]})]})]})}var ef=o("866466"),ev=o.n(ef),eg=o("462669"),eh=o.n(eg),e_=o("318249"),ex=o.n(e_),ew=o("294754"),ey=o.n(ew),eb=o("13355"),ek=o.n(eb),ej=o("876846"),eC=o.n(ej),eS=o("796589"),eI={};eI.styleTagTransform=eC(),eI.setAttributes=ey(),eI.insert=ex().bind(null,"head"),eI.domAPI=eh(),eI.insertStyleElement=ek(),ev()(eS.Z,eI);var eT=eS.Z&&eS.Z.locals?eS.Z.locals:void 0;function eE(e){var t,o,{visible:r,onCancel:i,botId:a,spaceId:n,datasetList:d,onDatasetListChange:u,onClickKnowledgeDetail:p,onCreateSuccess:g}=e,_=(0,V.useNavigate)(),x=(0,s.useRef)(null),y=(0,K.Z)(),[b,k]=(0,s.useState)(),[j,C]=(0,s.useState)(!1);var{loading:S,data:I,reload:T}=(0,w.Z)((t=(0,h._)(function*(e){(!e||1===e.nextPageIndex)&&(null===(t=x.current)||void 0===t||t.scroll(0,0));var t,o,r,i=yield c.MJ.ListDataset({space_id:n,page:null!==(o=null==e?void 0:e.nextPageIndex)&&void 0!==o?o:1,size:20,filter:{name:b,scope_type:$.zf.ScopeAll,format_type:ee.a5.Text},order_field:ee.X$.UpdateTime,project_id:a,storage_location:ee.Ac.Douyin});return{list:(null==i?void 0:i.dataset_list)||[],nextPageIndex:(null!==(r=null==e?void 0:e.nextPageIndex)&&void 0!==r?r:1)+1,total:Number(null==i?void 0:i.total)}}),function(e){return t.apply(this,arguments)}),{isNoMore:e=>!!(!(null==e?void 0:e.total)||(e.nextPageIndex-1)*20>=e.total),onError:e=>{H.s5.errorEvent(H.xW.KNOWLEDGE,{eventName:q.b.KnowledgeGetDataSetList,error:e})},target:x,reloadDeps:[b,y]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.Modal,{width:752,height:612,visible:r,onCancel:i,header:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(v.Typography.Title,{className:"!text-[20px] !font-medium !leading-[28px]",children:m.o.t("dataset_set_title")}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(v.Input,{autoFocus:!0,prefix:(0,l.jsx)(f.SHo,{}),placeholder:m.o.t("db2_014"),onChange:(0,U.Z)(k,500)}),(0,l.jsx)(v.Button,{className:"ml-[12px] !min-w-[auto]",onClick:()=>C(!0),"data-testid":J.A.BotKnowledgeSelectListModalCreateBtn,children:m.o.t("datasets_create_btn")}),(0,l.jsx)(v.Button,{className:"ml-[8px] w-[40px] !p-[11px]",color:"secondary",icon:(0,l.jsx)(f.rmE,{className:"text-[18px]"}),onClick:i})]})]}),children:(0,l.jsx)(v.Spin,{spinning:S,wrapperClassName:"!h-full",childStyle:{height:"100%"},children:(0,l.jsxs)("div",{ref:x,className:"h-full flex flex-col gap-[16px] overflow-y-auto",children:[(0,l.jsx)("div",{className:P()("py-8px flex items-center justify-center","rounded-[8px] leading-[20px] coz-mg-hglt-secondary"),children:m.o.t("dy_avatar_add_knowledge_tip")}),(null==I?void 0:I.total)?(0,l.jsx)(G.d,{filter:{knowledgeType:Y.AT.ALL,scopeType:$.zf.ScopeAll,searchType:ee.X$.UpdateTime,query:b||""},onAdd:(o=(0,h._)(function*(e){yield u([...d,e]),(0,X.Gg)(X.Kg.click_database_select,{operation:"add",bot_id:a}),v.Toast.success({showClose:!1,content:m.o.t("bot_edit_dataset_added_toast",{dataset_name:e.name||""}),style:{wordWrap:"break-word"}})}),function(e){return o.apply(this,arguments)}),onRemove:e=>{u(d.filter(t=>t.dataset_id!==e.dataset_id)),(0,X.Gg)(X.Kg.click_database_select,{operation:"remove",bot_id:a}),v.Toast.success({showClose:!1,content:m.o.t("bot_edit_dataset_removed_toast",{dataset_name:e.name||""}),style:{wordWrap:"break-word"}})},isAdded:e=>d.some(t=>t.dataset_id===e),onClickKnowledgeDetail:p}):S?null:(0,l.jsx)(Q.YZ,{className:eT.empty,empty:{btnText:m.o.t("datasets_create_btn"),btnOnClick:()=>C(!0),title:m.o.t("datasets_empty_title"),description:m.o.t("datasets_empty_description")}})]})})}),(0,l.jsx)(em,{visible:j,onClose:()=>C(!1),onSuccess:e=>{var{datasetId:t,unitType:o,shouldUpload:r}=e;if(g)g({datasetId:t,unitType:o,shouldUpload:r});else if(r){_("/space/".concat(n,"/knowledge/").concat(t,"/upload?type=").concat(o,"&is_douyin=true"));return}T(),C(!1)},spaceId:n,botId:a})]})}var eN=o("14295"),eA=o("870429"),eP=o("722880"),eM=o("274889"),eR=()=>{var e,[t,o]=(0,s.useState)([]),{space_id:r}=(0,V.useParams)();var i=(e=(0,h._)(function*(){var e;o((null===(e=(yield c.yF.PublicGetTemplateWhiteListConfig()).data)||void 0===e?void 0:e.space_ids)||[])}),function(){return e.apply(this,arguments)}),[a,n]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{i()},[]),(0,s.useEffect)(()=>{n(!!(r&&t.includes(r)))},[r,t]),{enablePublishEntry:a}},ez=(0,s.lazy)((0,h._)(function*(){return{default:(yield Promise.all([o.e("20533"),o.e("55407")]).then(o.bind(o,153374))).JobSelectModal}})),eZ=e=>(0,l.jsx)(s.Suspense,{fallback:null,children:(0,l.jsx)(ez,(0,_._)({},e))})},64249:function(e,t,o){o.d(t,{BY:function(){return s},Vi:function(){return l},lV:function(){return d},w8:function(){return c}});var r,i,a,n,l=((r={})[r.Base64Data=1]="Base64Data",r[r.URL=2]="URL",r);var s=((i={})[i.BigModel=0]="BigModel",i[i.SmallModel=1]="SmallModel",i[i.SeedTTS20Model=2]="SeedTTS20Model",i[i.S2SOModel=3]="S2SOModel",i[i.S2SCModel=4]="S2SCModel",i);var d=((a={})[a.Init=0]="Init",a[a.Cloned=10]="Cloned",a[a.Deleted=20]="Deleted",a[a.Pending=30]="Pending",a);var c=((n={})[n.SystemVoice=1]="SystemVoice",n[n.UserVoice=2]="UserVoice",n)},179508:function(e,t,o){o.d(t,{K2:function(){return c},Lk:function(){return s},ai:function(){return d},b0:function(){return u},hY:function(){return p}});var r,i,a,n,l,s=((r={})[r.Rename=1]="Rename",r[r.Copy=2]="Copy",r[r.CopyToLibrary=3]="CopyToLibrary",r[r.MoveToLibrary=4]="MoveToLibrary",r[r.Delete=5]="Delete",r[r.Enable=6]="Enable",r[r.Disable=7]="Disable",r[r.SwitchToFuncflow=8]="SwitchToFuncflow",r[r.SwitchToChatflow=9]="SwitchToChatflow",r[r.UpdateDesc=10]="UpdateDesc",r);var d=((i={})[i.Workflow=1]="Workflow",i[i.Plugin=2]="Plugin",i[i.Data=3]="Data",i);var c=((a={})[a.CopyProjectResource=1]="CopyProjectResource",a[a.CopyResourceToLibrary=2]="CopyResourceToLibrary",a[a.MoveResourceToLibrary=3]="MoveResourceToLibrary",a[a.CopyResourceFromLibrary=4]="CopyResourceFromLibrary",a[a.CopyProject=5]="CopyProject",a[a.PublishProject=6]="PublishProject",a[a.CopyProjectTemplate=7]="CopyProjectTemplate",a[a.PublishProjectTemplate=8]="PublishProjectTemplate",a[a.LaunchTemplate=9]="LaunchTemplate",a[a.ArchiveProject=10]="ArchiveProject",a[a.RollbackProject=11]="RollbackProject",a[a.CrossSpaceCopy=12]="CrossSpaceCopy",a[a.CrossSpaceCopyProject=13]="CrossSpaceCopyProject",a[a.Export=14]="Export",a[a.Import=15]="Import",a[a.CopyResource=17]="CopyResource",a);var u=((n={})[n.Plugin=1]="Plugin",n[n.Workflow=2]="Workflow",n[n.Imageflow=3]="Imageflow",n[n.Knowledge=4]="Knowledge",n[n.UI=5]="UI",n[n.Prompt=6]="Prompt",n[n.Database=7]="Database",n[n.Variable=8]="Variable",n[n.Voice=9]="Voice",n[n.Memorybase=10]="Memorybase",n[n.MCP=11]="MCP",n);var p=((l={})[l.Successed=1]="Successed",l[l.Processing=2]="Processing",l[l.Failed=3]="Failed",l[l.Canceled=4]="Canceled",l)},667485:function(e,t,o){o.r(t),o.d(t,{ActionKey:function(){return m},CopyStatus:function(){return f},ExportVersion:function(){return v},ProjectResourceActionKey:function(){return g},ProjectResourceGroupType:function(){return h},PublishStatus:function(){return _},ResType:function(){return w},ResourceCopyScene:function(){return x},SyncOperation:function(){return y},TaskStatus:function(){return b}});var r,i,a,n,l,s,d,c,u,p,m=((r={})[r.Copy=1]="Copy",r[r.Delete=2]="Delete",r[r.EnableSwitch=3]="EnableSwitch",r[r.Edit=4]="Edit",r[r.SwitchToFuncflow=8]="SwitchToFuncflow",r[r.SwitchToChatflow=9]="SwitchToChatflow",r[r.CrossSpaceCopy=10]="CrossSpaceCopy",r[r.Export=11]="Export",r);var f=((i={})[i.Successful=1]="Successful",i[i.Processing=2]="Processing",i[i.Failed=3]="Failed",i[i.KeepOrigin=4]="KeepOrigin",i[i.Deleted=5]="Deleted",i);var v=((a={})[a.V1=0]="V1",a[a.V2=1]="V2",a);var g=((n={})[n.Rename=1]="Rename",n[n.Copy=2]="Copy",n[n.CopyToLibrary=3]="CopyToLibrary",n[n.MoveToLibrary=4]="MoveToLibrary",n[n.Delete=5]="Delete",n[n.Enable=6]="Enable",n[n.Disable=7]="Disable",n[n.SwitchToFuncflow=8]="SwitchToFuncflow",n[n.SwitchToChatflow=9]="SwitchToChatflow",n[n.UpdateDesc=10]="UpdateDesc",n);var h=((l={})[l.Workflow=1]="Workflow",l[l.Plugin=2]="Plugin",l[l.Data=3]="Data",l);var _=((s={})[s.UnPublished=1]="UnPublished",s[s.Published=2]="Published",s);var x=((d={})[d.CopyProjectResource=1]="CopyProjectResource",d[d.CopyResourceToLibrary=2]="CopyResourceToLibrary",d[d.MoveResourceToLibrary=3]="MoveResourceToLibrary",d[d.CopyResourceFromLibrary=4]="CopyResourceFromLibrary",d[d.CopyProject=5]="CopyProject",d[d.PublishProject=6]="PublishProject",d[d.CopyProjectTemplate=7]="CopyProjectTemplate",d[d.PublishProjectTemplate=8]="PublishProjectTemplate",d[d.LaunchTemplate=9]="LaunchTemplate",d[d.ArchiveProject=10]="ArchiveProject",d[d.RollbackProject=11]="RollbackProject",d[d.CrossSpaceCopy=12]="CrossSpaceCopy",d[d.CrossSpaceCopyProject=13]="CrossSpaceCopyProject",d[d.Export=14]="Export",d[d.Import=15]="Import",d[d.CopyResource=17]="CopyResource",d);var w=((c={})[c.Plugin=1]="Plugin",c[c.Workflow=2]="Workflow",c[c.Imageflow=3]="Imageflow",c[c.Knowledge=4]="Knowledge",c[c.UI=5]="UI",c[c.Prompt=6]="Prompt",c[c.Database=7]="Database",c[c.Variable=8]="Variable",c[c.Voice=9]="Voice",c[c.Memorybase=10]="Memorybase",c[c.MCP=11]="MCP",c);var y=((u={})[u.Upsert=1]="Upsert",u[u.Delete=2]="Delete",u);var b=((p={})[p.Successed=1]="Successed",p[p.Processing=2]="Processing",p[p.Failed=3]="Failed",p[p.Canceled=4]="Canceled",p)},522093:function(e,t,o){o.d(t,{x:()=>s,I:()=>l});var r=o("723530"),i=o("765796"),a=o.n(i),n=o("498842");function l(e){var{onRecordingComplete:t,onRecordAnalyseDataChange:o}=e,[i,l]=(0,r.useState)(!1),[s,d]=(0,r.useState)(0),c=(0,r.useRef)(t);c.current=t;var u=(0,r.useRef)(o);u.current=o;var p=(0,r.useRef)(null),m=(0,r.useCallback)(()=>{try{var e=new(a());return e.onprocess=e=>{var t=Math.floor(e);d(t)},e.onprogress=()=>{var t,o=e.getRecordAnalyseData();null===(t=u.current)||void 0===t||t.call(u,o)},p.current=e,l(!0),e.start()}catch(e){throw l(!1),n.E7.errorEvent({eventName:"record_audio_error",error:e}),n.kg.error({error:e}),e}},[]);return{isRecording:i,recordingTime:s,startRecording:m,stopRecording:(0,r.useCallback)(()=>{var e=p.current;if(e){var t,o=e.getWAVBlob();null===(t=c.current)||void 0===t||t.call(c,o),e.stop(),setTimeout(()=>{e.destroy()},0),l(!1)}},[])}}var s=function(e){var{autoPlay:t,loop:o,onEnded:i,onLoad:a,initialVolume:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[l,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!0),[m,f]=(0,r.useState)(0),[v,g]=(0,r.useState)(0),[h,_]=(0,r.useState)(!1),[x,w]=(0,r.useState)(n),[y,b]=(0,r.useState)(1),k=(0,r.useRef)(null),j=(0,r.useRef)(null),C=(0,r.useCallback)(e=>{var t=k.current;t&&(t.handlers&&(t.removeEventListener("loadedmetadata",t.handlers.handleLoadedMetadata),t.removeEventListener("timeupdate",t.handlers.handleTimeUpdate),t.removeEventListener("ended",t.handlers.handleEnded)),t.pause(),t.src="");var r=e instanceof Blob?URL.createObjectURL(e):e,n=new Audio(r);n.loop=null!=o&&o;var l=()=>f(n.currentTime),d=()=>{g(n.duration),f(0),_(!1),null==a||a(),n.volume=x,e instanceof Blob&&(j.current=r)},c=()=>{s(!1),p(!0),f(n.duration),null==i||i()};return n.handlers={handleTimeUpdate:l,handleLoadedMetadata:d,handleEnded:c},n.addEventListener("timeupdate",l),n.addEventListener("loadedmetadata",d),n.addEventListener("ended",c),k.current=n,n},[o,i,a]);(0,r.useEffect)(()=>{if(!e){_(!1);return}_(!0);var o=C(e);return t&&o.play().then(()=>{s(!0),c(!1),p(!1)}).catch(e=>{console.error("Auto play failed:",e)}),()=>{if(k.current){var{handlers:e}=k.current;e&&(k.current.removeEventListener("loadedmetadata",e.handleLoadedMetadata),k.current.removeEventListener("timeupdate",e.handleTimeUpdate),k.current.removeEventListener("ended",e.handleEnded)),k.current.pause(),k.current.src="",k.current=null}j.current&&(URL.revokeObjectURL(j.current),j.current=null)}},[e,t,C]);var S=(0,r.useCallback)(e=>{e?(_(!0),C(e).play().then(()=>{s(!0),c(!1),p(!1)}).catch(e=>{console.error("Play failed:",e)})):k.current&&k.current.play().then(()=>{s(!0),c(!1),p(!1)}).catch(e=>{console.error("Play failed:",e)})},[C]),I=(0,r.useCallback)(()=>{k.current&&(k.current.pause(),s(!1),c(!0))},[]),T=(0,r.useCallback)(()=>{k.current&&(k.current.pause(),k.current.currentTime=0,s(!1),c(!1),p(!0))},[]),E=(0,r.useCallback)(()=>{l?I():S()},[l,S,I]),N=(0,r.useCallback)(e=>{k.current&&(k.current.currentTime=e,f(e))},[]),A=(0,r.useCallback)(e=>{k.current&&(k.current.volume=e,w(e))},[]);return{isPlaying:l,isPaused:d,isStopped:u,currentTime:m,duration:v,isLoading:h,play:S,pause:I,stop:T,togglePlayPause:E,seek:N,volume:x,changeVolume:A,playbackRate:y,changePlaybackRate:(0,r.useCallback)(e=>{k.current&&(k.current.playbackRate=e,b(e))},[])}}},905573:function(e,t,o){o.d(t,{l:function(){return r}});var r=(0,o(723530).createContext)({controller:{hideActionBar:()=>{},rePosition:()=>{}},size:"small"})},460170:function(e,t,o){o.d(t,{Y:function(){return a}});var r=o(723530),i=o(905573),a=()=>{var{size:e,controller:t}=(0,r.useContext)(i.l);return{size:e,controller:t}}},846955:function(e,t,o){o.d(t,{YE:()=>v.Y,ol:()=>f});var r=o("938809"),i=o("723530"),a=o("856306"),n=o.n(a),l=o("75591"),s=o("571375"),d=o("182956"),c=o("740471"),u=o("548649"),p=o("404590"),m=o("905573"),f=e=>{var{className:t,size:o="small",children:a,visible:f,onVisibleChange:v,trigger:g="selection"}=e,[h,_]=(0,i.useState)(!1),[x,w]=(0,i.useState)(""),[y,b]=(0,i.useState)(-1),k=(0,i.useRef)(null),j=(0,p.j)(),[C,S]=(0,i.useState)({from:0,to:0,anchor:0,head:0}),I=(0,l.jE)(),T=(0,l.G6)(),[E,N]=(0,i.useState)();return((0,i.useEffect)(()=>{N((null==C?void 0:C.head)>(null==C?void 0:C.anchor)?"bottomRight":"topLeft")},[C]),(0,i.useLayoutEffect)(()=>T.inject([(0,c.Uw)()]),[T]),(0,i.useEffect)(()=>{if(!!I)return I.$on("mousedown",e),document.addEventListener("mouseup",t),I.$on("selectionChange",o),()=>{I.$off("mousedown",e),document.removeEventListener("mouseup",t),I.$off("selectionChange",o)};function e(){null==v||v(!1),_(!1),b(-1)}function t(e){if(null===(t=k.current)||void 0===t?!void 0:!t.contains(e.target)){var t,o=I.getSelection();if(S(o),!o){null==v||v(!1),b(-1),_(!1);return}var r=o.from!==o.to;S(o),null==v||v(r),_(r),b(o.head)}}function o(){null==v||v(!1),b(-1),_(!1)}},[I]),j)?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Popover,{rePosKey:x,visible:"custom"===g?f:h,trigger:"custom",position:E,autoAdjustOverflow:!0,className:"rounded",content:(0,r.jsx)(m.l.Provider,{value:{controller:{hideActionBar:()=>{null==v||v(!1),_(!1)},rePosition:e=>{w(String(Math.random())),e&&N(e)}},size:o},children:(0,r.jsx)("div",{className:n()("flex gap-1",t),ref:k,children:a})}),children:(0,r.jsx)(s.Iq,{position:y,onChange:()=>w(String(Math.random()))})}),(0,r.jsx)(u.G,{themes:[c.tk.theme({".cm-selectionBackground":{backgroundColor:"rgba(148, 152, 247, 0.44)"}})]})]})},v=o("460170")},404590:function(e,t,o){o.d(t,{j:function(){return a}});var r=o(723530),i=o(75591),a=()=>{var e=(0,i.jE)(),[t,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!!e){o(e.$view.state.readOnly);var t=e=>{e.startState.readOnly!==e.state.readOnly&&o(e.state.readOnly)};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t}},548649:function(e,t,o){o.d(t,{G:()=>a});var r=o("723530"),i=o("75591"),a=e=>{var{themes:t}=e,o=(0,i.G6)();return(0,r.useLayoutEffect)(()=>o.inject(t),[o,t]),null}},327810:function(e,t,o){o.d(t,{j:function(){return a}});var r=o(723530),i=o(75591),a=()=>{var e=(0,i.jE)(),[t,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!!e){o(e.$view.state.readOnly);var t=e=>{e.startState.readOnly!==e.state.readOnly&&o(e.state.readOnly)};return e.$on("viewUpdate",t),()=>{e.$off("viewUpdate",t)}}},[e]),t}},846321:function(e,t,o){o.d(t,{j8:()=>c.j,gV:()=>d,fY:()=>p,gG:()=>s,qI:()=>l});var r,i=o("888953"),a=o("922321"),n=o("468745"),l=()=>(0,a.Ue)()((0,i.mW)((e,t)=>({modalHierarchyList:[],getModalIndex:e=>t().modalHierarchyList.findIndex(t=>t===e),registerModal:o=>{e({modalHierarchyList:(0,n.Uy)(t().modalHierarchyList,e=>{e.unshift(o)})},!1,"registerModal")},removeModal:o=>{e({modalHierarchyList:(0,n.Uy)(t().modalHierarchyList,e=>{var r=t().getModalIndex(o);if(!(r<0))e.splice(r,1)})},!1,"removeModal")},setModalToTopLayer:o=>{e({modalHierarchyList:(0,n.Uy)(t().modalHierarchyList,e=>{if(!(0>t().getModalIndex(o)))t().removeModal(o),t().registerModal(o)})},!1,"setModalToTopLayer")}}),{enabled:!1,name:"botStudio.botEditor.ModalHierarchy"}));class s{constructor({registerModal:e,removeModal:t,getModalIndex:o,setModalToTopLayer:r}){this.baseZIndex=1e3,this.getModalZIndex=e=>"string"==typeof e?this.getModalIndex(e)+this.baseZIndex:e+this.baseZIndex,this.registerModal=e,this.removeModal=t,this.getModalIndex=o,this.onFocus=r}}var d=e=>{var t=e.getMainSelectionRects();if(0===t.length)return{left:0,top:0,width:0,height:0};var o=1/0,r=1/0,i=-1/0,a=-1/0;t.forEach(e=>{var t,n;o=Math.min(o,e.left),r=Math.min(r,e.top),i=Math.max(i,e.left+(null!==(t=e.width)&&void 0!==t?t:0)),a=Math.max(a,e.top+(null!==(n=e.height)&&void 0!==n?n:0))});var n=i-o,l=a-r,{scrollLeft:s}=e.$view.scrollDOM,{scrollTop:d}=e.$view.scrollDOM,c=e.$view.dom.getBoundingClientRect();return{left:c.left+o-s,top:c.top+r-d,bottom:c.top+a-d,width:n,height:l}},c=o("327810"),u=o("255721");var p=(r=(0,u._)(function*(e){var t,o,{editor:r,prompt:i,insertType:a="nextLine"}=e;if(!r)return"";var{state:n}=r.$view,l=0===n.doc.length,s=i,d=void 0,c={nextLine:n.doc.length,cover:0,anchor:null===(o=n.selection.ranges)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:t.to}[a];!l&&(d={anchor:c,head:c+(s="nextLine"!==a?i:"\n".concat(i)).length}),r.$view.dispatch({changes:{from:c,to:"cover"===a?n.doc.length:c,insert:s},selection:d,scrollIntoView:!0}),yield Promise.resolve();var u=r.$view.state.doc.toString();return r.focus(),u}),function(e){return r.apply(this,arguments)})},765946:function(e,t,o){o.d(t,{CJ:()=>Y,v6:()=>N,vL:()=>P,ir:()=>D,c$:()=>B});var r,i=o("938809"),a=o("723530"),n=o("856306"),l=o.n(n),s=o("16242"),d=o("988726"),c=o("168074");function u(){return(0,i.jsxs)("svg",{width:"48",height:"38",viewBox:"0 0 48 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("rect",{x:"1.83317",y:"1.49998",width:"44.3333",height:"35",rx:"3.5",stroke:"currentColor","stroke-opacity":"0.8","stroke-width":"2.33333"}),(0,i.jsx)("path",{d:"M14.6665 30.6667H33.3332",stroke:"currentColor","stroke-opacity":"0.8","stroke-width":"2.33333","stroke-linecap":"round"})]})}function p(){return(0,i.jsx)("svg",{width:"34",height:"52",viewBox:"0 0 34 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M30.9998 16.6666V35.3333C30.9998 37.5748 30.9948 38.4695 30.9 39.1895C30.2108 44.4247 26.0912 48.5443 20.856 49.2335C20.1361 49.3283 19.2413 49.3333 16.9998 49.3333C14.7584 49.3333 13.8636 49.3283 13.1437 49.2335C7.90847 48.5443 3.78888 44.4247 3.09965 39.1895C3.00487 38.4695 2.99984 37.5748 2.99984 35.3333V16.6666C2.99984 14.4252 3.00487 13.5304 3.09965 12.8105C3.78888 7.57528 7.90847 3.45569 13.1437 2.76646C13.7232 2.69017 14.4159 2.67202 15.8332 2.66785V9.86573C14.4738 10.3462 13.4998 11.6426 13.4998 13.1666V17.8332C13.4998 19.3571 14.4738 20.6536 15.8332 21.1341V23.6666C15.8332 24.3109 16.3555 24.8333 16.9998 24.8333C17.6442 24.8333 18.1665 24.3109 18.1665 23.6666V21.1341C19.5259 20.6536 20.4998 19.3572 20.4998 17.8332V13.1666C20.4998 11.6426 19.5259 10.3462 18.1665 9.86571V2.66785C19.5837 2.67202 20.2765 2.69017 20.856 2.76646C26.0912 3.45569 30.2108 7.57528 30.9 12.8105C30.9948 13.5304 30.9998 14.4252 30.9998 16.6666ZM0.666504 16.6666C0.666504 14.4993 0.666504 13.4157 0.786276 12.5059C1.61335 6.22368 6.55687 1.28016 12.8391 0.453085C13.7489 0.333313 14.8325 0.333313 16.9998 0.333313C19.1671 0.333313 20.2508 0.333313 21.1605 0.453085C27.4428 1.28016 32.3863 6.22368 33.2134 12.5059C33.3332 13.4157 33.3332 14.4994 33.3332 16.6666V35.3333C33.3332 37.5006 33.3332 38.5843 33.2134 39.494C32.3863 45.7763 27.4428 50.7198 21.1605 51.5469C20.2508 51.6666 19.1671 51.6666 16.9998 51.6666C14.8325 51.6666 13.7489 51.6666 12.8391 51.5469C6.55687 50.7198 1.61335 45.7763 0.786276 39.494C0.666504 38.5843 0.666504 37.5006 0.666504 35.3333V16.6666ZM15.8332 13.1666C15.8332 13.0011 15.8676 12.8437 15.9297 12.7011C15.9886 12.566 16.0722 12.4443 16.1749 12.3416C16.386 12.1305 16.6777 11.9999 16.9998 11.9999C17.6435 11.9999 18.1654 12.5212 18.1665 13.1646L18.1665 13.1666V17.8332L18.1665 17.8353C18.1665 17.8364 18.1665 17.8376 18.1665 17.8387C18.1661 17.9132 18.1588 17.986 18.1452 18.0565C18.0853 18.3656 17.9033 18.6312 17.6515 18.8011C17.4655 18.9266 17.2412 18.9999 16.9998 18.9999C16.3555 18.9999 15.8332 18.4776 15.8332 17.8332V13.1666Z",fill:"currentColor","fill-opacity":"0.8"})})}var m=o("866466"),f=o.n(m),v=o("462669"),g=o.n(v),h=o("318249"),_=o.n(h),x=o("294754"),w=o.n(x),y=o("13355"),b=o.n(y),k=o("876846"),j=o.n(k),C=o("574940"),S={};S.styleTagTransform=j(),S.setAttributes=w(),S.insert=_().bind(null,"head"),S.domAPI=g(),S.insertStyleElement=b(),f()(C.Z,S);var I=C.Z&&C.Z.locals?C.Z.locals:void 0,{Title:T,Paragraph:E}=c.ZT;var N=((r={}).Mouse="MOUSE",r.Pad="PAD",r),A=e=>{var{title:t,subTitle:o,icon:r,onChange:a,value:n,selected:s}=e;return(0,i.jsxs)("div",{className:l()({[I["mouse-pad-option"]]:!0,[I["mouse-pad-option-selected"]]:s}),onClick:()=>a(n),children:[(0,i.jsx)("div",{className:l()({[I["mouse-pad-option-icon"]]:!0,[I["mouse-pad-option-icon-selected"]]:s}),children:r}),(0,i.jsx)(T,{heading:6,className:l()({[I["mouse-pad-option-title"]]:!0,[I["mouse-pad-option-title-selected"]]:s}),children:t}),(0,i.jsx)(E,{type:"tertiary",className:l()({[I["mouse-pad-option-subTitle"]]:!0,[I["mouse-pad-option-subTitle-selected"]]:s}),children:o})]})},P=a.forwardRef((e,t)=>{var{value:o,onChange:r,onPopupVisibleChange:n,containerStyle:m,iconStyle:f,arrowStyle:v}=e,[g,h]=(0,a.useState)(!1);return(0,i.jsx)(c.J2,{trigger:"custom",position:"topLeft",closeOnEsc:!0,visible:g,onVisibleChange:e=>{null==n||n(e)},onClickOutSide:()=>{h(!1)},spacing:20,content:(0,i.jsxs)("div",{className:I["ui-mouse-pad-selector-popover"],children:[(0,i.jsx)(c.ZT.Title,{heading:4,children:s.o.t("workflow_interactive_mode")}),(0,i.jsxs)("div",{className:I["ui-mouse-pad-selector-popover-options"],children:[(0,i.jsx)(A,{title:s.o.t("workflow_mouse_friendly"),subTitle:s.o.t("workflow_mouse_friendly_desc"),"data-testid":"workflow.detail.toolbar.interactive.mouse",value:"MOUSE",selected:"MOUSE"===o,icon:(0,i.jsx)(p,{}),onChange:r}),(0,i.jsx)(A,{title:s.o.t("workflow_pad_friendly"),subTitle:s.o.t("workflow_pad_friendly_desc"),"data-testid":"workflow.detail.toolbar.interactive.pad",value:"PAD",selected:"PAD"===o,icon:(0,i.jsx)(u,{}),onChange:r})]})]}),children:(0,i.jsxs)("div",{className:l()({[I["ui-mouse-pad-selector"]]:!0,[I["ui-mouse-pad-selector-active"]]:g}),ref:t,onClick:()=>{h(!g)},style:m,children:[(0,i.jsx)("div",{className:I["ui-mouse-pad-selector-icon"],style:f,children:"MOUSE"===o?(0,i.jsx)(d.V3N,{}):(0,i.jsx)(d.XiX,{})}),(0,i.jsx)("div",{className:I["ui-mouse-pad-selector-arrow"],style:v,children:(0,i.jsx)(d.Wdl,{})})]})})}),M=o("341333"),R=o("265489"),z="workflow_prefer_interactive_type",Z="show_workflow_interactive_type_guide",L=/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),B=()=>{var e=localStorage.getItem(z);return e&&[N.Mouse,N.Pad].includes(e)?e:L?N.Pad:N.Mouse},D=e=>{localStorage.setItem(z,e)},O=()=>{localStorage.setItem(Z,"true")},F=()=>"true"!==localStorage.getItem(Z),W=o("546623"),V={};V.styleTagTransform=j(),V.setAttributes=w(),V.insert=_().bind(null,"head"),V.domAPI=g(),V.insertStyleElement=b(),f()(W.Z,V);var U=W.Z&&W.Z.locals?W.Z.locals:void 0,K=e=>(0,i.jsxs)("div",{className:U["guiding-content"],children:[(0,i.jsx)("div",{className:U["guiding-content-title"],children:(0,i.jsx)(c.ZT.Text,{children:e.mainTitle})}),(0,i.jsxs)("div",{className:U["guiding-content-mouse-option"],children:[(0,i.jsx)("div",{className:U["guiding-content-mouse-option-icon"],children:(0,i.jsx)(p,{})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.ZT.Text,{className:U["guiding-content-title"],children:e.mouseOptionTitle}),(0,i.jsx)(c.ZT.Paragraph,{className:U["guiding-content-desc"],children:e.mouseOptionDesc})]})]}),(0,i.jsxs)("div",{className:U["guiding-content-pad-option"],children:[(0,i.jsx)("div",{className:U["guiding-content-pad-option-icon"],children:(0,i.jsx)(u,{})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.ZT.Text,{className:U["guiding-content-title"],children:e.padOptionTitle}),(0,i.jsx)(c.ZT.Paragraph,{className:U["guiding-content-desc"],children:e.padOptionDesc})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(c.zx,{type:"primary",theme:"solid",className:U["guiding-content-button"],onClick:null==e?void 0:e.onGotIt,children:e.buttonText})})]}),Y=e=>{var{children:t,mainTitle:o=s.o.t("workflow_interactive_mode_popover_title"),buttonText:r=s.o.t("guidance_got_it"),mouseOptionTitle:n=s.o.t("workflow_interactive_mode_mouse_friendly"),mouseOptionDesc:l=s.o.t("workflow_interactive_mode_mouse_friendly_desc"),padOptionTitle:d=s.o.t("workflow_interactive_mode_pad_friendly"),padOptionDesc:u=s.o.t("workflow_interactive_mode_pad_friendly_desc")}=e,[p,m]=(0,a.useState)(()=>F());return(0,i.jsx)(c.J2,{content:(0,i.jsx)(K,(0,R._)((0,M._)({},{mainTitle:o,mouseOptionTitle:n,mouseOptionDesc:l,padOptionTitle:d,padOptionDesc:u,buttonText:r}),{onGotIt:()=>{O(),m(!1)}})),trigger:"custom",position:"top",style:{padding:0},visible:p,showArrow:!0,onClickOutSide:()=>m(!1),children:t})}},1179:function(e,t,o){o.d(t,{ju:()=>tU,_N:()=>tt,rE:()=>ti,b0:()=>ed,HY:()=>e9,ut:()=>v,kb:()=>e5});var r,i,a,n,l,s,d,c,u,p=o("938809"),m=e=>{if(!e)return null;if(e<1024)return"".concat(e,"B");if(e<1048576)return"".concat((e/1024).toFixed(2),"KB");if(e<0x40000000)return"".concat((e/1048576).toFixed(2),"MB");else return"".concat((e/0x40000000).toFixed(2),"GB")},f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANgSURBVHgB7Zw9TBNRHMD/71qwiJqygVPVkDj6sRgNpsZFEgcHPyYiDK4ySZDFGqMxsGAcNUHjBouL0UEixOiGLm5ivDgIcdBCK/2+572S6wfh3Wuv/fveXd8vueaaf5Pmfv3/32fvCAiIJ2jUyqfHKaVxAjRGgcRAJgSS9uvLU4PdD2bGIl8BGeIWjE9mYhYpvKMAMVCM00fDQA2SmB7puQuIGG5BVeU4EIsmJl5k7gAiXEFDU5ujKstxwJbEzyAK18EnYEriCiI+yJ5asCRxBfmhvHaCIcmAgNFuSYETxGinpEAKYrRLUmAFMdohKdCCGK1KCrwgRiuSOkIQw6sk3wrKFSg0ixdJPhYEnmhWkm8FbWw1n0EOzUjyraC1P5anMnNoVJJvBRVLAF9+4EvydS/G5Kx8K8HqWgk27ZLzIqtUtBIX76XivHgYAsCvDWofJfAMKa99Le0W6phxkCsULvFCWtA2UV5ACxKgBQnQggRoQQK0IAFakAD0geJAlAAW6SxAKut9qtEIqILGzu+xj27AZG4xbx85wAK1xLDlMK6c6QJMfN8G7YvglTBD+mT19acCrNtrOw6sLFVCuqA3KwX4/L06E1dNkO7mBWhBAqSX2P2RHkhnqmOZa9Ppyvmxw2G4fTkCMpEuiPVCtT3RWrIqq7+m8ZaFLjEB0jNo9WfJnjJUs2ZwwKhk1JGD8n8/6YIev8rVdfPzE73QH1UnsXWJCdCCBEgvsQsnu+zuPFR5v/AhX2mD+vsMGD6BOxkVIV3QTgFnp1KV8+OHQtIF6RIToAUJUG5vfv5WL6iEcoJYw6wS0gWNP9mqGyjWwhrpRzf2gkyUyaDaKQaDJ+1/o4wgtuzhTDHYEuzVmb+gAsoIWv9tle/BKp8rsMzhoIygm08zoCJ6HCRAegaxXYzh5O4lhb3n1QiogthCmOgityeqIVAV1BKbe4u3Z175jkXc70DNoIWPBXvntAj7kTYmUlmoW67FAL0NYhfA/qbiV3QvJkALEqAFCdCCBGhBAtwebmJC52DyAm4PNzGhczB5AX4GEboMnQKF57wQV5DRbc0SoCYEHmq+f3jgGS/KFbSU6Esa1DoXbEnUDNnX6PaJhtYThiY3R9lti0o8JrBF2A9uX4NJKV0OR6xZlghun/8HaZo87qi9f/oAAAAASUVORK5CYII=",v=e=>{var{file:t}=e;return(0,p.jsxs)("div",{className:"flex coz-mg-primary py-2 px-2.5 gap-[10px] rounded-[8px]",children:[(0,p.jsx)("img",{src:f,width:36,height:36}),(0,p.jsxs)("div",{className:"flex-col gap-[2px]",children:[(0,p.jsx)("div",{className:"coz-fg-primary leading-5",children:(null==t?void 0:t.name)||""}),(null==t?void 0:t.size)?(0,p.jsx)("div",{className:"coz-fg-secondary leading-4 text-xs",children:m(null==t?void 0:t.size)}):null]})]})},g=o("341333"),h=o("723530"),_=o("16242"),x=o("988726"),w=o("182956"),y=o("255721"),b=o("856306"),k=o.n(b),j=o("306769"),C=o("498842"),S=o("479727"),I=o("563575"),T=o("618016"),E=o("449001"),N=(0,j.kP)("0123456789abcdefghijklmnopqrstuvwxyz",12),A=e=>{var t;return{upload:(t=(0,y._)(function*(t){try{var o=yield(0,S.fr)({biz:"",fileType:"object",file:t,getUploadAuthToken:(0,y._)(function*(){return yield E.sD.GetUploadAuthToken({scene:"import"})}),addFileOption:(0,I.L)()["bot.automation.import_store_key"]?{storeKey:"space_".concat(e,"_").concat(N())}:void 0});if(!o)throw new T.sH("normal_error","no uri");return o}catch(e){C.kg.error({eventName:"upload_error",error:e}),w.Toast.error(_.o.t("multimodal_upload_file"))}}),function(e){return t.apply(this,arguments)})}},P=o("853894"),M=()=>{var[e,t]=(0,h.useState)(!1),o=(0,h.useRef)(null);return(0,P.Z)(e=>{try{for(var o of e){var r,i,a,n;"attributes"===o.type&&"class"===o.attributeName&&(null===(i=o.target)||void 0===i?void 0:null===(r=i.className)||void 0===r?void 0:r.includes("semi-upload-drag-area"))&&t(null===(n=o.target)||void 0===n?void 0:null===(a=n.className)||void 0===a?void 0:a.includes("semi-upload-drag-area-legal"))}}catch(e){C.kg.error({message:"useFileDragging error",error:e})}},o,{attributes:!0,subtree:!0,attributeFilter:["class"]}),{ref:o,fileDragging:e}},R=["zip"].map(e=>".".concat(e)),z=(e,t)=>{if(!!e&&!!t){var o=document.createElement("a");o.href=e,o.download=t,o.click(),o.remove()}};var Z=(r=(0,y._)(function*(e,t){if(!!e&&!!t)try{var o=yield fetch(e);if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));var r=yield o.blob(),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=t,a.click(),window.URL.revokeObjectURL(i),a.remove()}catch(e){C.kg.error({eventName:"workflow_import_download_error",error:e})}}),function(e,t){return r.apply(this,arguments)}),L=o("866466"),B=o.n(L),D=o("462669"),O=o.n(D),F=o("318249"),W=o.n(F),V=o("294754"),U=o.n(V),K=o("13355"),Y=o.n(K),H=o("876846"),G=o.n(H),J=o("936421"),q={};q.styleTagTransform=G(),q.setAttributes=U(),q.insert=W().bind(null,"head"),q.domAPI=O(),q.insertStyleElement=Y(),B()(J.Z,q);var X=J.Z&&J.Z.locals?J.Z.locals:void 0,Q=e=>{var{errorCount:t,checkFileUrl:o}=e;return(0,p.jsx)("div",{className:k()(X.container,"overflow-hidden w-full h-[320px] flex justify-center items-center"),children:(0,p.jsxs)("div",{className:"flex flex-col items-center py-12",children:[(0,p.jsx)(x.U6C,{className:k()(X["warning-icon"],"text-[32px] coz-fg-hglt-red mb-3")}),(0,p.jsx)(x.Isu,{className:k()(X["upload-icon"],"text-[32px] coz-fg-hglt mb-3")}),(0,p.jsx)("div",{className:"coz-fg-primary mb-1.5 text-center font-medium leading-5",children:_.o.t("export_import_2_agent_flow_18")}),(0,p.jsxs)("div",{className:"text-center mb-4 coz-fg-dim leading-4 text-xs",children:[t?_.o.t("export_import_2_agent_flow_19",{num:t}):null,(0,p.jsx)("div",{children:_.o.t("export_import_2_agent_flow_20")})]}),(0,p.jsx)(w.Button,{size:"small",color:"primary",onClick:e=>{if(e.stopPropagation(),!!o)Z(o,"".concat(_.o.t("export_import_2_agent_flow_11"),".txt"))},children:_.o.t("export_import_2_agent_flow_21")})]})})},$=o("171881"),ee={};ee.styleTagTransform=G(),ee.setAttributes=U(),ee.insert=W().bind(null,"head"),ee.domAPI=O(),ee.insertStyleElement=Y(),B()($.Z,ee);var et=$.Z&&$.Z.locals?$.Z.locals:void 0;function eo(e){var{fileDragging:t,loading:o,checkFailed:r}=e,i=r?(0,p.jsx)(Q,{errorCount:r.errorCount,checkFileUrl:r.checkFileUrl}):(0,p.jsxs)("div",{className:"flex flex-col items-center",children:[(0,p.jsx)(x.Isu,{className:k()("text-[32px] mb-1",o?"coz-fg-hglt-dim":"coz-fg-hglt")}),(0,p.jsxs)("div",{className:k()("leading-5",o?"coz-fg-dim":"coz-fg-primary"),children:[_.o.t("export_import_agent_flow_8"),(0,p.jsx)("span",{className:k()("ml-1.5 ",o?"coz-fg-hglt-dim":"coz-fg-hglt"),children:_.o.t("export_import_agent_flow_9")})]}),(0,p.jsx)("span",{className:k()("leading-4 text-xs",o?"coz-fg-dim":"coz-fg-secondary"),children:_.o.t("export_import_agent_flow_10")})]});return(0,p.jsxs)("div",{className:k()("w-full h-full relative"),children:[o?(0,p.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center coz-mg-card",children:[(0,p.jsx)(x.j2n,{className:"animate-spin w-6 h-6 coz-fg-secondary"}),(0,p.jsx)("div",{className:"coz-fg-primary font-medium leading-5 mt-3",children:_.o.t("export_import_2_agent_flow_14")})]}):null,(0,p.jsx)("div",{className:et["upload-content"],children:t?(0,p.jsx)("div",{children:_.o.t("export_import_agent_flow_11")}):i})]})}var er=o("78970"),ei={};ei.styleTagTransform=G(),ei.setAttributes=U(),ei.insert=W().bind(null,"head"),ei.domAPI=O(),ei.insertStyleElement=Y(),B()(er.Z,ei);var ea=er.Z&&er.Z.locals?er.Z.locals:void 0,en=e=>{var t,{spaceId:o,onSuccess:r,onError:i,disabled:a,onFileChange:n,beforeUpload:l,loading:s,checkFailed:d}=e,{upload:c}=A(o),{ref:u,fileDragging:m}=M();var f=(t=(0,y._)(function*(e){var t,o,{fileInstance:r}=e,i=yield c(r);i?null===(t=e.onSuccess)||void 0===t||t.call(e,i):null===(o=e.onError)||void 0===o||o.call(e,{status:0})}),function(e){return t.apply(this,arguments)});return(0,p.jsx)("div",{ref:u,children:(0,p.jsx)(w.Upload,{accept:R.join(","),action:"",beforeUpload:l,onSuccess:r,onError:i,disabled:a,className:k()(ea.upload,{[ea["upload-loading"]]:s}),draggable:!0,limit:1,maxSize:524288,customRequest:f,renderFileItem:()=>null,onFileChange:n,onSizeError:()=>w.Toast.error(_.o.t("export_import_agent_flow_7")),onAcceptInvalid:()=>w.Toast.error(_.o.t("export_import_agent_flow_6")),children:(0,p.jsx)(eo,{disabled:a,fileDragging:m,loading:s,checkFailed:d})})})};var el=((i={})[i.V1=0]="V1",i[i.V2=1]="V2",i);var es=((a={})[a.CopyProjectResource=1]="CopyProjectResource",a[a.CopyResourceToLibrary=2]="CopyResourceToLibrary",a[a.MoveResourceToLibrary=3]="MoveResourceToLibrary",a[a.CopyResourceFromLibrary=4]="CopyResourceFromLibrary",a[a.CopyProject=5]="CopyProject",a[a.PublishProject=6]="PublishProject",a[a.CopyProjectTemplate=7]="CopyProjectTemplate",a[a.PublishProjectTemplate=8]="PublishProjectTemplate",a[a.LaunchTemplate=9]="LaunchTemplate",a[a.ArchiveProject=10]="ArchiveProject",a[a.RollbackProject=11]="RollbackProject",a[a.CrossSpaceCopy=12]="CrossSpaceCopy",a[a.CrossSpaceCopyProject=13]="CrossSpaceCopyProject",a[a.Export=14]="Export",a[a.Import=15]="Import",a[a.CopyResource=17]="CopyResource",a);var ed=((n={})[n.Plugin=1]="Plugin",n[n.Workflow=2]="Workflow",n[n.Imageflow=3]="Imageflow",n[n.Knowledge=4]="Knowledge",n[n.UI=5]="UI",n[n.Prompt=6]="Prompt",n[n.Database=7]="Database",n[n.Variable=8]="Variable",n[n.Voice=9]="Voice",n[n.Memorybase=10]="Memorybase",n[n.MCP=11]="MCP",n),ec=e=>{var t,o,r=null===(t=e.value)||void 0===t?void 0:t.res_type;if(!r)return null;var i=null===(o=e.forms)||void 0===o?void 0:o[r];if(!i)return null;if(r===ed.Workflow)return(0,p.jsx)(i,(0,g._)({},e));return(0,p.jsx)("div",{children:"invalid res type"})};var eu=((l={}).Upload="upload",l.Form="form",l),ep=o("265489"),em=o("211964"),ef=()=>!0,ev=()=>(0,I.L)()["bot.automation.import_export_v2"]&&ef();o("845713");var eg=e=>t=>ef()?(0,p.jsx)(e,(0,g._)({},t)):null,eh=o("717667"),e_=o("642385"),ex=()=>{var e=eh.Z.useUserInfo();return{report:t=>{(0,e_.Gg)(e_.Kg.import_export_action_front,{action:t,user_id:(null==e?void 0:e.user_id_str)||""})}}},ew=o("345305"),ey=o("280067"),eb=o("753940"),ek=o("244189"),ej={[ek.aZ.Free]:ek.aZ.ProPersonal,[ek.aZ.V1ProInstance]:ek.aZ.Team},eC=o("76133"),eS={};eS.styleTagTransform=G(),eS.setAttributes=U(),eS.insert=W().bind(null,"head"),eS.domAPI=O(),eS.insertStyleElement=Y(),B()(eC.Z,eS);var eI=eC.Z&&eC.Z.locals?eC.Z.locals:void 0,eT=e=>{var{level:t,upgradeLevel:o,onUpgradeLevelChange:r}=e,i=ej[t],a=i===ek.aZ.Team;return(0,p.jsx)("div",{className:eI["premium-level-select"],children:(0,p.jsx)(w.SegmentTab,{className:"w-full",options:[{label:a?_.o.t("export_import_2_agent_flow_16"):_.o.t("export_import_2_agent_flow_15"),value:i},{label:_.o.t("export_import_2_agent_flow_17"),value:ek.aZ.Enterprise}],value:o,onChange:e=>{null==r||r(e.target.value)}})})},eE=()=>{var e,t,o,r,i,a=ev(),{benefit:n}=(0,ey.LZ)((0,ew.N)(e=>({benefit:e.benefit}))),l=Math.max(null!==(r=null===(e=n.user_basic_info)||void 0===e?void 0:e.user_level)&&void 0!==r?r:ek.aZ.Free,null!==(i=null===(o=n.user_basic_info)||void 0===o?void 0:null===(t=o.volc_user_info)||void 0===t?void 0:t.volc_user_level)&&void 0!==i?i:ek.aZ.Free),s=ej[l],[d,c]=(0,h.useState)(s);(0,h.useEffect)(()=>{c(s)},[s]);var{node:u,open:m}=(0,eb.zv)(a?{scene:eb.ej.AdvancedImportExport,shouldUpgradeLevel:d,customImageLevelKey:d===ek.aZ.Enterprise?"1":"0",panelHeader:s!==ek.aZ.Enterprise&&a?(0,p.jsx)(eT,{level:l,upgradeLevel:d,onUpgradeLevelChange:c}):null}:{scene:eb.ej.ImportExport});return{node:u,open:m}},eN=e=>{var t,o,{customCheck:r,onCancel:i,visible:a}=e,[n,l]=(0,h.useState)(eu.Upload),[s,d]=(0,h.useState)({}),[c,u]=(0,h.useState)(!1),[m,f]=(0,h.useState)(),[v,x]=(0,h.useState)(),b=()=>{l(eu.Upload),d({}),f(void 0)},k=()=>{null==i||i(),b(),u(!1)};(0,h.useEffect)(()=>{a&&b()},[a]);var j=(t=(0,y._)(function*(e){if(!!e)try{var t=yield E.sD.ImportPreCheck({package_uri:e},{__disableErrorToast:!0});if(r&&!r(t))return;(null==t?void 0:t.check_file_url)&&ev()?f({checkFileUrl:t.check_file_url,errorCount:Number(t.error_count)}):(f(void 0),d((0,ep._)((0,g._)({},t),{icon:[{url:t.icon_url||"",uid:t.icon_uri||""}],uri:e,file:v})),l(eu.Form))}catch(e){if((0,em.k0)(e)&&"702382036"===e.code)w.Toast.error(_.o.t("export_import_agent_flow_6"));else{var o=(0,em.k0)(e)&&e.msg?e.msg:_.o.t("export_import_agent_flow_5");w.Toast.error(o),C.kg.error({eventName:"import_check_error",error:e})}}}),function(e){return t.apply(this,arguments)});var S=(o=(0,y._)(function*(e){yield j(e),u(!1)}),function(e){return o.apply(this,arguments)});return{handleUploadSuccess:S,uploadLoading:c,setUploadLoading:u,checkFailed:m,setCheckFailed:f,beforeUpload:e=>(u(!0),!0),handleFileChange:e=>{x(null==e?void 0:e[0])},file:v,step:n,reset:b,formValue:s,setFormValue:d,handleConfirm:()=>{w.Modal.confirm({centered:!0,maskClosable:!1,title:_.o.t("export_import_2_agent_flow_13"),okText:_.o.t("Confirm"),okButtonColor:"red",cancelText:_.o.t("Cancel"),content:(0,p.jsx)("div",{className:"coz-fg-secondary text-xs leading-4",children:_.o.t("export_import_2_agent_flow_12")}),onOk:k})},handleClose:k,handleUploadError:(e,t)=>{u(!1)}}},eA=()=>(0,p.jsx)("div",{className:"coz-mg-hglt-secondary h-9 px-3 rounded-[8px] flex items-center gap-1 ml-2",children:(0,p.jsxs)("div",{className:"coz-fg-primary leading-5 font-medium text-sm",children:[_.o.t("export_import_2_agent_flow_22"),(0,p.jsx)("a",{href:"/open/docs/guides/use_workflow?from=search#05adc46d",target:"_blank",className:"coz-fg-hglt",children:_.o.t("export_import_2_agent_flow_23")})]})}),eP=o("24892"),eM={};eM.styleTagTransform=G(),eM.setAttributes=U(),eM.insert=W().bind(null,"head"),eM.domAPI=O(),eM.insertStyleElement=Y(),B()(eP.Z,eM);var eR=eP.Z&&eP.Z.locals?eP.Z.locals:void 0,ez=e=>{var{visible:t,onCancel:o,onImport:r,forms:i,spaceId:a}=e,n=ev(),{handleUploadSuccess:l,uploadLoading:s,beforeUpload:d,handleUploadError:c,checkFailed:u,file:m,handleFileChange:f,step:v,reset:g,formValue:h,setFormValue:y,handleConfirm:b,handleClose:k}=eN(e);return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(w.Modal,{keepDOM:!1,title:(0,p.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,p.jsxs)("div",{className:"flex items-center text-[20px] font-medium coz-fg-plus h-10",children:[_.o.t("export_import_agent_flow_1"),n&&u?(0,p.jsx)(eA,{}):null]}),(0,p.jsx)(w.IconButton,{color:"secondary",className:"relative left-1",icon:(0,p.jsx)(x.rmE,{className:"text-[20px]"}),onClick:()=>{s?b():k()}})]}),visible:t,onCancel:o,footer:null,width:640,className:eR.modal,closable:!1,children:(0,p.jsx)("div",{className:"mt-4 mb-2",children:v===eu.Upload?(0,p.jsx)("div",{children:(0,p.jsx)(en,{spaceId:a,onSuccess:l,onFileChange:f,loading:s,beforeUpload:d,onError:c,checkFailed:u})}):(0,p.jsx)(ec,{spaceId:a,file:m,value:h,onChange:e=>y(e),onReturn:g,onImport:r,forms:i})})})})},eZ=e=>{var[t,o]=(0,h.useState)(!1),r=()=>{o(!1)};return{show:()=>{o(!0)},hide:r,node:(0,p.jsx)(ez,(0,g._)({visible:t,onCancel:r,onImport:r},e))}},eL=o("707567"),eB=o("691369");var eD=((s={}).Import="import",s.Export="export",s),eO="bot_import_export_tasks",eF="tasksChange",eW="importSuccess",eV=new class e{getTasks(){return this.tasks}getTasksBySpaceId(e){return e?this.tasks.filter(t=>t.spaceId===e):[]}getTask(e){return this.tasks.find(t=>t.id===e)}createTask(e){var t=(0,ep._)((0,g._)({},e),{status:eB.og.Processing,progress:0});return this.tasks=[...this.tasks,t],this.handleTasksChange(),t}removeTask(e){this.tasks=this.tasks.filter(t=>t.id!==e),this.handleTasksChange()}clearByType(e,t){var o=this;return(0,y._)(function*(){for(var r of o.tasks.filter(o=>o.type===e&&(!t||o.spaceId===t)&&o.status===eB.og.Processing))try{yield o.cancelTask(r.id,!1)}catch(e){C.kg.error({eventName:"cancelTaskInClearError",error:e})}o.tasks=o.tasks.filter(o=>o.type!==e&&(!t||o.spaceId===t)),o.handleTasksChange()})()}updateTask(e,t){var o=this.tasks.findIndex(t=>t.id===e);-1!==o&&(this.tasks[o]=(0,g._)({},this.tasks[o],t),this.tasks=[...this.tasks],this.handleTasksChange())}updateTaskStatus(e,t,o){var r=this.getTask(e);if(!!r&&r.status!==t)this.updateTask(e,{status:t,progress:0}),t===eB.og.Success&&(r.type===eD.Export&&o&&z(o,r.name||""),r.type===eD.Import&&this.eventEmitter.emit(eW,r))}updateTaskProgress(e,t){if(!!this.getTask(e))this.updateTask(e,{progress:t})}onImportSuccess(e){return this.eventEmitter.on(eW,e),()=>{this.eventEmitter.off(eW,e)}}refreshTasks(e,t){var o=this;return(0,y._)(function*(){var r,i;if(!!e&&!!(null==t?void 0:t.length))null===(i=(yield E.sD.EntityTaskList({task_id_list:t,space_id:e})).data)||void 0===i||null===(r=i.task_list)||void 0===r||r.forEach(e=>{var t,r,i=null==e?void 0:null===(t=e.task_info)||void 0===t?void 0:t.TaskId;if(!i)return;var a=null===(r=e.task_info)||void 0===r?void 0:r.Status;if(!!a)o.updateTaskStatus(i,a,e.package_url)})})()}onTasksChange(e){return this.eventEmitter.on(eF,e),()=>{this.eventEmitter.off(eF,e)}}cancelTask(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=arguments.length>2?arguments[2]:void 0,r=this;return(0,y._)(function*(){if(!!r.getTask(e))yield E.sD.ProcessEntityTask({task_id_list:[e],action:eB.Vv.ProjectCopyCancel},{__disableErrorToast:!0}),t&&(yield r.refreshTasks(o,[e]))})()}retryTask(e){var t=this;return(0,y._)(function*(){if(!!t.getTask(e))yield E.sD.ProcessEntityTask({task_id_list:[e],action:eB.Vv.ProjectCopyRetry},{__disableErrorToast:!0}),t.updateTask(e,{status:eB.og.Processing,progress:0})})()}handleTasksChange(){this.emitTasksChange(),this.saveTasksToStorage()}loadTasksFromStorage(){try{var e=localStorage.getItem(eO);e&&(this.tasks=JSON.parse(e),this.emitTasksChange())}catch(e){C.kg.error({eventName:"loadTasksFromStorageError",error:e})}}saveTasksToStorage(){try{localStorage.setItem(eO,JSON.stringify(this.tasks))}catch(e){C.kg.error({eventName:"saveTasksToStorageError",error:e})}}emitTasksChange(){this.eventEmitter.emit(eF,this.tasks)}constructor(){this.tasks=[],this.eventEmitter=new eL.v,this.loadTasksFromStorage()}},eU=o("299846"),eK=e=>{var t,{title:o="",content:r="",onConfirm:i,buttonProps:a={},buttonTooltip:n="",confirmButtonProps:l={},cancelText:s,confirmText:d,className:c,footerButtonsPosition:u}=e,[m,f]=(0,h.useState)(!1),[v,x]=(0,h.useState)(!1),b=()=>{f(!1)};var j=(t=(0,y._)(function*(){x(!0);try{yield null==i?void 0:i(),f(!1)}catch(e){C.kg.error({eventName:"import_export_confirm_failed",error:e})}finally{x(!1)}}),function(){return t.apply(this,arguments)}),S=(0,p.jsx)(w.IconButton,(0,ep._)((0,g._)({color:"secondary",size:"small",className:"flex"},a),{onClick:()=>{f(!0)}})),I=(0,p.jsx)(w.Button,{size:"small",color:"primary",onClick:b,children:s||_.o.t("Cancel")}),T=(0,p.jsx)(w.Button,(0,ep._)((0,g._)({size:"small",color:"red",onClick:j,loading:v},l),{children:d||_.o.t("Confirm")})),E=(0,p.jsxs)("div",{className:"p-4 rounded-[12px]",children:[(0,p.jsx)("div",{className:"font-medium leading-5 coz-fg-plus",children:o}),(0,p.jsx)("div",{className:"mt-1 leading-4 coz-fg-secondary text-xs",children:r}),"right"===u?(0,p.jsxs)("div",{className:k()("mt-6 flex items-center gap-2 justify-end"),children:[I,T]}):(0,p.jsxs)("div",{className:k()("mt-6  flex items-center gap-2"),children:[T,I]})]});return(0,p.jsx)(w.Popover,{trigger:"custom",visible:m,onClickOutSide:b,className:k()("!p-0 !rounded-[12px] w-[240px]",c),zIndex:1501,content:E,children:(0,p.jsx)("div",{className:"flex items-center",children:n&&!m?(0,p.jsx)(w.Tooltip,{content:n,zIndex:1502,children:S}):S})})},eY=e=>{var t,o,{spaceId:r,task:i}=e,{status:a}=i;var n=(t=(0,y._)(function*(){try{yield eV.cancelTask(i.id,!0,r)}catch(e){C.kg.error({eventName:"import_export_task_cancel_failed",error:e})}}),function(){return t.apply(this,arguments)});var l=(o=(0,y._)(function*(){try{yield eV.retryTask(i.id)}catch(e){C.kg.error({eventName:"import_export_task_retry_failed",error:e})}}),function(){return o.apply(this,arguments)}),s="coz-fg-primary text-xxl";switch(a){case eB.og.Processing:return(0,p.jsx)(eK,{title:_.o.t("export_import_agent_flow_24"),content:_.o.t("export_import_agent_flow_25"),onConfirm:n,buttonProps:{icon:(0,p.jsx)(x.rmE,{className:s})},buttonTooltip:_.o.t("cancel")});case eB.og.Success:return(0,p.jsx)(w.IconButton,{color:"secondary",size:"small",className:"flex",icon:(0,p.jsx)(x.dVD,{className:s}),onClick:()=>{eV.removeTask(i.id)}});case eB.og.Failed:case eB.og.Canceled:return(0,p.jsx)(eK,{title:_.o.t("export_import_agent_flow_29"),content:_.o.t("export_import_agent_flow_30"),onConfirm:l,buttonProps:{icon:(0,p.jsx)(x.mxP,{className:s})},confirmButtonProps:{color:"hgltplus"},buttonTooltip:_.o.t("export_import_agent_flow_31")});default:return null}},eH=o("534087"),eG={};eG.styleTagTransform=G(),eG.setAttributes=U(),eG.insert=W().bind(null,"head"),eG.domAPI=O(),eG.insertStyleElement=Y(),B()(eH.Z,eG);var eJ=eH.Z&&eH.Z.locals?eH.Z.locals:void 0,eq=e=>e===eB.og.Processing?_.o.t("export_import_agent_flow_36"):e===eB.og.Failed?_.o.t("export_import_agent_flow_37"):e===eB.og.Canceled?_.o.t("export_import_agent_flow_38"):_.o.t("export_import_agent_flow_35"),eX=e=>e===eB.og.Processing?"brand":e===eB.og.Failed?"red":"primary",eQ=e=>{var{task:t}=e;return t.type===eD.Export?(0,p.jsx)(w.Tag,{size:"small",color:eX(t.status),children:eq(t.status)}):t.status===eB.og.Processing?(0,p.jsxs)("div",{className:eJ["progress-text"],children:[t.progress,"%"]}):null},e$=e=>{var t,{task:o,spaceId:r}=e;return(0,p.jsxs)("div",{className:k()("flex h-10 justify-between items-center rounded-[8px] coz-mg-secondary px-2",eJ["task-item"],{"coz-stroke-hglt-red border border-solid":o.status===eB.og.Failed}),children:[(0,p.jsxs)("div",{className:"flex gap-[6px] items-center flex-1 overflow-hidden",children:[(0,p.jsx)("img",{src:f,width:16,height:16}),(0,p.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,p.jsx)("div",{className:k()("coz-fg-primary leading-5 w-full truncate",{"coz-fg-dim":o.status===eB.og.Canceled}),children:o.name}),o.status===eB.og.Failed&&o.failedReasons&&o.failedReasons.length>0?(0,p.jsx)("div",{className:"coz-fg-hglt-red text-[10px] leading-[14px]",children:null===(t=o.failedReasons)||void 0===t?void 0:t.join("\uFF0C")}):null]})]}),o.status===eB.og.Processing&&(0,p.jsx)("div",{className:eJ.progress,children:(0,p.jsx)("div",{className:eJ["progress-inner"],style:{width:"".concat(o.progress||0,"%")}})}),(0,p.jsxs)("div",{className:"flex items-center shrink-0",children:[(0,p.jsx)("div",{className:eJ["right-status"],children:(0,p.jsx)(eQ,{task:o})}),(0,p.jsx)("div",{className:eJ["right-operations"],children:(0,p.jsx)(eY,{task:o,spaceId:r})})]})]},o.id)},e0=e=>{var t="".concat("bot_import_export_tasks_panel_expand","_").concat(e),o=localStorage.getItem(t),[r,i]=(0,h.useState)(!o||"true"===o);return{expand:r,handleExpandClick:()=>{var e=!r;i(e),localStorage.setItem(t,e.toString())}}},e1=e=>{var{tasks:t=[],progressText:o,failText:r,successText:i,cancelText:a}=e,n=(0,h.useMemo)(()=>t.find(e=>[eB.og.Failed,eB.og.Canceled].includes(e.status)),[t]),l=(0,h.useMemo)(()=>t.filter(e=>e.status===eB.og.Success),[t]),s=(0,h.useMemo)(()=>t.find(e=>e.status===eB.og.Processing)?eB.og.Processing:t.every(e=>e.status===eB.og.Failed)?eB.og.Failed:t.every(e=>e.status===eB.og.Canceled)?eB.og.Canceled:eB.og.Success,[t]),d=(0,h.useMemo)(()=>s===eB.og.Processing||s===eB.og.Success&&n,[s,n]);return(0,p.jsxs)("div",{className:"flex items-center gap-2 coz-fg-primary font-medium text-xxl",children:[(()=>{switch(s){case eB.og.Processing:return(0,p.jsx)(x.j2n,{className:"text-[18px] coz-fg-secondary animate-spin"});case eB.og.Failed:return(0,p.jsx)(x.U6C,{className:"text-[18px] coz-fg-hglt-red"});case eB.og.Canceled:return(0,p.jsx)(x.U6C,{className:"text-[18px] coz-fg-dim"});case eB.og.Success:return(0,p.jsx)(x.nAC,{className:k()("text-[18px]",n?"coz-fg-dim":"coz-fg-hglt-green")});default:return""}})(),(()=>{switch(s){case eB.og.Processing:return o;case eB.og.Failed:return r;case eB.og.Success:if(l.length===t.length)return"".concat(_.o.t("export_import_agent_flow_32")).concat(i);return i;case eB.og.Canceled:return a;default:return""}})(),d?" ".concat(l.length,"/").concat(t.length):null]})},e2=e=>{var t,{tasks:o,taskType:r,confirmProps:i,spaceId:a}=e,n=(0,h.useMemo)(()=>o.some(e=>e.status===eB.og.Processing),[o]);var l=(t=(0,y._)(function*(){yield eV.clearByType(r,a)}),function(){return t.apply(this,arguments)}),s={size:"small",color:"secondary",icon:(0,p.jsx)(x.rmE,{className:"text-xxl"})};return n?(0,p.jsx)(eK,(0,g._)({onConfirm:l,buttonProps:s,confirmButtonProps:{color:"hgltplus"},className:"w-[320px]",footerButtonsPosition:"right"},i)):(0,p.jsx)(w.IconButton,(0,ep._)((0,g._)({},s),{onClick:l}))},e6=e=>{var{spaceId:t,taskType:o,tasks:r,progressText:i,failText:a,cancelText:n,successText:l,closeConfirmProps:s,handleExpandClick:d,expand:c}=e;return(0,p.jsxs)("div",{className:"flex justify-between leading-none",children:[(0,p.jsx)(e1,{tasks:r,progressText:i,failText:a,cancelText:n,successText:l}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsx)(w.IconButton,{size:"small",color:"secondary",onClick:d,icon:(0,p.jsx)(x.Wdl,{className:k()("transition-transform duration-200 text-xxl",{"rotate-180":!c})})}),(0,p.jsx)(e2,{taskType:o,tasks:r,confirmProps:s,spaceId:t})]})]})},e4=e=>{var{spaceId:t,taskType:o,tasks:r,progressText:i,failText:a,cancelText:n,successText:l,closeConfirmProps:s}=e,{expand:d,handleExpandClick:c}=e0(o),u=(0,h.useMemo)(()=>[...r.filter(e=>e.status===eB.og.Processing),...r.filter(e=>e.status!==eB.og.Processing)],[r]);return(0,p.jsxs)("div",{className:"w-[380px] coz-shadow-default rounded-[12px] p-4 bg-white",children:[(0,p.jsx)(e6,{spaceId:t,tasks:r,progressText:i,failText:a,cancelText:n,successText:l,handleExpandClick:c,expand:d,taskType:o,closeConfirmProps:s}),d?(0,p.jsx)("div",{className:"mt-3 max-h-[388px] overflow-auto",children:(0,p.jsx)("div",{className:"flex flex-col gap-1",children:u.map(e=>(0,p.jsx)(e$,{task:e,spaceId:t},e.id))})}):null]})},e3=e=>{var{spaceId:t,runningTaskIds:o}=e,[r,i]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{var e;(e=(0,y._)(function*(){(null==o?void 0:o.length)&&(yield eV.refreshTasks(t,o)),i(!0)}),function(){return e.apply(this,arguments)})()},[]),{initialized:r}},e8=e=>{var[t,o]=(0,h.useState)(eV.getTasksBySpaceId(e)),r=(0,h.useMemo)(()=>t.filter(e=>e.status===eB.og.Processing).map(e=>e.id),[t]),i=(0,h.useMemo)(()=>t.filter(e=>e.type===eD.Import),[t]),a=(0,h.useMemo)(()=>t.filter(e=>e.type===eD.Export),[t]),{initialized:n}=e3({spaceId:e,runningTaskIds:r});return(0,h.useEffect)(()=>{o(eV.getTasksBySpaceId(e))},[e]),!function(e){var{spaceId:t,runningTaskIds:o}=e;(0,h.useEffect)(()=>{if(!!o.length){var e=setInterval(()=>{eV.refreshTasks(t,o)},2e3);return()=>{clearInterval(e)}}},[o,t])}({spaceId:e,runningTaskIds:r}),!function(e){var{runningTaskIds:t}=e;(0,h.useEffect)(()=>{if(!!t.length){var e=setInterval(()=>{t.forEach(e=>{var t=eV.getTask(e);if(!!t&&!(t.progress>=90))eV.updateTaskProgress(e,t.progress+10)})},200);return()=>{clearInterval(e)}}},[t])}({runningTaskIds:r}),(0,h.useEffect)(()=>eV.onTasksChange(()=>{o(eV.getTasksBySpaceId(e))}),[e]),{tasks:t,importTasks:i,exportTasks:a,initialized:n}},e5=eg(e=>{var{spaceId:t,className:o}=e,r=(0,eU.rY)(e=>e.space.id),i=t||r,{importTasks:a,exportTasks:n,initialized:l}=e8(i);return l?(0,p.jsxs)("div",{className:k()("fixed right-6 bottom-8 flex flex-col gap-2 z-[1500]",o),children:[a&&a.length>0?(0,p.jsx)(e4,{taskType:eD.Import,tasks:a,spaceId:i,progressText:_.o.t("export_import_agent_flow_12"),failText:_.o.t("export_import_agent_flow_13"),cancelText:_.o.t("export_import_agent_flow_13"),successText:_.o.t("export_import_agent_flow_14"),closeConfirmProps:{content:_.o.t("export_import_agent_flow_15"),title:_.o.t("export_import_agent_flow_16"),cancelText:_.o.t("export_import_agent_flow_17"),confirmText:_.o.t("export_import_agent_flow_16")}}):null,n&&n.length>0?(0,p.jsx)(e4,{taskType:eD.Export,tasks:n,spaceId:i,progressText:_.o.t("export_import_agent_flow_18"),failText:_.o.t("export_import_agent_flow_19"),cancelText:_.o.t("export_import_agent_flow_19"),successText:_.o.t("export_import_agent_flow_20"),closeConfirmProps:{content:_.o.t("export_import_agent_flow_21"),title:_.o.t("export_import_agent_flow_22"),cancelText:_.o.t("export_import_agent_flow_23"),confirmText:_.o.t("export_import_agent_flow_22")}}):null]}):null}),e9=e=>{var{onSuccess:t,spaceId:o,resType:r}=e;(0,h.useEffect)(()=>eV.onImportSuccess(e=>{e.spaceId===o&&(!r||e.resType===r)&&(null==t||t(e))}),[t,o,r])},e7=o("179508");var te=((d={}).ClickImport="click_import",d.ClickExport="click_export",d),tt=e=>{var t,{value:o,onImport:r,spaceId:i}=e,[a,n]=(0,h.useState)(!1),{report:l}=ex();return{handleImport:(t=(0,y._)(function*(){n(!0);try{if(!(null==o?void 0:o.uri))return;l(te.ClickImport);var e,t,a,s=yield E.Js.ResourceCopyDispatch({scene:e7.K2.Import,package_uri:o.uri,res_info:{name:o.name,desc:o.desc,icon:null===(t=o.icon)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.uid,flow_mode:o.flow_mode},target_space_id:i,res_id:o.res_id,res_type:o.res_type});(null==s?void 0:s.task_id)&&(eV.createTask({spaceId:i,id:null==s?void 0:s.task_id,type:eD.Import,name:null===(a=o.file)||void 0===a?void 0:a.name,resType:o.res_type}),null==r||r())}catch(e){C.kg.error({eventName:"import_error",error:e})}finally{n(!1)}}),function(){return t.apply(this,arguments)}),loading:a}},to=o("556923"),tr=()=>{var e=(0,eb.CZ)({scene:eb.ej.ImportExport}),{node:t,open:o}=eE();return{premiumPaywallModal:t,open:o,isBenefitAvailable:e}},ti=eg(e=>{var{spaceId:t,forms:o,customCheck:r}=e,i=(0,to._)(e,["spaceId","forms","customCheck"]),{node:a,show:n}=eZ({spaceId:t,forms:o,customCheck:r}),{premiumPaywallModal:l,isBenefitAvailable:s,open:d}=tr(),c=(0,g._)({theme:"solid",color:"primary"},i),u=_.o.t("export_import_agent_flow_1");return s?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(w.Button,(0,ep._)((0,g._)({},c),{icon:(0,p.jsx)(x.nBN,{className:"text-[16px]"}),onClick:()=>{n()},children:u})),a]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(w.Tooltip,{content:_.o.t("export_import_agent_flow_2"),children:(0,p.jsx)(w.Button,(0,ep._)((0,g._)({},c),{icon:(0,p.jsx)(x.sWZ,{className:"w-4 h-4 coz-fg-hglt"}),onClick:()=>{d()},children:u}))}),l]})}),ta=e=>[{res_type:e.res_type,auth_data:e.auth_data,res_id:e.res_id,res_id_str:e.res_id}],tn=o("151766"),tl=o("427721"),ts=e=>{var t=(0,S.f5)(null==e?void 0:e.Sensitive);return{token:(null==t?void 0:t.token)||(null==t?void 0:t.Value),key:null==t?void 0:t.Key}},td=e=>(e||[]).reduce((e,t)=>{if(!t||!t.auth_data)return e;try{return JSON.parse(t.auth_data).forEach(o=>{var r,{token:i,key:a}=ts(o);if(!!i){var n=e.find(e=>e.id===o.NodeId),l={token:i,authData:t,key:a,groupId:o.NodeId,res_id:"".concat(t.res_id_str||t.res_id)};n?null===(r=n.items)||void 0===r||r.push(l):e.push({id:o.NodeId,name:o.NodeTitle,icon:o.NodeIcon,items:[l]})}}),e}catch(t){return e}},[]),tc=(e,t)=>{var o=td(e).map(e=>e.id),r=(0,tn.Z)((t||[]).map(e=>e.groupId).filter(Boolean));return(0,tl.Z)(o,...r)},tu=(e,t)=>e.map(e=>(0,ep._)((0,g._)({},e),{clear_node_id:tc(ta(e),t.filter(t=>t.res_id===e.res_id))}));var tp=((c={}).Normal="normal",c.Advanced="advanced",c);var tm=((u={})[u.Free=0]="Free",u[u.PremiumLite=10]="PremiumLite",u[u.Premium=15]="Premium",u[u.PremiumPlus=20]="PremiumPlus",u[u.V1ProInstance=100]="V1ProInstance",u[u.ProPersonal=110]="ProPersonal",u[u.Team=120]="Team",u[u.Enterprise=130]="Enterprise",u),tf=e=>{var{value:t,onChange:o}=e,r=(0,eb.CZ)({scene:eb.ej.AdvancedImportExport}),{node:i,open:a}=(0,eb.zv)({scene:eb.ej.AdvancedImportExport,shouldUpgradeLevel:tm.Enterprise}),n=_.o.t("export_import_2_agent_flow_9");return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(w.SingleSelect,{className:"w-full",defaultValue:t,layout:"fill",options:[{value:tp.Normal,label:_.o.t("export_import_2_agent_flow_10")},{value:tp.Advanced,disabled:!r,label:r?(0,p.jsx)("span",{children:n}):(0,p.jsxs)("span",{className:"flex items-center gap-1 justify-center",onClick:e=>{e.stopPropagation(),a()},children:[(0,p.jsx)(x.sWZ,{className:"coz-fg-hglt"}),n]})}],onChange:e=>{null==o||o(e.target.value)}}),i]})},tv=e=>{var{description:t}=e;return(0,p.jsx)(w.EmptyState,{size:"large",className:"w-full h-[240px] max-w-full flex items-center justify-center",description:(0,p.jsx)("div",{className:"text-sm",children:t}),icon:(0,p.jsx)(x.nL$,{className:"text-[48px] coz-fg-dim"})})},tg=o("685031"),th=e=>{var{depResourceList:t=[],checkedDepResourceList:o=[],onCheckedDepResourceChange:r}=e,i=(0,h.useMemo)(()=>!!(t.length&&o.length===t.length),[o,t]);return{checkAll:e=>{e?null==r||r([...t]):null==r||r([])},isAllChecked:i}},t_=e=>{var{depResourceList:t=[],checkedDepResourceList:o=[],onCheckedDepResourceChange:r}=e;return{checkByType:(e,i)=>{i?null==r||r((0,tg.Z)([...o,...t.filter(t=>t.res_type===e)],"res_id")):null==r||r(o.filter(t=>t.res_type!==e))},isCheckedByType:e=>t.filter(t=>t.res_type===e).every(e=>!!o.find(t=>t.res_id===e.res_id))}},tx=e=>{var{checkedDepResourceList:t=[],onCheckedDepResourceChange:o}=e;return{check:(e,r)=>{r?null==o||o((0,tg.Z)([...t,e],"res_id")):null==o||o(t.filter(t=>t.res_id!==e.res_id))},isChecked:e=>!!t.find(t=>t.res_id===e.res_id)}},tw=o("475210"),ty=e=>{var{depResourceList:t}=e;return{groupedResources:(0,h.useMemo)(()=>(0,tw.Z)(t,"res_type"),[t])}},tb=(e,t)=>e.res_id===t.res_id&&e.groupId===t.groupId,tk=e=>{var{data:t,checked:o,onChecked:r,groupName:i,isDepResource:a=!1,checkable:n=!0}=e,[l,s]=(0,h.useState)(!1);return(0,p.jsxs)("div",{className:k()("flex items-center  justify-between",{"border-[0.5px] border-solid coz-stroke-primary coz-bg-primary h-12 px-2 rounded-[8px]":!a}),children:[(0,p.jsxs)("div",{className:"flex flex-1 items-center min-w-0",children:[a?(0,p.jsx)("div",{className:"w-[27px]"}):null,(0,p.jsx)("div",{className:"pl-1 pr-2 flex justify-center items-center shrink-0",children:(0,p.jsx)(w.Checkbox,{checked:o,onChange:e=>{null==r||r(e.target.checked)},disabled:!n})}),(0,p.jsxs)("div",{className:"h-6 leading-6 flex-1 coz-fg-primary truncate",children:[i,"{".concat(t.key||"Access Token","}")]})]}),(0,p.jsxs)("div",{className:"w-[200px] flex justify-between p-1 coz-mg-primary rounded-[8px] h-8 items-center shrink-0",children:[(0,p.jsx)("div",{className:"flex-1 truncate coz-fg-secondary h-6 px-1.5 py-0.5 ",children:l?t.token:"******"}),(0,p.jsx)("div",{className:"w-6 h-6 flex justify-center items-center shrink-0",children:(0,p.jsx)(w.IconButton,{color:"secondary",size:"small",onClick:()=>{s(e=>!e)},icon:l?(0,p.jsx)(x.Eho,{className:"coz-fg-primary text-[16px]"}):(0,p.jsx)(x.SA_,{className:"coz-fg-primary text-[16px]"})})})]})]})},tj=e=>{var{checkedItems:t=[],authDataList:o,onChecked:r,isDepResource:i,checkable:a=!0,className:n}=e,l=(0,h.useMemo)(()=>td(o),[o]);return(null==l?void 0:l.length)||i?(0,p.jsx)("div",{className:k()("flex flex-col gap-1",n),children:l.map(e=>{var o;return(0,p.jsx)(p.Fragment,{children:null==e?void 0:null===(o=e.items)||void 0===o?void 0:o.map(o=>(0,p.jsx)(tk,{groupName:e.name,checked:!!t.find(e=>tb(e,o)),data:o,onChecked:e=>{null==r||r(o,e)},isDepResource:i,checkable:a}))})})}):(0,p.jsx)(tv,{description:_.o.t("export_import_2_agent_flow_6")})},tC=e=>{var{checked:t,onChange:o,disabled:r}=e;return(0,p.jsx)(w.Checkbox,{checked:t,onChange:e=>{o(!!e.target.checked)},disabled:r})},tS=e=>{var{depResource:t,onDepAuthItemChecked:o,checkedDepAuthItems:r}=e,{check:i,isChecked:a}=tx(e),n=ta(t);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"flex items-center px-1.5 py-2 h-8",children:[(0,p.jsx)(tC,{checked:a(t),onChange:e=>i(t,e)}),(0,p.jsxs)("div",{className:"flex items-center ml-2 flex-1",children:[(0,p.jsx)("img",{src:t.icon_url,className:"w-5 h-5 rounded-[4px]"}),(0,p.jsx)("div",{className:"coz-fg-primary ml-1 leading-5",children:t.name})]})]},t.res_id),(0,p.jsx)(tj,(0,ep._)((0,g._)({},e),{className:"mt-1",isDepResource:!0,checkable:a(t),authDataList:n,onChecked:o,checkedItems:r}))]})},tI=e=>{var{groupResourceList:t=[]}=e;return(0,p.jsx)("div",{children:t.map(t=>(0,p.jsx)(tS,(0,ep._)((0,g._)({},e),{depResource:t})))})},tT=e=>{var{checkByType:t,isCheckedByType:o}=t_(e),{groupedResources:r}=ty(e),i={[ed.Workflow]:_.o.t("export_import_2_agent_flow_1")};return r?(0,p.jsx)("div",{className:"coz-bg-primary border-[0.5px] border-solid coz-stroke-primary rounded-[8px] p-2 gap-3",children:Object.keys(r).map((a,n)=>{var l,s=Number(a);return(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"flex justify-between items-center h-6 mb-1 px-1 pt-1",children:[(0,p.jsx)("div",{className:"font-medium coz-fg-primary h-5",children:i[a]}),(0,p.jsx)("span",{className:"flex items-center gap-1.5",children:(null===(l=r[s])||void 0===l?void 0:l.length)?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(tC,{checked:o(s),onChange:e=>t(s,e)}),(0,p.jsx)("div",{className:"coz-fg-secondary",children:_.o.t("export_import_2_agent_flow_2")})]}):null})]}),(0,p.jsx)(tI,(0,ep._)((0,g._)({},e),{groupResourceList:r[s]})),n<Object.keys(r).length-1&&(0,p.jsx)("div",{className:"border-0 border-t border-solid coz-stroke-primary my-2"})]})})}):null},tE=e=>{var{depResourceList:t}=e,{checkAll:o,isAllChecked:r}=th(e),i=null==t?void 0:t.length;return(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-1 h-8 pr-3",children:[(0,p.jsx)("div",{className:"coz-fg-plus font-medium text-[16px] leading-8 h-8",children:_.o.t("export_import_2_agent_flow_3")}),(0,p.jsx)("span",{className:"flex items-center gap-1.5",children:i?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(tC,{checked:r,onChange:o}),(0,p.jsx)("div",{className:"coz-fg-primary",children:_.o.t("export_import_2_agent_flow_2")})]}):null})]}),i?(0,p.jsx)(tT,(0,g._)({},e)):(0,p.jsx)(tv,{description:_.o.t("export_import_2_agent_flow_4")})]})},tN=o("871136"),tA={};tA.styleTagTransform=G(),tA.setAttributes=U(),tA.insert=W().bind(null,"head"),tA.domAPI=O(),tA.insertStyleElement=Y(),B()(tN.Z,tA);var tP=tN.Z&&tN.Z.locals?tN.Z.locals:void 0,tM=e=>{var{mode:t,onModeChange:o}=e;return(0,p.jsxs)("div",{className:"flex flex-col gap-4 max-h-[inherit]",children:[(0,p.jsx)("div",{className:tP["mode-select-container"],children:(0,p.jsx)(tf,{value:t||tp.Normal,onChange:o})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"coz-fg-plus font-medium text-[16px] leading-8 h-8 mb-1",children:_.o.t("export_import_2_agent_flow_5")}),(0,p.jsx)(tj,(0,ep._)((0,g._)({},e),{isDepResource:!1}))]}),t===tp.Advanced&&(0,p.jsx)(tE,(0,g._)({},e))]})},tR=e=>{var{modalProps:t}=e,o=(0,to._)(e,["modalProps"]);return(0,p.jsx)(w.Modal,(0,ep._)((0,g._)({okText:_.o.t("confirm"),cancelText:_.o.t("cancel"),width:480,className:tP["export-modal-container"]},t),{header:(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("div",{className:"font-medium text-[20px]  relative h-10 flex items-center justify-between",children:[(0,p.jsx)("div",{className:"leading-7",children:_.o.t("export_import_2_agent_flow_7")}),(0,p.jsx)(w.IconButton,{color:"secondary",className:"relative left-1",icon:(0,p.jsx)(x.rmE,{className:"text-[20px]"}),onClick:null==t?void 0:t.onCancel})]}),(0,p.jsx)("div",{className:"leading-5 coz-fg-secondary shrink-0",children:_.o.t("export_import_2_agent_flow_8")})]}),children:(0,p.jsx)("div",{className:"mb-6",children:(0,p.jsx)(tM,(0,g._)({},o))})}))},tz=e=>{var{data:t,checked:o,onChecked:r}=e,[i,a]=(0,h.useState)(!1);return(0,p.jsxs)("div",{className:"flex items-center hover:coz-mg-primary hover:rounded-[8px]",children:[(0,p.jsx)("div",{className:"w-8 h-10 flex justify-center items-center shrink-0",children:(0,p.jsx)(w.Checkbox,{checked:o,onChange:e=>{null==r||r(e.target.checked)}})}),(0,p.jsx)("div",{className:"w-[150px] h-10 flex items-center shrink-0 font-medium coz-fg-primary p-2 truncate",children:t.key||"Access Token"}),(0,p.jsx)("div",{className:"flex-1 truncate coz-fg-secondary p-2",children:i?t.token:"******"}),(0,p.jsx)("div",{className:"w-10 h-10 flex justify-center items-center shrink-0",children:(0,p.jsx)(w.IconButton,{color:"secondary",onClick:()=>{a(e=>!e)},icon:i?(0,p.jsx)(x.Eho,{className:"coz-fg-primary text-lg"}):(0,p.jsx)(x.SA_,{className:"coz-fg-primary text-lg"})})})]})},tZ=e=>{var{checkedItems:t=[],authDataList:o,onChecked:r}=e,i=(0,h.useMemo)(()=>td(o),[o]);return(0,p.jsx)("div",{className:"bg-white p-[5px] rounded-[8px] coz-stroke-primary border border-solid flex-1 overflow-auto min-h-[224px]",children:i.map((e,o)=>{var a;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,p.jsxs)("div",{className:"flex items-center h-8 pl-[6px]",children:[(0,p.jsx)("img",{src:e.icon,alt:"icon",className:"h-6 w-6 rounded-[4px]"}),(0,p.jsx)("span",{className:"coz-fg-primary text-[16px] leading-[22px] font-medium ml-[10px]",children:e.name})]}),null==e?void 0:null===(a=e.items)||void 0===a?void 0:a.map(e=>(0,p.jsx)(tz,{checked:t.includes(e),data:e,onChecked:t=>{null==r||r(e,t)}}))]}),o!==i.length-1&&(0,p.jsx)("div",{className:"border-0 border-t border-solid coz-stroke-primary my-2"})]})})})},tL=e=>(0,p.jsxs)("div",{className:"flex flex-col gap-2 max-h-[inherit]",children:[(0,p.jsx)("div",{className:"rounded-[8px] coz-mg-hglt-secondary-yellow flex items-center justify-center h-9 coz-fg-primary shrink-0",children:_.o.t("export_import_agent_flow_4")}),(0,p.jsx)(tZ,(0,g._)({},e))]}),tB=e=>{var{modalProps:t}=e,o=(0,to._)(e,["modalProps"]);return ev()?(0,p.jsx)(tR,(0,g._)({modalProps:t},o)):(0,p.jsx)(w.Modal,(0,ep._)((0,g._)({title:_.o.t("export_import_agent_flow_3"),okText:_.o.t("export_import_agent_flow_3"),cancelText:_.o.t("cancel"),width:640,centered:!0},t),{children:(0,p.jsx)(tL,(0,g._)({},o))}))},tD=()=>{var[e,t]=(0,h.useState)([]),[o,r]=(0,h.useState)([]);return{handleCheckedDepResourceChange:e=>{t(e);var i=e.map(e=>"".concat(e.res_id));r(o.filter(e=>i.includes("".concat(e.res_id))))},checkedDepResourceList:e,checkedDepAuthItems:o,handleDepAuthItemChecked:(e,t)=>{r(o=>t?[...o,e]:o.filter(t=>!tb(t,e)))},setCheckedDepResourceList:t,setCheckedDepAuthItems:r}},tO=e=>{var t,o,{spaceId:r,setModalVisible:i}=e,[a,n]=(0,h.useState)(),[l,s]=(0,h.useState)([]),{handleCheckedDepResourceChange:d,checkedDepResourceList:c,checkedDepAuthItems:u,handleDepAuthItemChecked:p,setCheckedDepResourceList:m,setCheckedDepAuthItems:f}=tD(),[v,g]=(0,h.useState)(tp.Normal),{report:_}=ex();var x=(t=(0,y._)(function*(e){if(!e.res_id||!e.res_type)throw new T.sH("normal_error","miss res_id or res_type");C.kg.info({message:"export_resource",meta:{res_id:e.res_id}});var t,o=yield E.sD.ExportPreCheck({res_type:e.res_type,id:e.res_id,commit_id:e.commit_id}),i=o.auth_data_list,a=(o.dep_resource_list||[]).filter(e=>e.res_id);return{doExport:(t=(0,y._)(function*(t,o){if(!e.res_id||!r)throw new T.sH("normal_error","miss res_id or spaceId");_(te.ClickExport);try{var i={scene:es.Export,res_id:e.res_id,res_type:e.res_type,clear_auth_node_list:t,res_info:{commit_id:e.commit_id}};ev()&&(i.export_version=el.V2,i.export_sub_resource=o,C.E7.event({eventName:"export_resource_v2",meta:{resId:e.res_id,hasSubResource:(o||[]).length>0}}));var a=yield E.Js.ResourceCopyDispatch(i);a.task_id&&eV.createTask({id:a.task_id,type:eD.Export,name:e.name,spaceId:r,resType:e.res_type})}catch(e){C.kg.error({message:"export_resource_fail",error:e})}}),function(e,o){return t.apply(this,arguments)}),authDataList:i,depResourceList:a,resource:e}}),function(e){return t.apply(this,arguments)});return{handleExport:(o=(0,y._)(function*(e){var t,o,r=yield x(e);n(r);var a=!!(null==r?void 0:null===(t=r.authDataList)||void 0===t?void 0:t.length),l=!!(null===(o=r.depResourceList)||void 0===o?void 0:o.length)&&ev();a||l?i(!0):yield r.doExport([])}),function(e){return o.apply(this,arguments)}),exportModalConfig:a,checkedItems:l,setCheckedItems:s,handleCheckedDepResourceChange:d,checkedDepResourceList:c,checkedDepAuthItems:u,handleDepAuthItemChecked:p,handleChecked:(e,t)=>{s(o=>t?[...o,e]:o.filter(t=>e!==t))},setCheckedDepResourceList:m,setCheckedDepAuthItems:f,mode:v,handleModeChange:g}},tF=e=>{var{spaceId:t}=e,[o,r]=(0,h.useState)(!1),{handleExport:i,exportModalConfig:a,checkedItems:n,handleCheckedDepResourceChange:l,checkedDepResourceList:s,checkedDepAuthItems:d,handleDepAuthItemChecked:c,handleChecked:u,setCheckedDepResourceList:m,setCheckedDepAuthItems:f,setCheckedItems:v,mode:g,handleModeChange:_}=tO({spaceId:t,setModalVisible:r});return(0,h.useEffect)(()=>{!o&&(v([]),m([]),f([]))},[o]),{exportModal:(0,p.jsx)(tB,{modalProps:{visible:o,onOk:()=>{r(!1),null==a||a.doExport(tc(null==a?void 0:a.authDataList,n),g===tp.Advanced?tu(s,d):void 0)},onCancel:()=>{r(!1)},keepDOM:!1},authDataList:null==a?void 0:a.authDataList,checkedItems:n,onChecked:u,depResourceList:null==a?void 0:a.depResourceList,checkedDepResourceList:s,onCheckedDepResourceChange:l,checkedDepAuthItems:d,onDepAuthItemChecked:c,mode:g,onModeChange:_}),handleExport:i}},tW=e=>{var t=(0,eb.CZ)({scene:eb.ej.ImportExport}),{node:o,open:r}=eE();return{premiumPaywallModal:o,open:r,isBenefitAvailable:t,isSpaceRoleAvailable:!0}},tV=eg(e=>{var{spaceId:t,resourceInfo:o,handleExport:r,openPremiumPaywallModal:i,disabled:a,prefixIcon:n}=e,{isBenefitAvailable:l,isSpaceRoleAvailable:s}=tW(t),d=l?void 0:_.o.t("export_import_agent_flow_2"),c=a||!s,u=(0,p.jsx)(w.Menu.Item,{disabled:c,suffix:l||c?null:(0,p.jsx)("div",{className:"flex items-center ml-[12px]",children:(0,p.jsx)(x.sWZ,{className:"coz-fg-hglt"})}),onClick:()=>{l?r(o):i()},children:n?(0,p.jsxs)("div",{className:"px-4px flex items-center gap-8px",children:[n,_.o.t("export_import_agent_flow_3")]}):_.o.t("export_import_agent_flow_3")});return(0,p.jsx)(p.Fragment,{children:d?(0,p.jsx)(w.Tooltip,{content:d,children:u}):u})}),tU=e=>{var{spaceId:t}=e,{handleExport:o,exportModal:r}=tF({spaceId:t}),{node:i,open:a}=eE();return{renderMenu:e=>{var{resourceInfo:r,disabled:i,key:n,prefixIcon:l}=e;return(0,p.jsx)(tV,{spaceId:t,resourceInfo:r,handleExport:o,openPremiumPaywallModal:a,disabled:i,prefixIcon:l},n)},modal:(0,p.jsxs)(p.Fragment,{children:[r,i]})}}},405510:function(e,t,o){o.d(t,{sL0:()=>i.sL0,OHc:()=>u,htH:()=>i.htH,fB_:()=>d,Up9:()=>i.Up9,KNf:()=>i.KNf,vGB:()=>i.vGB,_yW:()=>i._yW,lcl:()=>i.lcl,TvD:()=>i.TvD,VBX:()=>i.VBX,ByT:()=>i.ByT,_$8:()=>i._$8,CPf:()=>i.CPf,MZY:()=>i.MZY,uql:()=>i.uql,n$I:()=>i.n$I,k5N:()=>i.k5N,KN6:()=>i.KN6,B5l:()=>i.B5l,twY:()=>i.twY,Lo5:()=>i.Lo5,x5o:()=>i.x5o,aZp:()=>i.aZp,_Uw:()=>c,BSe:()=>i.BSe,Ldn:()=>i.Ldn,d$J:()=>i.d$J,wz8:()=>i.wz8,Grz:()=>i.Grz,XG2:()=>i.XG2,z7A:()=>i.z7A,XQ3:()=>i.XQ3,gfc:()=>i.gfc,Vp9:()=>i.Vp9,MZx:()=>i.MZx,nBi:()=>i.nBi,Mtg:()=>i.Mtg,_gl:()=>i._gl,Xpx:()=>i.Xpx,j2G:()=>i.j2G,ztP:()=>i.ztP});var r=o("449001"),i=o("124707"),a=o("341333"),n=o("938809");o("723530");var l=o("297646"),s=o("697643"),d=new l.S;function c(e){return function(t){return(0,n.jsx)(s.aH,{client:d,children:(0,n.jsx)(e,(0,a._)({},t))})}}var u=new Proxy({},{get:(e,t)=>r.OH[t].bind(r.OH)})},366854:function(e,t,o){o.d(t,{F1:function(){return x},G0:function(){return p},Ne:function(){return a},Pz:function(){return d},RV:function(){return i},Sk:function(){return _},XE:function(){return h},aW:function(){return c},b2:function(){return m},bQ:function(){return g},d9:function(){return l},fs:function(){return f},gu:function(){return w},hh:function(){return s},je:function(){return u},pd:function(){return v},pj:function(){return n},wl:function(){return r}});var r=()=>{},i="999999",a="BOT_USER_INPUT",n="USER_INPUT",l="CONVERSATION_NAME",s=30,d=/^[a-zA-Z][a-zA-Z0-9_]{0,63}$/,c="playground.node",u="/nodeMeta",p="/outputs",m="/inputs/batch",f=1,v=10,g=1,h=200,_=10,x=100,w={width:360,height:120.001}},889707:function(e,t,o){o.d(t,{OHc:()=>R.OHc,nZF:()=>f.nZ,agJ:()=>E,Tbq:()=>B,E7u:()=>L,pdM:()=>I.pd,lcl:()=>R.lcl,fsJ:()=>I.fs,VKi:()=>f.VK,CPf:()=>R.CPf,gug:()=>I.gu,G0B:()=>I.G0,nyy:()=>f.ny,GQ8:()=>U,nPx:()=>ec,fwJ:()=>Y,FLM:()=>et,KN6:()=>R.KN6,SMH:()=>f.SM,B5l:()=>R.B5l,F1P:()=>I.F1,m_1:()=>es,xtp:()=>T,ycG:()=>f.yc,_Uw:()=>R._Uw,sSN:()=>f.sS,bQm:()=>I.bQ,jeV:()=>I.je,IZ8:()=>eo.I,$dM:()=>f.$d,XQ3:()=>R.XQ3,vHX:()=>f.vH,nBi:()=>R.nBi,lZh:()=>f.lZ,_gl:()=>R._gl,Psf:()=>f.Ps,j2G:()=>R.j2G,ztP:()=>R.ztP,XEJ:()=>I.XE,hhB:()=>I.hh,sL0:()=>R.sL0,Iyz:()=>M,d9h:()=>I.d9,fB_:()=>R.fB_,KNf:()=>R.KNf,_yW:()=>R._yW,XmD:()=>f.Xm,tnn:()=>f.tn,FCD:()=>ei,Gu0:()=>f.Gu,VNC:()=>O,pju:()=>I.pj,Cn3:()=>G,Sk3:()=>I.Sk,_$8:()=>R._$8,YX3:()=>f.YX,Huc:()=>J,IuB:()=>f.Iu,b27:()=>I.b2,Pz_:()=>I.Pz,ikd:()=>V,Lo5:()=>R.Lo5,Rkg:()=>f.Rk,aZp:()=>R.aZp,owu:()=>f.ow,BSe:()=>R.BSe,iBO:()=>en,wz8:()=>R.wz8,z7A:()=>R.z7A,mhS:()=>ed,rsR:()=>el,QJG:()=>K,vTH:()=>f.vT,kOP:()=>f.kO,zho:()=>eu,RV6:()=>I.RV,IUL:()=>$});var r,i,a,n,l,s,d,c,u,p,m,f=o("911379"),v=o("811012");var g=((r={}).DEFAULT="default",r.INPUT_PARAMETERS="inputParameters",r.OUTPUTS="outputs",r.DATASET_PARAM="datasetParam",r.LLM_PARAM="llmParam",r.INTENTS="intents",r.CONCAT_RESULT="concatResult",r.CUSTOM_ARRAY_CONCAT_CHAR="customArrayConcatChar",r.CUSTOM_SPLIT_CHAR="customSplitChar",r.REF_INPUT_PARAMETER="refInputParameter",r.VARIABLE_ASSIGN="variableAssign",r.JSON_STRING_PARSER="jsonStringParser",r.IMAGE_REFERENCE_PARSER="imageReferenceParser",r.EXPRESSION_PARSER="expressionParser",r.VARIABLE_MERGE_GROUPS_PARSER="variableMergeGroupsParser",r.DB_FIELDS_PARSER="dbFieldsParser",r.DB_CONDITIONS_PARSER="dbConditionsParser",r.VOLCANO_TAG_CONDITION_PARSER="volcanoTagConditionParser",r.VOLCANO_DATASET_TAG_CONDITION_PARSER="volcanoDatasetTagConditionParser",r),h=["\n","	",".","\u3002",",","\uFF0C",";","\uFF1B"," "],_=o("341333"),x=o("866342");function w(e){var t,o,r,i,a;try{i=new URL(e)}catch(e){return!1}return!!(["image","jpg","jpeg","png"].includes((null===(r=i.searchParams)||void 0===r?void 0:null===(o=r.get("x-wf-file_name"))||void 0===o?void 0:null===(t=o.split("."))||void 0===t?void 0:t.pop())||i.pathname.split(".").pop())&&["cC1ib3Qtd29ya2Zsb3ctc2lnbi5ieXRlZGFuY2UubmV0","cC1ib3Qtd29ya2Zsb3cuYnl0ZWQub3Jn","cC1ib3Qtd29ya2Zsb3cuYnl0ZWRhbmNlLm5ldA==","cDI2LWJvdC13b3JrZmxvdy1zaWduLmJ5dGVpbWcuY29t","cDMtYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20=","cDktYm90LXdvcmtmbG93LXNpZ24uYnl0ZWltZy5jb20="].includes(btoa(null!==(a=i.hostname)&&void 0!==a?a:"")))||!1}var y=e=>{if(!e)return null;var t,o,r=(0,x.Z)(e,"value.content");return"boolean"==typeof r||"number"==typeof r?{value:r.toString(),isImage:!1}:r?"string"==typeof r?{value:r,isImage:w(r)}:Array.isArray(r)?{value:r.join(","),isImage:!1}:"block-output"===r.source&&r.name?{value:r.name,isImage:!1}:"string"==typeof r.source&&r.source.startsWith("global_variable")?{value:null!==(o=null===(t=r.path)||void 0===t?void 0:t.join("."))&&void 0!==o?o:"",isImage:!1}:{value:null,isImage:!1}:null},b=e=>[].concat(e).filter(Boolean).map(y).filter(Boolean),k=e=>{var t,o,r=null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.content;if(!!r){if("string"==typeof r)return r;if("object"==typeof r){if("block-output"===r.source&&"string"==typeof r.name)return r.name;if("string"==typeof r.source&&r.source.startsWith("global_variable"))return null==r?void 0:null===(o=r.path)||void 0===o?void 0:o.join(".")}}},j=o("466104"),C=o("386555"),S=e=>{var t=[];return Array.isArray(e)?t=e:"object"==typeof e&&Object.keys(e||{}).forEach(o=>{t.push({name:o,input:e[o]})}),t.map(e=>{var t=y((0,x.Z)(e,"input"));return t?(0,_._)({name:e.name},t):null}).filter(Boolean)};g.DEFAULT,g.INPUT_PARAMETERS,g.OUTPUTS,g.DATASET_PARAM,g.LLM_PARAM,g.INTENTS,g.CONCAT_RESULT,g.CUSTOM_ARRAY_CONCAT_CHAR,g.CUSTOM_SPLIT_CHAR,g.REF_INPUT_PARAMETER,g.VARIABLE_ASSIGN,g.JSON_STRING_PARSER,g.IMAGE_REFERENCE_PARSER,g.EXPRESSION_PARSER,g.VARIABLE_MERGE_GROUPS_PARSER,g.DB_FIELDS_PARSER,g.DB_CONDITIONS_PARSER,g.VOLCANO_TAG_CONDITION_PARSER,g.VOLCANO_DATASET_TAG_CONDITION_PARSER;var I=o("366854"),T=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.filter(e=>!!e).join(".")},E=function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];return T((null==e?void 0:e.id)?T(I.aW,e.id):"",...o)};o("693005"),o("479727");var N=o("265489"),A=o("660926"),P=e=>{if((null==e?void 0:e.type)===f.Rk.image||(null==e?void 0:e.type)===f.Rk.string&&[f.$d.image,f.$d.svg].includes(null==e?void 0:e.assistType))return!0};function M(e){var t,o,r,{outputData:i,nodeSchema:a,excludeNodeTypes:n=[]}=e;if(!a||!i||n.includes(null==a?void 0:a.type))return[];var l=[];return(l=(null==a?void 0:a.type)===f.ny.End||(null==a?void 0:a.type)===f.ny.Output?null==a?void 0:null===(o=a.data)||void 0===o?void 0:null===(t=o.inputs)||void 0===t?void 0:t.inputParameters:null==a?void 0:null===(r=a.data)||void 0===r?void 0:r.outputs)?(0,A.Z)(l.map(e=>(function e(t,o){var r=[];if(P(o)&&"string"==typeof t&&r.push(t),(null==o?void 0:o.type)===f.Rk.list&&Array.isArray(t)){if([f.$d.image,f.$d.svg].includes(null==o?void 0:o.assistType))t.forEach(e=>{"string"==typeof e&&r.push(e)});else{var i=t.map(t=>e(t,o.schema));r=r.concat(...i)}}if((null==o?void 0:o.type)===f.Rk.object){var a=Object.entries(t||{}).map(t=>{var[r,i]=t;return e(i,(o.schema||[]).find(e=>e.name===r))});r=r.concat(...a)}return r})((0,x.Z)(i,null==e?void 0:e.name),(null==e?void 0:e.input)?(0,N._)((0,_._)({},e.input),{name:e.name}):e))).filter(e=>!!e):[]}var R=o("405510"),z=o("498842"),Z="workflow",L=z.E7.createReporterWithPreset({namespace:Z});function B(e){var t;null===(t=z.E7.slardarInstance)||void 0===t||t.call(z.E7,"captureException",e,{isErrorBoundary:"false",namespace:Z})}var D=o("101799");function O(e,t){return(0,D.vow)(e)?function(e,t){var o=e.getData(D.Psq).formModel.getFormItemValueByPath("/");if(!!o&&"object"==typeof o){var r=F(o,t);return(0,v.Z)(r)}}(e,t):function(e,t){var o=e.getData(D.Psq).formModel,r=[...o.formItemPathMap.keys()].find(e=>e.endsWith(t));if(!!r)return(0,v.Z)(o.getFormItemValueByPath(r))}(e,t)}var F=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!!e){if(o.endsWith(t))return e;if("object"==typeof e&&!Array.isArray(e)){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=o?"".concat(o,"/").concat(r):"/".concat(r);if(i.endsWith(t))return e[r];var a=F(e[r],t,i);if(void 0!==a)return a}}if(Array.isArray(e))for(var n=0;n<e.length;n++){var l="".concat(o,"/").concat(n);if(l.endsWith(t))return e[n];var s=F(e[n],t,l);if(void 0!==s)return s}}},W=o("383672"),V=e=>e===W.WorkflowMode.Workflow||e===W.WorkflowMode.ChatFlow,U=e=>[I.Ne,I.pj,I.d9].includes(null!=e?e:""),K=e=>[I.Ne,I.pj].includes(null!=e?e:""),Y=(e,t)=>{var o=Array.isArray(t)?e=>{t.forEach(t=>t(e))}:t;return m.traverseNodes({value:e},o),e};(i=m||(m={})).traverseNodes=(e,t)=>{var{value:o}=e;if(!!o){if("[object Object]"===Object.prototype.toString.call(o))Object.entries(o).forEach(r=>{var[a,n]=r;return i.traverseNodes({value:n,container:o,key:a,parent:e},t)});else if(Array.isArray(o))for(var r=o.length-1;r>=0;r--){var n=o[r];i.traverseNodes({value:n,container:o,index:r,parent:e},t)}t(a({node:e}))}},a=e=>{var{node:t}=e;return{node:t,setValue:e=>n(t,e),getParents:()=>l(t),getPath:()=>s(t),getStringifyPath:()=>d(t),deleteSelf:()=>c(t)}},n=(e,t)=>{if(!!t&&!!e){e.value=t;var{container:o,key:r,index:i}=e;r&&o?o[r]=t:"number"==typeof i&&(o[i]=t)}},l=e=>{for(var t=[],o=e;o;)t.unshift(o),o=o.parent;return t},s=e=>{var t=[];return l(e).forEach(e=>{e.key?t.unshift(e.key):e.index&&t.unshift(e.index)}),t},d=e=>s(e).reduce((e,t)=>"string"!=typeof t?"".concat(e,"[").concat(t,"]"):/\W/g.test(t)?"".concat(e,'["').concat(t,'"]'):"".concat(e,".").concat(t),""),c=e=>{var{container:t,key:o,index:r}=e;o&&t?delete t[o]:"number"==typeof r&&t.splice(r,1)};var H=o("551398"),G={[H.ow.Image]:[".apng",".avif",".bmp",".cgm",".djvu",".fits",".gif",".heic",".heics",".heif",".heifs",".ico",".ief",".jls",".jp2",".jpe",".jpeg",".jpg",".jpm",".jpx",".jxr",".ktx",".ktx2",".png",".sgi",".svg",".svgz",".tga",".tif",".tiff",".webp",".x3d",".x3db",".x3dv"],[H.ow.Doc]:[".docx",".doc",".pdf"],[H.ow.Audio]:[".mp3",".wav",".aac",".flac",".ogg",".wma",".alac",".mid",".midi",".ac3",".dsd",".opus",".spx",".sil",".silk",".m4a",".pcm",".mp4"],[H.ow.Excel]:[".xls",".xlsx",".csv"],[H.ow.Video]:[".mp4",".avi",".mov",".wmv",".flv",".mkv"],[H.ow.Zip]:[".zip",".rar",".7z",".tar",".gz",".bz2"],[H.ow.Code]:[".py",".java",".c",".cpp",".js",".css"],[H.ow.Txt]:[".txt"],[H.ow.Ppt]:[".ppt",".pptx"],[H.ow.Svg]:[".svg"]},J=(e,t)=>{var o,r=H.ow.isArrayType(e)?H.ow.getArraySubType(e):e;return o=r===H.ow.File?(null==t?void 0:t.length)?t.map(e=>{var t;return null===(t=G[e])||void 0===t?void 0:t.join(",")}).join(","):Object.values(G).map(e=>e.join(",")).join(","):(G[r]||[]).join(",")},q=o("255721"),X=o("16242"),Q=o("182956");var $=(u=(0,q._)(function*(e){return new Promise(t=>{var o=window.open(e,"_blank"),{destroy:r}=Q.Modal.info({title:X.o.t("oauth_authorizing"),content:X.o.t("oauth_if_auth_finished"),type:"dialog",cancelText:X.o.t("Cancel"),okText:X.o.t("Complete"),onOk:()=>{clearInterval(i),clearTimeout(a),t()},onCancel:()=>{clearInterval(i),clearTimeout(a),t()}}),i=setInterval(()=>{var e,n=!1;try{n=null!==(e=null==o?void 0:o.closed)&&void 0!==e&&e}catch(e){n=!1}n&&(r(),clearInterval(i),clearTimeout(a),t())},500),a=setTimeout(()=>{r(),clearInterval(i),t()},3e5)})}),function(e){return u.apply(this,arguments)}),ee=e=>{if((null==e?void 0:e.type)===f.Rk.string&&[f.$d.video].includes(null==e?void 0:e.assistType))return!0};function et(e){var t,o,r,{outputData:i,nodeSchema:a}=e;if(!a||!i)return[];var n=[];return(n=(null==a?void 0:a.type)===f.ny.End||(null==a?void 0:a.type)===f.ny.Output?null==a?void 0:null===(o=a.data)||void 0===o?void 0:null===(t=o.inputs)||void 0===t?void 0:t.inputParameters:null==a?void 0:null===(r=a.data)||void 0===r?void 0:r.outputs)?(0,A.Z)(n.map(e=>(function e(t,o){var r=[];if(ee(o)&&"string"==typeof t&&r.push(t),(null==o?void 0:o.type)===f.Rk.list&&Array.isArray(t)){if([f.$d.video].includes(null==o?void 0:o.assistType))t.forEach(e=>{"string"==typeof e&&r.push(e)});else{var i=t.map(t=>e(t,o.schema));r=r.concat(...i)}}if((null==o?void 0:o.type)===f.Rk.object){var a=Object.entries(t||{}).map(t=>{var[r,i]=t;return e(i,(o.schema||[]).find(e=>e.name===r))});r=r.concat(...a)}return r})((0,x.Z)(i,null==e?void 0:e.name),(null==e?void 0:e.input)?(0,N._)((0,_._)({},e.input),{name:e.name}):e))).filter(e=>!!e):[]}var eo=o("155884"),er=o("618016"),ei=()=>{var e=(0,D.PFB)();if(!(null==e?void 0:e.id))throw new er.sH("useNodeTestId must be called in a workflow node","");var t=()=>T(I.aW,e.id);return{getNodeTestId:t,getNodeSetterId:e=>T(t(),e),concatTestId:T}},ea=o("723530"),en=(0,ea.createContext)(void 0);function el(){return(0,ea.useContext)(en)}class es{get registry(){return this.node.getNodeRegistry()}get inputParameters(){var e,t;return this.registry.getNodeInputParameters?this.registry.getNodeInputParameters(this.node):(null===(e=this.node.getNodeMeta())||void 0===e?void 0:e.inputParametersPath)?this.node.getData(D.Psq).formModel.getFormItemValueByPath(null===(t=this.node.getNodeMeta())||void 0===t?void 0:t.inputParametersPath):this.getFormValueByPathEnds("/inputParameters")}get outputs(){var e;if(this.registry.getNodeOutputs)return this.registry.getNodeOutputs(this.node);return null===(e=this.data)||void 0===e?void 0:e.outputs}getFormValueByPathEnds(e){return O(this.node,e)}get type(){return this.node.flowNodeType}get isError(){return!!this.error}get error(){return this.node.getData(D.fu1).getError()}setError(e){this.node.getData(D.fu1).setError(e)}get isInitialized(){return this.form.initialized}get data(){return this.form.getFormItemValueByPath("/")}setData(e){if(void 0!==e){var{form:t}=this;if((0,D.vow)(this.node))Object.keys(e).forEach(o=>{t.setValueIn(o,e[o])});else{var o=t.getFormItemByPath("/");o&&(o.value=e)}}}get icon(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.icon}get title(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.title}get description(){var e,t;return null===this||void 0===this?void 0:null===(t=this.data)||void 0===t?void 0:null===(e=t.nodeMeta)||void 0===e?void 0:e.description}get form(){return this.node.getData(D.Psq).formModel}getValueByPath(e){return this.form.getValueIn(e)}constructor(e){this.node=e,this.setData=this.setData.bind(this),this.setError=this.setError.bind(this)}}class ed extends D.RDk{init(){this.hasSetNodeData=!1,this.nodeData=void 0}getDefaultData(){}setNodeData(e){if(this.hasSetNodeData){console.warn("node ".concat(this.entity.id," has already set WorkflowNodeData"));return}this.nodeData=(0,_._)({},e),this.hasSetNodeData=!0}updateNodeData(e){this.nodeData=(0,_._)({},this.nodeData,e)}getNodeData(){return this.nodeData}constructor(...e){super(...e),this.hasSetNodeData=!1}}var ec=((p={})[p.Plugin=1]="Plugin",p[p.Workflow=4]="Workflow",p[p.Dataset=3]="Dataset",p);class eu extends D.RDk{get result(){return this.data}set result(e){this.update(e)}getDefaultData(){return null}}eu.type="WorkflowNodeTestRunData"},155884:function(e,t,o){o.d(t,{I:()=>s});var r=o("341333"),i=o("265489"),a=o("888953"),n=o("922321"),l={nodes:[],edges:[],isCreatingWorkflow:!1,isPublished:!1},s=(0,n.Ue)()((0,a.mW)(e=>(0,i._)((0,r._)({},l),{setNodes:t=>e({nodes:null!=t?t:[]}),setEdges:t=>e({edges:null!=t?t:[]}),setIsCreatingWorkflow:t=>e({isCreatingWorkflow:t}),setIsPublished:t=>e({isPublished:t})})))},386555:function(e,t,o){o.d(t,{$d:function(){return l},Rk:function(){return n},_T:function(){return a}}),(a||(a={})).createEmpty=function(){return{type:"string",value:{type:"ref",content:{source:"block-output",blockID:"",name:""}}}};var r,i,a,n=((i={}).object="object",i.list="list",i.string="string",i.integer="integer",i.float="float",i.boolean="boolean",i.image="image",i.time="time",i);var l=((r={})[r.file=1]="file",r[r.image=2]="image",r[r.doc=3]="doc",r[r.code=4]="code",r[r.ppt=5]="ppt",r[r.txt=6]="txt",r[r.excel=7]="excel",r[r.audio=8]="audio",r[r.zip=9]="zip",r[r.video=10]="video",r[r.svg=11]="svg",r[r.voice=12]="voice",r[r.time=1e4]="time",r)},911379:function(e,t,o){o.d(t,{vT:()=>N,lZ:()=>C,ow:()=>v.ow,YX:()=>x,Tg:()=>P,SM:()=>T,Ps:()=>w,Iu:()=>v.Iu,Gu:()=>I,kO:()=>j,Xm:()=>k,sS:()=>E,_T:()=>g._T,Rk:()=>g.Rk,tn:()=>M,ny:()=>y,yc:()=>p,VK:()=>f,fw:()=>A,nZ:()=>m,vH:()=>v.vH,_C:()=>b,$d:()=>g.$d});var r,i,a,n,l,s,d,c,u,p,m,f,v=o("551398");(r=u||(u={})).getVariableTreeNodeByPath=function(e,t){t=t.slice();for(var o=e,r=t.shift();r&&o;)if((r=t.shift())&&!(o=(o.children||[]).find(e=>e.key===r)))return;return o},r.keyPathToNameString=function(e,t){var o=[];t=t.slice();for(var r=e,i=t.shift();i&&r;)if(o.push(r.name),(i=t.shift())&&!(r=(r.children||[]).find(e=>e.key===i)))return"";return o.join(".")},r.nameStringToKeyPath=function(e,t){for(var o=[],r=t.split("."),i=e,a=r.shift();a&&i;)if(o.push(i.key),(a=r.shift())&&!(i=(i.children||[]).find(e=>e.name===a)))return[];return o};var g=o("386555");!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"string",r={name:e,input:{type:o,value:{type:"literal",content:String(t)}}},i=v.ow.String;switch(o){case"string":i=v.ow.String;break;case"integer":i=v.ow.Integer;break;case"float":i=v.ow.Number;break;case"boolean":i=v.ow.Boolean}return r.input.value.rawMeta={type:i},r}e.create=t;e.createString=function(e,o){return t(e,o,"string")};e.createInteger=function(e,o){return t(e,o,"integer")};e.createFloat=function(e,o){return t(e,o,"float")};e.createArray=function(e,t,o){return{name:e,input:{type:"list",schema:o,value:{type:"literal",content:t}}}};e.createObject=function(e,t){return{name:e,input:{value:{type:"object_ref"},type:"object",schema:t}}};e.createBoolean=function(e,o){var r=t(e,o,"boolean");return r.input.value.content=o,r};e.toLiteral=function(e){return e.input.value.content};e.isBlockInput=function(e){var t,o;return!!(null==e?void 0:e.name)&&(null==e||null===(o=e.input)||void 0===o||null===(t=o.value)||void 0===t||t.content,!0)}}(p||(p={}));var h=o("797029"),_=o("462458");var x=((i={}).LITERAL="literal",i.REF="ref",i.OBJECT_REF="object_ref",i);!function(e){function t(e){return"ref"===e.type}function o(e){return"literal"===e.type}e.isRef=t,e.isLiteral=o;e.isObjectRef=function(e){return(null==e?void 0:e.type)==="object_ref"};e.isExpression=function(e){return!(0,h.Z)(e)&&(t(e)||o(e))};e.isEmpty=function(e){if((null==e?void 0:e.type)==="object_ref")return!1;if(null===e)return!0;if("object"!=typeof e&&"function"!=typeof e)return(0,_.Z)(e);if((null==e?void 0:e.content)===""||(0,_.Z)(null==e?void 0:e.content))return!0;if(Array.isArray(null==e?void 0:e.content))return(null==e?void 0:e.content.length)===0;if((null==e?void 0:e.type)==="ref"){var t,o;return!(null==e?void 0:null===(o=e.content)||void 0===o?void 0:null===(t=o.keyPath)||void 0===t?void 0:t.length)}return!1}}(m||(m={}));var w=((a={}).Single="single",a.Batch="batch",a);var y=((n={}).Start="1",n.End="2",n.LLM="3",n.Api="4",n.Code="5",n.Dataset="6",n.If="8",n.SubWorkflow="9",n.Variable="11",n.Database="12",n.Output="13",n.Imageflow="14",n.Text="15",n.ImageGenerate="16",n.ImageReference="17",n.Question="18",n.Break="19",n.SetVariable="20",n.Loop="21",n.Intent="22",n.ImageCanvas="23",n.SceneChat="25",n.SceneVariable="24",n.LTM="26",n.DatasetWrite="27",n.Batch="28",n.Continue="29",n.Input="30",n.Comment="31",n.VariableMerge="32",n.QueryMessageList="37",n.ClearContext="38",n.CreateConversation="39",n.TriggerUpsert="34",n.TriggerDelete="35",n.TriggerRead="36",n.VariableAssign="40",n.Http="45",n.DatabaseUpdate="42",n.DatabaseQuery="43",n.DatabaseDelete="44",n.DatabaseCreate="46",n.DatasetDelete="60",n.UpdateConversation="51",n.DeleteConversation="52",n.QueryConversationList="53",n.QueryConversationHistory="54",n.CreateMessage="55",n.UpdateMessage="56",n.DeleteMessage="57",n.JsonStringify="58",n.JsonParser="59",n.VoiceToText="61",n.TextToVoice="62",n.VideoAudioExtraction="63",n.VideoFrameExtraction="64",n.VideoGeneration="65",n.MemoryWriting="66",n.MemoryRetrieval="67",n.AsyncJobCall="72",n),b={1:1,2:2,4:3,3:4,5:5,6:6,9:7,14:8,8:9,21:10,22:11,15:12,13:13,18:14,11:15,12:16,26:17,28:18,30:19,20:20,19:21,29:22,25:23,24:24,34:26,36:27,35:28},k=["39","51","52","53"],j=["55","56","57","37"],C=["54","38"],S=o("646411");(f||(f={})).DEFAULT={outputsPathList:["outputs"],inputsPathList:["inputs.inputParameters"],batchInputListPath:"inputs.batch.inputLists"};var I=((l={}).Customize="default_val",l.Creative="creative",l.Balance="balance",l.Precise="precise",l),T="response_format";var E=((s={})[s.OR=1]="OR",s[s.AND=2]="AND",s);var N=((d={}).OR="OR",d.AND="AND",d),A={[S.n$.String]:"String",[S.n$.Integer]:"Integer",[S.n$.Boolean]:"Boolean",[S.n$.Double]:"Double",[S.n$.List]:"List",[S.n$.Object]:"Object"},P={[g.$d.file]:v.Iu[v.ow.File],[g.$d.image]:v.Iu[v.ow.Image],[g.$d.doc]:v.Iu[v.ow.Doc],[g.$d.code]:v.Iu[v.ow.Code],[g.$d.ppt]:v.Iu[v.ow.Ppt],[g.$d.txt]:v.Iu[v.ow.Txt],[g.$d.excel]:v.Iu[v.ow.Excel],[g.$d.audio]:v.Iu[v.ow.Audio],[g.$d.zip]:v.Iu[v.ow.Zip],[g.$d.video]:v.Iu[v.ow.Video],[g.$d.svg]:v.Iu[v.ow.Svg]};var M=((c={}).DEFAULT="default",c.EXECUTING="executing",c.DONE="done",c)},551398:function(e,t,o){o.d(t,{Iu:function(){return s},ow:function(){return i},vH:function(){return n}});var r,i=((r={})[r.String=1]="String",r[r.Integer=2]="Integer",r[r.Boolean=3]="Boolean",r[r.Number=4]="Number",r[r.Object=6]="Object",r[r.Image=7]="Image",r[r.File=8]="File",r[r.Doc=9]="Doc",r[r.Code=10]="Code",r[r.Ppt=11]="Ppt",r[r.Txt=12]="Txt",r[r.Excel=13]="Excel",r[r.Audio=14]="Audio",r[r.Zip=15]="Zip",r[r.Video=16]="Video",r[r.Svg=17]="Svg",r[r.Voice=18]="Voice",r[r.Time=19]="Time",r[r.ArrayString=99]="ArrayString",r[r.ArrayInteger=100]="ArrayInteger",r[r.ArrayBoolean=101]="ArrayBoolean",r[r.ArrayNumber=102]="ArrayNumber",r[r.ArrayObject=103]="ArrayObject",r[r.ArrayImage=104]="ArrayImage",r[r.ArrayFile=105]="ArrayFile",r[r.ArrayDoc=106]="ArrayDoc",r[r.ArrayCode=107]="ArrayCode",r[r.ArrayPpt=108]="ArrayPpt",r[r.ArrayTxt=109]="ArrayTxt",r[r.ArrayExcel=110]="ArrayExcel",r[r.ArrayAudio=111]="ArrayAudio",r[r.ArrayZip=112]="ArrayZip",r[r.ArrayVideo=113]="ArrayVideo",r[r.ArraySvg=114]="ArraySvg",r[r.ArrayVoice=115]="ArrayVoice",r[r.ArrayTime=116]="ArrayTime",r),a=[6,99,100,101,102,103,116],n=[8,7,9,10,11,12,13,14,15,16,17,18,104,105,106,107,108,109,110,111,112,113,114,115],l=[[1,99],[2,100],[3,101],[4,102],[6,103],[7,104],[8,105],[9,106],[10,107],[11,108],[12,109],[13,110],[14,111],[15,112],[16,113],[17,114],[18,115],[19,116]],s={1:"String",2:"Integer",3:"Boolean",4:"Number",6:"Object",7:"Image",8:"File",9:"Doc",10:"Code",11:"PPT",12:"Txt",13:"Excel",14:"Audio",15:"Zip",16:"Video",17:"Svg",18:"Voice",19:"Time",99:"Array<String>",100:"Array<Integer>",101:"Array<Boolean>",102:"Array<Number>",103:"Array<Object>",104:"Array<Image>",105:"Array<File>",106:"Array<Doc>",107:"Array<Code>",108:"Array<PPT>",109:"Array<Txt>",110:"Array<Excel>",111:"Array<Audio>",112:"Array<Zip>",113:"Array<Video>",114:"Array<Svg>",115:"Array<Voice>",116:"Array<Time>"};!function(e){e.LabelMap=s,e.ArrayTypes=l.map(e=>e[1]);e.getLabel=function(t){return e.LabelMap[t]};e.getComplement=function(e){return[...l.map(e=>e[0]),...l.map(e=>e[1])].filter(t=>!e.includes(t))};e.canDrilldown=function(e){return[6,103].includes(e)};function t(e){return l.map(e=>e[1]).includes(e)}e.isImageType=function(e){return[7,104].includes(e)},e.isArrayType=t;e.isFileType=function(e){return n.includes(e)};function o(e){return a.includes(e)}e.isVoiceType=function(e){return[18].includes(e)},e.isJSONInputType=o;e.getArraySubType=function(e){var t,o=null===(t=l.find(t=>t[1]===e))||void 0===t?void 0:t[0];if(!o)throw Error("WorkflowVariableEntity Error: Unknown Variable Type");return o};e.wrapToArrayType=function(e){var t,o=null===(t=l.find(t=>t[0]===e))||void 0===t?void 0:t[1];if(!o)throw Error("WorkflowVariableEntity Error: Unknown Variable Type");return o};e.getAllArrayType=function(){return[...l.map(e=>e[0]),...l.map(e=>e[1])].filter(t)};e.getAllObjectType=function(){return[...l.map(e=>e[0]),...l.map(e=>e[1])].filter(o)}}(i||(i={}))},533512:function(e,t,o){o.d(t,{d:function(){return i}});var r=o(842197),i=()=>{var{bot_id:e}=(0,r.useParams)();return t=>{var{workflowId:o,spaceId:r,projectId:i,ideNavigate:a}=t;if(i&&a)a("/workflow/".concat(o,"?from=createSuccess"));else{var n=new URLSearchParams;e&&n.append("bot_id",e),n.append("space_id",null!=r?r:""),n.append("workflow_id",o),n.append("from","createSuccess"),window.open("/work_flow?".concat(n.toString()),"_blank")}}}},495778:function(e,t,o){o.d(t,{S:function(){return v}});var r=o(255721),i=o(341333),a=o(265489),n=o(723530),l=o(115853),s=o(192935),d=o(405510),c=o(16242),u=o(618016),p=o(182956),m=o(192073),f=o(972882);function v(){var e,t,o,{pageSize:v=20,enabled:g=!1,from:h,fetchWorkflowListApi:_=d.OHc.GetWorkFlowList.bind(d.OHc)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[x,w]=(0,n.useState)(d.wz8.All),[y,b]=(0,n.useState)(d.uql.User),[k,j]=(0,n.useState)(""),[C,S]=(0,n.useState)(),[I,T]=(0,n.useState)(),[E,N]=(0,n.useState)(),[A,P]=(0,n.useState)(),[M,R]=(0,n.useState)(),[z,Z]=(0,n.useState)(),[L,B]=(0,n.useState)(),[D,O]=(0,n.useState)(""),F=(0,n.useMemo)(()=>({page:1,size:v,type:y,name:C,space_id:k,status:I,tags:A,order_by:E,login_user_create:L,flow_mode:x,bind_biz_id:M,bind_biz_type:z,project_id:D}),[y,I,C,x,E,k,L,A,M,z,D]),W=(0,n.useCallback)(e=>{[{key:"type",func:b,defaultValue:d.uql.User},{key:"name",func:S},{key:"space_id",func:j,defaultValue:""},{key:"status",func:T},{key:"tags",func:P},{key:"order_by",func:N},{key:"login_user_create",func:B},{key:"flow_mode",func:w,defaultValue:d.wz8.All},{key:"bind_biz_id",func:R},{key:"bind_biz_type",func:Z},{key:"project_id",func:O}].filter(t=>{var{key:o}=t;return o in e}).forEach(t=>{var o,{key:r,defaultValue:i,func:a}=t;return null==a?void 0:a(null!==(o=e[r])&&void 0!==o?o:i)})},[]);var V=(e=(0,r._)(function*(e){try{m.E7.info({message:"workflow_list_get_list"});var t,o,r={total:0,workflow_list:[]};Object.assign(e,{schema_type_list:[d.XQ3.FDL],checker:h===f.w.WorkflowAgent?[d.gfc.BotAgent]:void 0});var n=e.bind_biz_type===d.k5N.DouYinBot?e:(0,l.Z)(e,["bind_biz_id"]),s=yield _(n);return r.total=null!==(t=s.data.total)&&void 0!==t?t:0,r.workflow_list=(null!==(o=s.data.workflow_list)&&void 0!==o?o:[]).map(e=>{var t,o,r={can_edit:!0,can_copy:!0,can_delete:!!(null==e?void 0:null===(t=e.creator)||void 0===t?void 0:t.self)},n=(null!==(o=s.data.auth_list)&&void 0!==o?o:[]).find(t=>t.workflow_id===e.workflow_id);return n&&(r=(0,i._)({},r,n.auth)),(0,a._)((0,i._)({},e),{authInfo:r})}),m.E7.info({message:"workflow_list_get_list_success",meta:{currentPage:e.page,pageSize:e.size,order_by:e.order_by,name:e.name,total:r.total}}),r}catch(e){throw m.E7.error({message:"workflow_list_get_list_fail",error:e}),e}}),function(t){return e.apply(this,arguments)}),{data:U,error:K,fetchNextPage:Y,hasNextPage:H,isFetching:G,isFetchingNextPage:J,status:q,refetch:X}=(0,s.N)({enabled:g&&!!k,queryKey:["space_workflow_list","vcs",JSON.stringify(F)],queryFn:e=>{var{pageParam:t}=e;return V(t)},initialPageParam:F,getNextPageParam:(e,t,o)=>{var r,n;return(null!==(r=o.page)&&void 0!==r?r:1)*v>e.total?null:(0,a._)((0,i._)({},o),{page:(null!==(n=o.page)&&void 0!==n?n:1)+1})}}),Q=(0,n.useMemo)(()=>{var e=[],t={};return null==U||U.pages.forEach(o=>{o.workflow_list.forEach(o=>{if(!!o.workflow_id)!t[o.workflow_id]&&e.push(o),t[o.workflow_id]=!0})}),e},[U]),$=(0,n.useMemo)(()=>{var e;return(null==U?void 0:U.pages)&&Array.isArray(U.pages)&&0!==U.pages.length?null!==(e=U.pages[U.pages.length-1].total)&&void 0!==e?e:0:0},[U]);var ee=(t=(0,r._)(function*(e){if(!e.workflow_id||!k)throw new u.sH("normal_error","miss workflowId or spaceID");if(!e.authInfo.can_copy)throw new u.sH("normal_error","no copy permission");m.E7.info({message:"workflow_list_copy_row",meta:{workflowId:e.workflow_id}});try{var t=!1,{data:o}=yield d.OHc.CopyWorkflow({space_id:k,workflow_id:e.workflow_id});if(t=!(null==o?void 0:o.workflow_id)){p.Toast.error(c.o.t("workflow_detail_toast_createcopy_failed")),m.E7.error({message:"workflow_list_copy_row_fail",error:new u.sH("normal_error","result no workflow")});return}p.Toast.success({content:x===d.wz8.Imageflow?c.o.t("imageflow_detail_toast_createcopy_succeed"):c.o.t("workflow_detail_toast_createcopy_succeed"),showClose:!1}),m.E7.info({message:"workflow_list_copy_row_success",meta:{workflowId:e.workflow_id}}),yield(0,m.Dc)(300),X()}catch(e){m.E7.error({message:"workflow_list_copy_row_fail",error:e}),p.Toast.error(c.o.t("workflow_detail_toast_createcopy_failed"))}}),function(e){return t.apply(this,arguments)});var et=(o=(0,r._)(function*(e){if(!e.workflow_id||!k)throw new u.sH("normal_error","miss workflowId or spaceID");if(!e.authInfo.can_delete)throw new u.sH("normal_error","no delete permission");m.E7.info({message:"workflow_list_delete_row",meta:{workflowId:e.workflow_id}});var t,o=d.KN6.CanDelete;o=(yield d.OHc.GetDeleteStrategy({space_id:k,workflow_id:e.workflow_id})).data;var i=[d.KN6.CanDelete,d.KN6.RejectProductDraft].includes(o);var a=(t=(0,r._)(function*(t){var o=(null==t?void 0:t.needDeleteBlockwise)?d.sL0.BlockwiseDelete:d.sL0.BlockwiseUnbind;if(!e.workflow_id||!k)throw new u.sH("normal_error","miss workflowId or spaceID");try{yield d.OHc.DeleteWorkflow({space_id:k,workflow_id:e.workflow_id,action:o}),p.Toast.success({content:c.o.t("workflow_add_delete_success"),showClose:!1}),m.E7.info({message:"workflow_list_delete_row_success"}),yield(0,m.Dc)(300),X()}catch(e){m.E7.error({message:"workflow_list_delete_row_fail",error:e}),p.Toast.error({content:c.o.t("workflow_add_delete_fail"),showClose:!1})}}),function(e){return t.apply(this,arguments)});return{canDelete:i,deleteType:o,handleDelete:i?a:void 0}}),function(e){return o.apply(this,arguments)});return{flowType:y,setFlowType:b,flowMode:x,setFlowMode:w,spaceId:k,setSpaceId:j,status:I,setStatus:T,name:C,setName:S,tags:A,setTags:P,orderBy:E,setOrderBy:N,loginUserCreate:L,setLoginUserCreate:B,updatePageParam:W,workflowList:Q,total:$,queryError:K,fetchNextPage:Y,hasNextPage:H,isFetching:G,isFetchingNextPage:J,loadingStatus:q,refetch:X,handleCopy:ee,handleDelete:et}}},374370:function(e,t,o){o.d(t,{Ax:()=>eN,dn:()=>b.d,qz:()=>h,qN:()=>tX.qN,tk:()=>tX.tk,R0:()=>eW,HA:()=>eL,AC:()=>eD,tm:()=>tJ,pJ:()=>S.pJ,Zv:()=>eY,N0:()=>tX.N0,md:()=>eK.md,Do:()=>eK.Do,UF:()=>e_,Zo:()=>eB,tf:()=>eu,BD:()=>eK.BD,wL:()=>eK.wL,wC:()=>tX.wC,ye:()=>eK.ye,CA:()=>e9,ml:()=>tX.ml,sd:()=>tX.sd,pG:()=>tX.pG,Nd:()=>ec,U8:()=>eZ,wj:()=>e4,R3:()=>tq,ds:()=>tU.d,oh:()=>tV,A2:()=>tj,Mz:()=>eH.Z,gE:()=>S.gE,nN:()=>tX.nN,tF:()=>eC,RM:()=>tX.RM,ub:()=>tW,xv:()=>e7});var r,i,a,n,l,s,d,c,u,p,m,f,v,g,h,_,x,w,y,b=o("13904"),k=o("938809"),j=o("723530"),C=o("16242");o("765946");var S=o("192073");/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent);var I=o("866466"),T=o.n(I),E=o("462669"),N=o.n(E),A=o("318249"),P=o.n(A),M=o("294754"),R=o.n(M),z=o("13355"),Z=o.n(z),L=o("876846"),B=o.n(L),D=o("30131"),O={};O.styleTagTransform=B(),O.setAttributes=R(),O.insert=P().bind(null,"head"),O.domAPI=N(),O.insertStyleElement=Z(),T()(D.Z,O),D.Z&&D.Z.locals&&D.Z.locals,(0,S.mk)();var F=o("856306"),W=o.n(F),V=o("967756"),U=o("142969"),K=o("889707"),Y=o("988726"),H=o("182956"),G=o("255721"),J=o("341333"),q=o("265489"),X=o("192935"),Q=o("405510"),$=o("718647"),ee=o.n($),et=o("114798"),eo=o.n(et),{Text:er}=H.Typography,ei=e=>{var t,o,{className:r,data:i,readonly:a,isActive:n,hiddenActionMenu:l,enablePublishPPE:s,onClick:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,hideCommitId:m,hideViewCommit:f,actions:v}=e,g=l?null:(0,k.jsx)(H.Menu,{className:"min-w-[96px] mb-2px flex-shrink-0",trigger:"hover",stopPropagation:!0,position:"bottomRight",render:(0,k.jsxs)(H.Menu.SubMenu,{mode:"menu",children:[f?null:(0,k.jsx)(H.Menu.Item,{onClick:(e,t)=>{t.stopPropagation(),null==p||p(i)},children:C.o.t("bmv_view_version")}),(0,k.jsx)(H.Menu.Item,{onClick:(e,t)=>{t.stopPropagation(),null==u||u(i)},children:C.o.t("bmv_load_to_draft")}),s?(0,k.jsx)(H.Menu.Item,{onClick:(e,t)=>{t.stopPropagation(),null==c||c(i)},children:C.o.t("bmv_pre_release_to_lane")}):null,null==v?void 0:v.map(e=>e.renderMenuItem(i))]}),children:(0,k.jsx)(H.IconButton,{color:"secondary",iconSize:"small",icon:(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(Y.NsR,{className:"rotate-90"})})})}),h=(0,j.useMemo)(()=>i.create_time?eo()(i.create_time).format("YYYY-MM-DD HH:mm:ss"):"",[i]);return(0,k.jsxs)("div",{className:W()("commit-item",n&&"active","p-2 rounded-mini",n&&"coz-mg-hglt",!a&&!n&&"hover:coz-mg-secondary",!a&&"cursor-pointer",r),onClick:()=>null==d?void 0:d(i),children:[(0,k.jsxs)("div",{className:"mb-2",children:[i.type===Q.lcl.SubmitOperate&&(0,k.jsx)(H.Tag,{size:"small",children:C.o.t("workflow_publish_multibranch_submitted_title")}),i.type===Q.lcl.PubPPEOperate&&(0,k.jsx)(H.Tag,{size:"small",color:i.offline?"primary":"green",children:i.env}),i.type===Q.lcl.PublishOperate&&(0,k.jsx)(H.Tag,{size:"small",color:i.offline?"primary":"green",children:ee().valid(i.version)?i.version:C.o.t("bmv_official_version")})]}),!m&&(0,k.jsxs)(H.Space,{className:"w-full items-start",vertical:!0,spacing:4,children:[(0,k.jsxs)(er,{ellipsis:{showTooltip:{opts:{content:i.submit_commit_id||i.commit_id}}},children:[(0,k.jsxs)("span",{className:"font-bold mr-2",children:[C.o.t("bmv_submit_id"),":"]}),i.submit_commit_id||i.commit_id]}),i.type!==Q.lcl.SubmitOperate&&i.offline&&i.update_time?(0,k.jsxs)(er,{ellipsis:{showTooltip:{opts:{content:eo()(i.update_time).format("YYYY-MM-DD HH:mm")}}},children:[(0,k.jsxs)("span",{className:"font-bold mr-2",children:[C.o.t("bmv_offline_time"),":"]}),eo()(i.update_time).format("YYYY-MM-DD HH:mm")]}):null]}),i.type===Q.lcl.PublishOperate&&i.desc?(0,k.jsx)("div",{children:(0,k.jsx)(er,{ellipsis:{rows:4,showTooltip:!0},children:i.desc})}):null,(0,k.jsxs)("div",{className:"flex items-end mt-2",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"min-w-0 flex items-center mb-1",children:[(0,k.jsx)(H.Avatar,{className:"mr-2 flex-shrink-0",size:"extra-extra-small",src:null===(t=i.user)||void 0===t?void 0:t.user_avatar,alt:"avatar"}),(0,k.jsx)(er,{ellipsis:!0,fontSize:"12px",children:null===(o=i.user)||void 0===o?void 0:o.user_name})]}),(0,k.jsx)(er,{type:"secondary",fontSize:"12px",children:h})]}),(0,k.jsx)("div",{className:"flex-1"}),g]})]})},ea=o("703259"),en={};en.styleTagTransform=B(),en.setAttributes=R(),en.insert=P().bind(null,"head"),en.domAPI=N(),en.insertStyleElement=Z(),T()(ea.Z,en);var el=ea.Z&&ea.Z.locals?ea.Z.locals:void 0,{Text:es}=H.Typography,ed="current",ec=Object.assign((0,K._Uw)(e=>{var{className:t,spaceId:o,value:r,workflowId:i,readonly:a,type:n,enablePublishPPE:l,showCurrent:s,onItemClick:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,onCurrentClick:m,hideCommitId:f,hideViewCommit:v,actions:g}=e,{queryParams:h,updatePageParam:_,list:x,loadingStatus:w,fetchNextPage:y,isFetching:b,hasNextPage:S}=function(e){var t,{spaceId:o,workflowId:r,type:i,pageSize:a=10,enabled:n=!1}=e,[l,s]=(0,j.useState)({space_id:o,workflow_id:r,type:i}),d=(0,j.useMemo)(()=>(0,q._)((0,J._)({},l),{limit:a,last_commit_id:""}),[l,a]),c=(0,j.useCallback)(e=>{s(t=>(0,J._)({},t,e))},[]),u=(0,j.useMemo)(()=>["workflowApi_OperateList",JSON.stringify(d)],[d]);var p=(t=(0,G._)(function*(e){return(yield Q.OHc.VersionHistoryList(e)).data}),function(e){return t.apply(this,arguments)}),{data:m,error:f,fetchNextPage:v,hasNextPage:g,isFetching:h,isFetchingNextPage:_,status:x,refetch:w}=(0,X.N)({enabled:!!(o&&r&&n),queryKey:u,queryFn:e=>{var{pageParam:t}=e;return p(t)},initialPageParam:d,getNextPageParam:(e,t,o)=>(null==e?void 0:e.has_more)?(0,q._)((0,J._)({},o),{cursor:e.cursor||""}):null});return{queryParams:l,updatePageParam:c,list:(0,j.useMemo)(()=>{var e=[],t={};return null==m||m.pages.forEach(o=>{var r;null==o||null===(r=o.version_list)||void 0===r||r.forEach(o=>{var r=o.commit_id||"";!t[r]&&e.push(o),t[r]=!0})}),e},[m]),queryError:f,loadingStatus:x,refetch:w,fetchNextPage:v,isFetching:h,isFetchingNextPage:_,hasNextPage:g}}({spaceId:o,workflowId:i,type:n,enabled:!0}),I=(0,j.useRef)(null),T=(0,j.useRef)(null),[E]=(0,V.Z)(T,{root:()=>I.current,threshold:.8});if((0,j.useEffect)(()=>{_({type:n})},[n,_]),(0,U.Z)(()=>{I.current&&I.current.scrollTo({top:0})},[h]),(0,j.useEffect)(()=>{if(!!E&&"success"===w&&!b&&!!S)y()},[E,w,b,S]),"error"===w)return(0,k.jsx)("div",{className:"flex justify-center items-center min-h-[300px] w-full",children:(0,k.jsx)(H.EmptyState,{title:"An error occurred",description:"Please try again later"})});if("pending"===w)return(0,k.jsx)(H.Spin,{wrapperClassName:"flex justify-center items-center min-h-[300px] w-full"});if("success"===w&&!x.length&&!s)return(0,k.jsx)("div",{className:"flex justify-center items-center min-h-[300px] w-full",children:(0,k.jsx)(H.EmptyState,{title:C.o.t("query_data_empty"),description:C.o.t("bwc_no_version_record")})});var N=(e,t)=>n===K.lcl.PubPPEOperate?e.offline?"default":"ongoing":0===t?"ongoing":"default";return(0,k.jsxs)("div",{ref:I,className:t,children:[(0,k.jsxs)(H.Timeline,{children:[s?(0,k.jsx)(H.Timeline.Item,{className:el["history-item"],type:"warning",dot:r===ed?(0,k.jsx)(Y.Ph$,{}):void 0,children:(0,k.jsx)("div",{className:W()("relative top-[-8px] p-2 rounded-mini",r===ed?"coz-mg-hglt":"hover:coz-mg-secondary",!a&&"cursor-pointer"),onClick:()=>null==m?void 0:m(ed),children:(0,k.jsx)(es,{className:"font-bold",children:C.o.t("devops_publish_multibranch_Current")})})}):null,x.map((e,t)=>(0,k.jsx)(H.Timeline.Item,{className:el["history-item"],type:N(e,t),dot:r===e.commit_id?(0,k.jsx)(Y.Ph$,{}):void 0,children:(0,k.jsx)(ei,{className:"relative top-[-8px]",data:e,readonly:a,isActive:r===e.commit_id,enablePublishPPE:l,onClick:a?void 0:d,onPublishPPE:c,onResetToCommit:u,onShowCommit:p,hideCommitId:f,hideViewCommit:v,actions:g})},e.commit_id))]}),S?(0,k.jsxs)("div",{className:"flex justify-center py-1",ref:T,children:[(0,k.jsx)(H.Spin,{spinning:!0,wrapperClassName:"mr-2"}),(0,k.jsx)("div",{className:"coz-fg-primary",children:C.o.t("Loading")})]}):null]})}),{Item:ei});var eu=((r={}).Change="change",r.Select="select",r.Dispose="dispose",r.CompositionStart="compositionStart",r);var ep=((i={}).Start="{",i.End="}",i.FullStart="{{",i.FullEnd="}}",i.Separator=".",i.ArrayStart="[",i.ArrayEnd="]",i);var em=((a={}).ObjectKey="object_key",a.ArrayIndex="array_index",a.EndEmpty="end_empty",a);var ef=((n={}).Line="paragraph",n.Valid="valid",n.Invalid="invalid",n.SelectedValid="selectedValid",n.SelectedInvalid="selectedInvalid",n),ev=o("275538"),eg={};eg.styleTagTransform=B(),eg.setAttributes=R(),eg.insert=P().bind(null,"head"),eg.domAPI=N(),eg.insertStyleElement=Z(),T()(ev.Z,eg);var eh=ev.Z&&ev.Z.locals?ev.Z.locals:void 0,e_=e=>{var{className:t,model:o,maxLength:r,disabled:i,isError:a}=e,{visible:n,count:l,max:s}=(0,j.useMemo)(()=>"number"!=typeof o.value.length||"number"!=typeof r?{visible:!1}:{visible:!0,count:o.value.length,max:r},[o.value.length,r]);return i||!n?(0,k.jsx)(k.Fragment,{}):(0,k.jsx)("div",{className:W()(eh["expression-editor-counter"],t,{[eh["expression-editor-counter-error"]]:a}),children:(0,k.jsxs)("p",{children:[l," / ",s]})})},ex={[ef.Valid]:{color:"#6675D9"},[ef.Invalid]:{color:"inherit"},[ef.SelectedValid]:{color:"#6675D9",borderRadius:2,backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"},[ef.SelectedInvalid]:{color:"inherit",borderRadius:2,backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"}},ew=e=>{var{type:t}=e.leaf;return(0,k.jsx)("span",(0,q._)((0,J._)({style:t&&ex[t]},e.attributes),{children:e.children}))},ey=o("390640"),eb=o("470946"),ek={};ek.styleTagTransform=B(),ek.setAttributes=R(),ek.insert=P().bind(null,"head"),ek.domAPI=N(),ek.insertStyleElement=Z(),T()(eb.Z,ek);var ej=eb.Z&&eb.Z.locals?eb.Z.locals:void 0,eC=e=>{var{model:t,className:o,placeholder:r,onFocus:i,onBlur:a,readonly:n=!1,dataTestID:l}=e;return(0,k.jsx)("div",{className:o,children:(0,k.jsx)(ey.mH,{editor:t.editor,initialValue:t.lines,onChange:e=>{var o;(o=(0,G._)(function*(){t.change(e),t.select(e)}),function(){return o.apply(this,arguments)})()},children:(0,k.jsx)(ey.CX,{"data-testid":l,className:W()(ej.slateEditable,"flow-canvas-not-draggable"),"data-flow-editor-selectable":"false",readOnly:n,onFocus:i,onBlur:a,placeholder:r,renderLeaf:ew,decorate:t.decorate,onKeyDown:e=>t.keydown(e),onCompositionStart:e=>t.compositionStart(e)})})})},eS=o("168074");var eI=((l={}).SetInitialized="set_initialized",l.Refresh="refresh",l.SetParseDataAndEditorPath="set_parse_data_and_editor_path",l.ClearParseDataAndEditorPath="clear_parse_data_and_editor_path",l.SetVariableTree="set_variable_tree",l.SetVisible="set_visible",l.SetAllowVisibleChange="set_allow_visible_change",l.SetHiddenDOM="set_hidden_dom",l.SetRect="set_rect",l.SetSelected="set_selected",l.SetEmptyContent="set_empty_content",l.SetMatchTreeBranch="set_match_tree_branch",l.SearchEffectStart="search_effect_start",l.SearchEffectEnd="search_effect_end",l.FilteredEffectStart="filtered_effect_start",l.FilteredEffectEnd="filtered_effect_end",l),eT=(e,t)=>(0,J._)((0,q._)((0,J._)({},e),{version:e.version+1}),t),eE=(e,t)=>{if(t.type===eI.SetInitialized)return eT(e,{initialized:!0});if(t.type===eI.Refresh)return eT(e,{key:e.key+1});if(t.type===eI.SetParseDataAndEditorPath){var{parseData:o,editorPath:r}=t.payload||{};return eT(e,{parseData:o,editorPath:r})}if(t.type===eI.ClearParseDataAndEditorPath)return eT(e,{parseData:void 0,editorPath:void 0});if(t.type===eI.SetVariableTree)return eT(e,{variableTree:t.payload});if(t.type===eI.SetAllowVisibleChange)return eT(e,{allowVisibleChange:t.payload});if(t.type===eI.SetVisible&&e.allowVisibleChange){var i=t.payload;return e.entities.selectorBoxConfig&&(i&&(e.entities.selectorBoxConfig.disabled=!0),!i&&(e.entities.selectorBoxConfig.disabled=!1)),eT(e,{visible:i})}return t.type===eI.SetHiddenDOM?eT(e,{hiddenDOM:t.payload}):t.type===eI.SetRect?eT(e,{rect:t.payload}):t.type===eI.SetSelected?eT(e,{selected:t.payload}):t.type===eI.SetEmptyContent?eT(e,{emptyContent:t.payload}):t.type===eI.SetMatchTreeBranch?eT(e,{matchTreeBranch:t.payload}):t.type===eI.SearchEffectStart?eT(e,{renderEffect:(0,q._)((0,J._)({},e.renderEffect),{search:!0})}):t.type===eI.SearchEffectEnd?eT(e,{renderEffect:(0,q._)((0,J._)({},e.renderEffect),{search:!1})}):t.type===eI.FilteredEffectStart?eT(e,{renderEffect:(0,q._)((0,J._)({},e.renderEffect),{filtered:!0})}):t.type===eI.FilteredEffectEnd?eT(e,{renderEffect:(0,q._)((0,J._)({},e.renderEffect),{filtered:!1})}):e},eN=e=>{var[t,o]=(0,j.useReducer)(eE,(0,q._)((0,J._)({},e),{initialized:!1,version:0,key:0,variableTree:[],visible:!0,hiddenDOM:!0,allowVisibleChange:!0,renderEffect:{search:!1,filtered:!1}}));return[t,o]},eA=o("476699"),eP=o("911379");s=h||(h={}),d=e=>{var t,{variables:o,input:r}=e;if(!r.keyPath)return{name:r.name};var i=r.keyPath.shift(),a=r.keyPath,n=o.filter(e=>e.nodeId===i);return(a.reduce((e,o,r)=>{var i=e.find(e=>e.key===o);return(r===a.length-1&&(t=i),i&&i.children)?i.children:[]},n),t)?{name:r.name,keyPath:r.keyPath,variable:t}:{name:r.name}},s.findAvailableVariables=e=>{var{variables:t,inputs:o}=e;return o.map(e=>{var o,r=d({input:e,variables:t});return(null===(o=e.children)||void 0===o?void 0:o.length)&&(r.children=s.findAvailableVariables({variables:t,inputs:e.children||[]})),r})},c=(e,t)=>e.map(e=>{var o={label:e.name,value:"".concat(t.value,".").concat(e.key),key:"".concat(t.value,".").concat(e.key),variable:e,parent:t};return o.children=c(e.children||[],o),o}),s.createVariableTree=(e,t)=>e.map(e=>{var o,r,i,a=t?"".concat(t.key,".").concat(e.name):e.name,n={label:e.name,value:(null===(o=e.keyPath)||void 0===o?void 0:o.join("."))||a,key:a,keyPath:e.keyPath,variable:e.variable,parent:t};return(null===(r=e.children)||void 0===r?void 0:r.length)?n.children=s.createVariableTree(e.children,n):n.children=c((null===(i=e.variable)||void 0===i?void 0:i.children)||[],n),n}),s.pruning=e=>{var{tree:t,segments:o}=e;if(0===o.length)return t;var r=o[o.length-1].type===em.ArrayIndex?o.slice(0,o.length-2):o.slice(0,o.length-1),i=t;return r.forEach(e=>{if(e.type===em.ObjectKey){var t=i.find(t=>t.label===e.objectKey);i=t&&t.children||[]}}),i},s.concatFullPath=e=>{for(var t,{node:o,segments:r}=e,i=o,a=[];i;)(null===(t=i.variable)||void 0===t?void 0:t.type)===eP.ow.ArrayObject?a.unshift({objectKey:i.label,arrayIndex:0}):a.unshift({objectKey:i.label}),i=i.parent;var n=0;return r.find((e,t)=>{if(e.type!==em.ObjectKey)return!1;var o=a[n];if(n++,o.objectKey!==e.objectKey)return!0;var i=r[t+1];return"number"==typeof o.arrayIndex&&(null==i?void 0:i.type)===em.ArrayIndex&&(o.arrayIndex=i.arrayIndex),!1}),a.map((e,t)=>{var o=t===a.length-1;return"number"!=typeof e.arrayIndex||o?e.objectKey:"".concat(e.objectKey,"[").concat(e.arrayIndex,"]")}).join(".")},s.matchTreeBranch=e=>{var{tree:t,segments:o}=e,r=[],i=t,a=o.find((e,t)=>{var o,a=()=>(r.push(null),!0),n=e=>(r.push(e||null),!1),l=r[r.length-1];if(e.type===em.ArrayIndex&&l&&(!l.variable||!eP.ow.isArrayType(l.variable.type))||(null==l?void 0:null===(o=l.variable)||void 0===o?void 0:o.type)&&eP.ow.isArrayType(l.variable.type)&&e.type!==em.ArrayIndex)return a();if(e.type!==em.ObjectKey)return n();var s=i.find(t=>t.label===e.objectKey);return s?(i=s.children||[],n(s)):a()}),n=r.filter(Boolean),l=o.filter(e=>e.type===em.ObjectKey);if(!a&&l.length===n.length)return n},(u=_||(_={})).tokenOffset=e=>{var{lineContent:t,lineOffset:o}=e,r=t.indexOf(ep.End,o);if(t.slice(r,r+2)!==ep.FullEnd)return;var i=t.lastIndexOf(ep.Start,o-1);if(t.slice(i-1,i+1)===ep.FullStart)return{lastStartTokenOffset:i,firstEndTokenOffset:r}},u.extractContent=e=>{var{lineContent:t,lineOffset:o,lastStartTokenOffset:r,firstEndTokenOffset:i}=e,a=t.slice(r+1,i);return{content:a,offset:o-r-1}},u.sliceReachable=e=>{var{content:t,offset:o}=e,r=t.slice(0,o);return{reachable:r,unreachable:t.slice(o,t.length)}},u.splitText=e=>{var t=e.split(ep.Separator),o=[];return t.forEach(e=>{if(!e.match(/\[\d+\]/)){o.push(e);return}var t=e.lastIndexOf(ep.ArrayStart),r=e.substring(0,t),i=e.substring(t);o.push(r),o.push(i)}),o},u.toSegments=e=>{var t=u.splitText(e),o=[];if(!!t.every((e,r)=>{if(e.startsWith(ep.ArrayStart)&&e.endsWith(ep.ArrayEnd)){var i=e.slice(1,-1),a=Number(i);if(""===i||Number.isNaN(a))return!1;var n=o[o.length-1];if(!n||n.type!==em.ObjectKey)return!1;o.push({type:em.ArrayIndex,index:r,arrayIndex:a})}else if(r===t.length-1&&""===e)o.push({type:em.EndEmpty,index:r});else{if(!e||!/^[\u4e00-\u9fa5_a-zA-Z0-9]*$/.test(e))return!1;o.push({type:em.ObjectKey,index:r,objectKey:e})}return!0}))return o},(p=x||(x={})).serialize=e=>e.map(e=>eA.NB.string(e)).join("\n"),p.deserialize=e=>e.split("\n").map(e=>({type:ef.Line,children:[{text:e||""}]})),p.parse=e=>{var{lineContent:t,lineOffset:o}=e,r=_.tokenOffset(e);if(!r)return;var{lastStartTokenOffset:i,firstEndTokenOffset:a}=r,n=_.extractContent((0,J._)({},e,r));if(!n)return;var{content:l,offset:s}=n,d=_.sliceReachable(n);if(!d)return;var c=_.toSegments(d.reachable),u=_.toSegments(l);if(!!c)return{content:{line:t,inline:l,reachable:d.reachable,unreachable:d.unreachable},offset:{line:o,inline:s,lastStart:i,firstEnd:a},segments:{inline:u,reachable:c}}};var eM=o("728348"),eR={};eR.styleTagTransform=B(),eR.setAttributes=R(),eR.insert=P().bind(null,"head"),eR.domAPI=N(),eR.insertStyleElement=Z(),T()(eM.Z,eR);var ez=eM.Z&&eM.Z.locals?eM.Z.locals:void 0;(m=w||(w={})).editorSelectHandler=e=>{var{reducer:t,payload:o}=e,[r,i]=t,a=x.parse({lineContent:o.content,lineOffset:o.offset});if(!a){i({type:eI.ClearParseDataAndEditorPath}),i({type:eI.SetVisible,payload:!1}),i({type:eI.SetRect,payload:void 0});return}i({type:eI.SetParseDataAndEditorPath,payload:{parseData:a,editorPath:o.path}}),""===a.content.reachable&&i({type:eI.Refresh});var n=m.computeSelected({model:r.model,parseData:a});i({type:eI.SetSelected,payload:n});var l=m.computeVariableTree({model:r.model,parseData:a});i({type:eI.SetVariableTree,payload:l});var s=h.matchTreeBranch({tree:r.model.variableTree,segments:a.segments.reachable});i({type:eI.SetMatchTreeBranch,payload:s});var d=m.computeEmptyContent({parseData:a,fullVariableTree:r.model.variableTree,variableTree:l,matchTreeBranch:s});i({type:eI.SetEmptyContent,payload:d});var c=m.computeRect(r);if(i({type:eI.SetRect,payload:c}),!c){i({type:eI.ClearParseDataAndEditorPath});return}!r.ref.tree.current&&i({type:eI.SetVisible,payload:!0}),i({type:eI.SearchEffectStart})},m.getFinalScale=e=>e.entities.playgroundConfig?e.entities.playgroundConfig.finalScale:1,m.computeRect=e=>{var t,o=null===(t=e.ref.container.current)||void 0===t?void 0:t.getBoundingClientRect();if(!!e.model.editor.selection&&!!o)try{var r=ey.F3.toDOMRange(e.model.editor,e.model.editor.selection).getBoundingClientRect();return{top:(r.top-o.top)/m.getFinalScale(e)+5,left:(r.left-o.left)/m.getFinalScale(e)}}catch(e){return}},m.computeSelected=e=>{var{model:t,parseData:o}=e;if(!(null==o?void 0:o.segments.inline))return;var r=h.matchTreeBranch({tree:t.variableTree,segments:o.segments.inline});if(!!r)return r[r.length-1]},m.computeSearch=e=>{if(!e)return"";var t=e.segments.reachable,o=t[t.length-1].type===em.ArrayIndex?t[t.length-2]:t[t.length-1];return o&&o.type===em.ObjectKey?o.objectKey:""},m.computeVariableTree=e=>{var{model:t,parseData:o}=e;return(null==o?void 0:o.segments.reachable)?h.pruning({tree:t.variableTree,segments:o.segments.reachable}):[]},m.computeEmptyContent=e=>{var{parseData:t,fullVariableTree:o,variableTree:r,matchTreeBranch:i}=e;if(!o||!Array.isArray(o)||0===o.length)return""===t.content.reachable?C.o.t("workflow_variable_refer_no_input"):void 0;if(!r||!Array.isArray(r)||0===r.length){if(""===t.content.inline)return C.o.t("workflow_variable_refer_no_input");if(i&&0!==i.length)return C.o.t("workflow_variable_refer_no_sub_variable")}},m.keyboardSelectedClassName=()=>ez["expression-editor-suggestion-keyboard-selected"],m.setUIOptionSelected=e=>{var t,o;if(!(!(null==e?void 0:null===(t=e.classList)||void 0===t?void 0:t.add)||!(null==e?void 0:null===(o=e.classList)||void 0===o?void 0:o.contains)||e.classList.contains("semi-tree-option-empty")))e.classList.add(m.keyboardSelectedClassName())},m.computeUIOptions=e=>{var t,o,r,i,a,n=null===(a=e.ref.suggestion.current)||void 0===a?void 0:null===(i=a.children)||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:null===(o=r.children)||void 0===o?void 0:null===(t=o[1])||void 0===t?void 0:t.children;if(!!n){var l=Array.from(n),s=l.findIndex(e=>e.classList.contains(m.keyboardSelectedClassName()));return{optionList:l,selectedIndex:s,selectedOption:l[s]}}},m.preventVisibleJitter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,[o,r]=e;if(!!o.allowVisibleChange)r({type:eI.SetAllowVisibleChange,payload:!1}),setTimeout(()=>{r({type:eI.SetAllowVisibleChange,payload:!0})},t)},m.clearSelectedUIOption=e=>{var t=m.computeUIOptions(e);(null==t?void 0:t.selectedOption)&&t.selectedOption.classList.remove(m.keyboardSelectedClassName())},m.selectFirstUIOption=e=>{var t,o,r,i=m.computeUIOptions(e);if(!(null==i?void 0:i.optionList))return;if(m.clearSelectedUIOption(e),!!(null==i?void 0:null===(r=i.optionList)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:null===(t=o.classList)||void 0===t?void 0:t.add))m.setUIOptionSelected(i.optionList[0])};var eZ=e=>{var[t]=e;return(0,j.useCallback)(e=>{var o,r,i=h.concatFullPath({node:e,segments:null!==(r=null===(o=t.parseData)||void 0===o?void 0:o.segments.reachable)&&void 0!==r?r:[]});if(!!t.parseData&&!!t.editorPath){var a={anchor:{path:t.editorPath,offset:t.parseData.offset.lastStart-1},focus:{path:t.editorPath,offset:t.parseData.offset.firstEnd+2}},n="".concat(ep.FullStart).concat(i).concat(ep.FullEnd);eA.YR.insertText(t.model.editor,n,{at:a})}},[t])},eL=e=>{var[t,o]=e;(0,j.useEffect)(()=>{var e=e=>{var r;if(!(!t.visible||!t.ref.suggestion.current||(null===(r=t.ref.suggestion.current)||void 0===r?void 0:r.contains(e.target))))o({type:eI.SetVisible,payload:!1}),o({type:eI.SetRect,payload:void 0})};window.addEventListener("mousedown",e);var r=()=>{window.removeEventListener("mousedown",e)};return()=>{r()}},[t]),(0,j.useEffect)(()=>{var o=t.model.on(eu.Select,t=>w.editorSelectHandler({reducer:e,payload:t}));return()=>{o()}},[]),(0,j.useEffect)(()=>{var e=t.model.on(eu.CompositionStart,e=>o({type:eI.SetVisible,payload:!1}));return()=>{e()}},[]),(0,j.useEffect)(()=>{if(!t.initialized)o({type:eI.SetVisible,payload:!1})},[]),(0,j.useEffect)(()=>{if(!t.initialized&&!t.visible)o({type:eI.SetHiddenDOM,payload:!1}),o({type:eI.SetInitialized})},[t])},eB=(e,t)=>{var[o,r]=e;(0,j.useEffect)(()=>{var e=e=>{if(!o.visible||!o.ref.suggestion.current||!["ArrowDown","ArrowUp"].includes(e.key))return;var t=w.computeUIOptions(o);if(!t)return;var{optionList:r,selectedIndex:i}=t;if(1!==r.length){e.preventDefault();var a=i;"ArrowDown"===e.key?a=-1===i||i===r.length-1?0:i+1:"ArrowUp"===e.key&&(a=i<=0?r.length-1:i-1);var n=r[a];-1!==i&&r[i].classList.remove(w.keyboardSelectedClassName()),w.setUIOptionSelected(n),n.scrollIntoView({behavior:"smooth",block:"nearest"})}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o]),(0,j.useEffect)(()=>{var i=i=>{if(!o.visible||!o.ref.suggestion.current||"Enter"!==i.key)return;var a,n,l,s,d,c,u=w.computeUIOptions(o);if(!(null==u?void 0:u.selectedOption))return;var{selectedOption:p}=u,m=p.getAttribute("data-key");if(!m)return;var f=null===(s=o.ref.tree.current)||void 0===s?void 0:null===(l=s.state)||void 0===l?void 0:null===(n=l.keyEntities)||void 0===n?void 0:null===(a=n[m])||void 0===a?void 0:a.data;if(!f)return;if(i.preventDefault(),r({type:eI.SetVisible,payload:!1}),t(f),!!(null===(d=f.variable)||void 0===d?void 0:d.children)&&(null===(c=f.variable)||void 0===c?void 0:c.children.length)!==0){var{selection:v}=o.model.editor;v&&eA.e6.isCollapsed(v)&&eA.YR.move(o.model.editor,{distance:2,reverse:!0}),w.preventVisibleJitter(e)}};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[o]),(0,j.useEffect)(()=>{var e=e=>{if(!!o.visible&&!!o.ref.suggestion.current&&"Escape"===e.key)e.preventDefault(),r({type:eI.SetVisible,payload:!1})};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o]),(0,j.useEffect)(()=>{w.selectFirstUIOption(o)},[o])},eD=e=>{var[t,o]=e;(0,j.useEffect)(()=>{if(!!t.renderEffect.search&&!!t.parseData){o({type:eI.SearchEffectEnd});var e,r=w.computeSearch(t.parseData);if(null===(e=t.ref.tree.current)||void 0===e||e.search(r),!r&&t.matchTreeBranch){o({type:eI.SetVisible,payload:!0});return}o({type:eI.FilteredEffectStart})}},[t]),(0,j.useEffect)(()=>{if(!!t.renderEffect.filtered){o({type:eI.FilteredEffectEnd});var e,r=Array.from((null===(e=t.ref.tree.current)||void 0===e?void 0:e.state.filteredKeys)||[]);if(!t.emptyContent&&0===r.length){o({type:eI.SetVisible,payload:!1});return}o({type:eI.SetVisible,payload:!0})}},[t])},eO=o("532737"),eF=o("707567");(f=y||(y={})).findPatterns=e=>{for(var t,o=[],r=/{{(.*?)}}/g;null!==(t=r.exec(e));){var i=t.index,a=r.lastIndex,n=t[1];o.push({start:i,end:a,content:n})}return o},v=e=>{var{pattern:t,tree:o}=e,r=_.toSegments(t.content);return r?r[r.length-1].type===em.EndEmpty?{start:t.start,end:t.end,valid:!1,message:"empty with empty"}:h.matchTreeBranch({tree:o,segments:r})?{start:t.start,end:t.end,valid:!0}:{start:t.start,end:t.end,valid:!1,message:"no match variable path"}:{start:t.start,end:t.end,valid:!1,message:"invalid variable path"}},f.lineTextValidate=e=>{var{lineText:t,tree:o}=e;return f.findPatterns(t).map(e=>v({pattern:e,tree:o}))},f.validate=e=>{var{lines:t,tree:o}=e;return t.map(e=>eA.NB.string(e)).map((e,t)=>f.lineTextValidate({lineText:e,tree:o})).flat()};class eW{setVariableTree(e){this.innerVariableTree=e}get variableTree(){return this.innerVariableTree}get lines(){return this.innerLines}get value(){return this.innerValue}setValue(e){if(e!==this.innerValue)this.innerValue=e,this.innerLines=x.deserialize(e),this.syncEditorValue()}setFocus(e){if(this.innerFocus!==e)this.innerFocus=e,e?this.select(this.lines):""!==this.innerValue&&0!==this.editor.children.length&&eA.YR.select(this.editor,eA.ML.start(this.editor,[]))}on(e,t){return this.emitter.on(e,t),()=>{this.emitter.off(e,t)}}change(e){if(!!this.editor.operations.some(e=>"set_selection"!==e.type))this.innerLines=e,this.innerValue=x.serialize(e),this.emitter.emit(eu.Change,{lines:e,value:this.innerValue})}select(e){var{selection:t}=this.editor;if(!t||!eA.e6.isCollapsed(t))return;if(t.anchor.offset!==t.focus.offset||t.anchor.path[0]!==t.focus.path[0]||t.anchor.path[1]!==t.focus.path[1]){this.emitter.emit(eu.Select,{content:"",offset:-1});return}var o=t.anchor.offset,r=t.anchor.path[0],i=t.anchor.path[1],a=e[r];if(!a)return;var n=a.children[i],l=null==n?void 0:n.text;if("string"==typeof l)this.emitter.emit(eu.Select,{content:l,offset:o,path:t.anchor.path})}keydown(e){if(e.key===ep.Start&&(e.preventDefault(),eA.YR.insertText(this.editor,ep.FullStart+ep.FullEnd),eA.YR.move(this.editor,{distance:2,reverse:!0}),setTimeout(()=>{this.select(this.innerLines)},0)),e.ctrlKey||e.metaKey){if("a"===e.key){e.preventDefault(),eA.YR.select(this.editor,{anchor:eA.ML.start(this.editor,[]),focus:eA.ML.end(this.editor,[])});}return}}compositionStart(e){this.emitter.emit(eu.CompositionStart,{event:e})}get decorate(){var e=this;return t=>{var[o,r]=t,i=[];if(!eA.xv.isText(o))return i;var a=y.lineTextValidate({lineText:o.text,tree:e.innerVariableTree});if(a.forEach(e=>{var{start:t,end:o,valid:a}=e,n={anchor:{path:r,offset:t},focus:{path:r,offset:o}};a?i.push((0,J._)({type:ef.Valid},n)):i.push((0,J._)({type:ef.Invalid},n))}),!this.innerFocus)return i;var n=e.isValidateSelectPath([o,r]),l=a.find(e=>e.valid&&e.start===(null==n?void 0:n.start)&&e.end===(null==n?void 0:n.end));return n&&l?i.push({type:ef.SelectedValid,anchor:{path:r,offset:n.start},focus:{path:r,offset:n.end}}):n&&!l&&i.push({type:ef.SelectedInvalid,anchor:{path:r,offset:n.start},focus:{path:r,offset:n.end}}),i}}syncEditorValue(){this.editor.children.forEach((e,t)=>{eA.YR.removeNodes(this.editor,{at:[t]})}),this.lines.forEach((e,t)=>{eA.YR.insertNodes(this.editor,e,{at:[this.editor.children.length]})})}isValidateSelectPath(e){var[t,o]=e;if(!eA.xv.isText(t))return;var{selection:r}=this.editor;if(!r)return;var i=r.anchor.offset,a=r.anchor.path[0],n=r.anchor.path[1];if(a!==o[0]||n!==o[1])return;var l=t.text,s=x.parse({lineContent:l,lineOffset:i});if(!!s)return{start:s.offset.lastStart-1,end:s.offset.firstEnd+2,valid:!0}}constructor(e){this.emitter=new eF.Z,this.editor=(0,ey.BU)((0,eO.VC)((0,eA.Jh)())),this.innerValue=e,this.innerLines=x.deserialize(e)}}var eV=o("556923"),eU=o("545145"),eK=o("239713"),eY=e=>{var t=e||{},{onClose:o}=t,r=(0,eV._)(t,["onClose"]),[i,{setTrue:a,setFalse:n}]=(0,eU.Z)(!1),l=()=>{null==o||o(),n()};return{node:i?(0,k.jsx)(eK.ZP,(0,J._)({visible:!0,onClose:l},r)):null,close:l,open:a}};o("495778");var eH=o("570395"),eG=o("533076"),eJ=o("411960"),eq=o("479727"),eX=o("618016"),eQ=o("646411"),e$=o("449001");var e0=((g={})[g.Success=0]="Success",g[g.NoFile=1]="NoFile",g[g.UploadFail=2]="UploadFail",g[g.UploadTimeout=3]="UploadTimeout",g[g.GetUrlFail=4]="GetUrlFail",g[g.ValidateError=5]="ValidateError",g[g.MaxSizeError=6]="MaxSizeError",g[g.SuffixError=7]="SuffixError",g[g.MaxWidthError=8]="MaxWidthError",g[g.MaxHeightError=9]="MaxHeightError",g[g.MinWidthError=10]="MinWidthError",g[g.MinHeightError=11]="MinHeightError",g[g.AspectRatioError=12]="AspectRatioError",g),e1=class e{select(e){var t=this;return(0,G._)(function*(){if(!e)throw new eX.sH("normal_error","\u9009\u62E9\u6587\u4EF6\u4E3A\u7A7A");t.reset(),t.file=e,t.displayUrl=URL.createObjectURL(t.file),yield t.validate().catch(()=>{t.validateResult={isSuccess:!1,errNo:5,msg:C.o.t("imageflow_upload_error")}})})()}upload(){var e=this;return(0,G._)(function*(){if(!e.file||!(null===(t=e.validateResult)||void 0===t?void 0:t.isSuccess)||e.isUploading)return;e.isUploading=!0,e.taskId+=1;var t,o,r=e.taskId;if("api"===e.mode)o=yield e.uploadByApi(e.file);else if("uploader"===e.mode)o=yield e.uploadByUploader(e.file);else throw new eX.sH("normal_error","ImageUploader mode error");if(r===e.taskId)e.uploadResult=o,e.isUploading=!1})()}uploadByUploader(e){return new Promise(t=>{var o,r=this.timeout&&setTimeout(()=>t({isSuccess:!1,errNo:3,msg:C.o.t("imageflow_upload_error7")}),this.timeout);(o=(0,G._)(function*(){var o=yield(0,eq.fr)({biz:"workflow",file:e,fileType:"image"}).then(e=>{if(!e)throw new eX.sH("normal_error","no uri");return e}).catch(()=>(t({isSuccess:!1,errNo:2,msg:C.o.t("imageflow_upload_error")}),""));if(!!o){var r=yield Q.OHc.SignImageURL({uri:o},{__disableErrorToast:!0}).catch(()=>null),i=(null==r?void 0:r.url)||"";i?t({isSuccess:!0,errNo:0,uri:o,url:i}):t({isSuccess:!1,errNo:4,msg:C.o.t("imageflow_upload_error")})}}),function(){return o.apply(this,arguments)})().finally(()=>{clearTimeout(r)})})}uploadByApi(e){return new Promise(t=>{var o,r=this.timeout&&setTimeout(()=>t({isSuccess:!1,errNo:3,msg:C.o.t("imageflow_upload_error7")}),this.timeout);(o=(0,G._)(function*(){var o=yield(function(e){return new Promise((t,o)=>{var r=new FileReader;r.onload=e=>{var r,i=null===(r=e.target)||void 0===r?void 0:r.result;if(!i||"string"!=typeof i){o(new eX.sH(eJ.b.parmasValidation,"file read fail"));return}t(i.replace(/^.*?,/,""))},r.readAsDataURL(e)})})(e).catch(()=>"");if(!o){t({isSuccess:!1,errNo:2,msg:C.o.t("imageflow_upload_error")});return}yield e$.nA.UploadFile({file_head:{file_type:e2(e.name),biz_type:eQ.ym.BIZ_BOT_WORKFLOW},data:o}).then(e=>{var o,r;t({isSuccess:!0,errNo:0,uri:(null===(o=e.data)||void 0===o?void 0:o.upload_uri)||"",url:(null===(r=e.data)||void 0===r?void 0:r.upload_url)||""})}).catch(()=>{t({isSuccess:!1,errNo:2,msg:C.o.t("imageflow_upload_error")})})}),function(){return o.apply(this,arguments)})().finally(()=>{clearTimeout(r)})})}reset(){this.file=void 0,this.displayUrl&&(URL.revokeObjectURL(this.displayUrl),this.displayUrl=void 0),this.isUploading=!1,this.uploadResult=void 0,this.validateResult=void 0,this.taskId+=1}validate(){var e=this;return(0,G._)(function*(){if(!!e.file&&!!e.displayUrl){var t=e.rules||{};if(t.maxSize&&e.file.size>t.maxSize){e.validateResult={isSuccess:!1,errNo:6,msg:C.o.t("imageflow_upload_exceed",{size:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var o=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,o)).toFixed(t))).concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o])}(t.maxSize)})};return}if(Array.isArray(t.suffix)&&t.suffix.length>0){var o=e2(e.file.name);if(!t.suffix.includes(o)){e.validateResult={isSuccess:!1,errNo:7,msg:C.o.t("imageflow_upload_error_type",{type:"".concat(t.suffix.filter(Boolean).join("/"))})};return}}var{width:r,height:i}=yield function(e){return new Promise((t,o)=>{var r=new window.Image;r.onload=()=>t({width:r.naturalWidth,height:r.naturalHeight}),r.onerror=e=>o(e),r.src=e})}(e.displayUrl);if(!r||!i){e.validateResult={isSuccess:!1,errNo:5,msg:C.o.t("imageflow_upload_error6")};return}if(t.maxWidth&&r>t.maxWidth){e.validateResult={isSuccess:!1,errNo:8,msg:C.o.t("imageflow_upload_error5",{value:"".concat(t.maxWidth,"px")})};return}if(t.maxHeight&&i>t.maxHeight){e.validateResult={isSuccess:!1,errNo:9,msg:C.o.t("imageflow_upload_error4",{value:"".concat(t.maxHeight,"px")})};return}if(t.minWidth&&r<t.minWidth){e.validateResult={isSuccess:!1,errNo:10,msg:C.o.t("imageflow_upload_error3",{value:"".concat(t.minWidth,"px")})};return}if(t.minHeight&&i<t.minHeight){e.validateResult={isSuccess:!1,errNo:11,msg:C.o.t("imageflow_upload_error2",{value:"".concat(t.minHeight,"px")})};return}if(t.aspectRatio&&r/i-t.aspectRatio>Number.MIN_VALUE){e.validateResult={isSuccess:!1,errNo:12,msg:C.o.t("imageflow_upload_error1")};return}e.validateResult={isSuccess:!0,errNo:0,msg:"success"}}})()}constructor(e){var t,o,r;this.taskId=0,this.mode="uploader",this.isUploading=!1,this.rules=null!==(t=null==e?void 0:e.rules)&&void 0!==t?t:this.rules,this.mode=null!==(o=null==e?void 0:e.mode)&&void 0!==o?o:this.mode,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:this.timeout}};function e2(e){var t=e.lastIndexOf(".");return e.slice(t+1).toLowerCase()}var e6=Object.create(null);function e4(e){var t,{rules:o,mode:r,timeout:i}=e||{},a=(0,j.useRef)(new e1({rules:o,mode:r,timeout:i})),[n,l]=(0,j.useState)(!1),[s,d]=(0,j.useState)(!1),[c,u]=(0,j.useState)(""),[p,m]=(0,j.useState)(""),[f,v]=(0,j.useState)("");(0,eG.Z)(()=>{var e;null===(e=a.current)||void 0===e||e.reset()}),(0,j.useEffect)(()=>{a.current.rules=o,a.current.mode=null!=r?r:a.current.mode},[o,r]);var g=(0,j.useCallback)(function(e){var t,{url:o,uri:r,fileName:i}=e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0!==r&&u(r),void 0!==o&&m(o),void 0!==i&&v(i),!n&&(m(null!=o?o:""),u(null!=r?r:""),v(null!=i?i:"")),!i&&(r&&e6[r]?v(e6[r]):!r&&v("")),(void 0!==r||!n)&&(l(!1),d(!1),null===(t=a.current)||void 0===t||t.reset())},[]);var h=(0,j.useCallback)((t=(0,G._)(function*(e){if(yield a.current.select(e),!(null===(t=a.current.validateResult)||void 0===t?void 0:t.isSuccess))return H.Toast.error((null===(o=a.current.validateResult)||void 0===o?void 0:o.msg)||"\u56FE\u7247\u4E0D\u7B26\u5408\u8981\u6C42"),a.current.validateResult;d(!1),l(!0),m(a.current.displayUrl||""),v(e.name||""),yield a.current.upload(),l(!1);var t,o,{uploadResult:r}=a.current;if(!!r)return d(!r.isSuccess),r.isSuccess?(H.Toast.success(C.o.t("file_upload_success")),u(r.uri),e6[r.url]="".concat(e.name)):H.Toast.error(r.msg),r}),function(e){return t.apply(this,arguments)}),[]),_=(0,j.useCallback)((0,G._)(function*(){if(!(null===(e=a.current)||void 0===e?void 0:e.file)||!(null===(o=a.current)||void 0===o?void 0:null===(t=o.validateResult)||void 0===t?void 0:t.isSuccess))return H.Toast.error(C.o.t("imageflow_upload_action")),{isSuccess:!1,errNo:e0.NoFile,msg:"\u8BF7\u9009\u62E9\u6587\u4EF6"};l(!0),d(!1),yield a.current.upload(),l(!1);var e,t,o,r=a.current.uploadResult||{isSuccess:!1,errNo:e0.UploadFail,msg:"\u65E0\u4E0A\u4F20\u7ED3\u679C"};return d(!r.isSuccess),r.isSuccess?(H.Toast.success(C.o.t("file_upload_success")),u(r.uri),e6[r.url]=a.current.file.name):H.Toast.error(r.msg),r}),[]);return{uri:c,url:p,fileName:f,loading:n,isError:s,uploadImg:h,clearImg:(0,j.useCallback)(()=>{var e;u(""),m(""),v(""),l(!1),d(!1),null===(e=a.current)||void 0===e||e.reset()},[]),retryUploadImg:_,setImgValue:g}}var e3=o("850138"),e8={};function e5(e){return"number"==typeof e&&!isNaN(e)}e8.styleTagTransform=B(),e8.setAttributes=R(),e8.insert=P().bind(null,"head"),e8.domAPI=N(),e8.insertStyleElement=Z(),T()(e3.Z,e8),e3.Z&&e3.Z.locals&&e3.Z.locals;var e9=e=>{var t,o,r,i,{options:a=[],value:n,defaultValue:l,minWidth:s=0,maxWidth:d=1/0,minHeight:c=0,maxHeight:u=1/0,onChange:p,readonly:m,selectClassName:f="",layoutStyle:v="horizontal",name:g="size-select"}=e,{getNodeSetterId:h}=(0,K.FCD)(),_=null!==(o=null!==(t=null==n?void 0:n.width)&&void 0!==t?t:null==l?void 0:l.width)&&void 0!==o?o:0,x=null!==(i=null!==(r=null==n?void 0:n.height)&&void 0!==r?r:null==l?void 0:l.height)&&void 0!==i?i:0,[w,y]=(0,j.useState)([]),[b,S]=(0,j.useState)(),I=e=>({width:Number(e.split("x")[0]),height:Number(e.split("x")[1])}),T=e=>"".concat(e.width,"x").concat(e.height);return(0,j.useEffect)(()=>{var e,t=T({width:_,height:x}),o=a.map(e=>(0,q._)((0,J._)({},e),{originValue:e.value,value:T(e.value)})),r=o.find(e=>e.value===t);!r&&o.push({label:C.o.t("customize_key_1"),value:"custom"}),S(null!==(e=null==r?void 0:r.value)&&void 0!==e?e:"custom"),y(o)},[_,x,a]),(0,k.jsxs)("div",{className:"flex flex-wrap gap-[12px]",children:[(0,k.jsx)(H.Select,{onChange:e=>{if("custom"!==e)p(I(e))},disabled:m,className:"".concat(f," ").concat("horizontal"===v?"":"w-full"),value:b,optionList:w,size:"small","data-testid":h("".concat(g,".ratio"))}),(0,k.jsx)("div",{className:"flex-1 flex items-center",children:(0,k.jsx)(H.CozInputNumber,{size:"small",prefix:C.o.t("imageflow_canvas_width"),hideButtons:!0,onNumberChange:e=>{if(!isNaN(e))p({width:Number(e),height:x})},onBlur:e=>{""===e.target.value||e5(s)&&Number(e.target.value)<s?p({width:null!=s?s:0,height:x}):Number(e.target.value)>d&&p({width:d,height:x})},value:_,disabled:m,min:s,max:d,className:"flex-1","data-testid":h("".concat(g,".width"))})}),(0,k.jsx)("div",{className:"flex-1 flex items-center",children:(0,k.jsx)(H.CozInputNumber,{prefix:C.o.t("imageflow_canvas_height"),size:"small",hideButtons:!0,onNumberChange:e=>{if(!isNaN(e))p({height:Number(e),width:_})},onBlur:e=>{""===e.target.value||e5(c)&&Number(e.target.value)<c?p({width:_,height:null!=c?c:0}):e5(u)&&Number(e.target.value)>u&&p({width:_,height:u})},value:x,disabled:m,min:c,max:u,className:"flex-1","data-testid":h("".concat(g,".height"))})})]})},e7=e=>{var{text:t="",rows:o=1,className:r,tooltipPosition:i}=e;return(0,k.jsx)(H.Typography.Paragraph,{ellipsis:{rows:o,showTooltip:{type:"tooltip",opts:{style:{width:"100%",wordBreak:"break-word"},position:i}}},className:r,children:t})},te=o("75591"),tt=o("302626"),to=o("980032");function tr(e){var t=(0,j.useRef)(e);return t.current=e,t}function ti(e,t){try{return JSON.parse(JSON.stringify(e,function(e,o){return t.includes(e)?null:o}))}catch(t){return e}}function ta(e){var[t,o]=(0,j.useState)(e),r=(0,j.useRef)(e);return(0,j.useLayoutEffect)(()=>{!(0,to.J)(ti(e,["parent"]),ti(r.current,["parent"]))&&(o(e),r.current=e)},[e]),t}function tn(){return Math.floor(2e6*Math.random()).toString(36)}function tl(e){var t=_.toSegments(e);if(!t)return"";var o=t[t.length-1].type===em.ArrayIndex?t[t.length-2]:t[t.length-1];return o&&o.type===em.ObjectKey?o.objectKey:""}var ts=o("112137"),td=o("740471"),tc=o("571375"),tu=o("969881"),tp={};tp.styleTagTransform=B(),tp.setAttributes=R(),tp.insert=P().bind(null,"head"),tp.domAPI=N(),tp.insertStyleElement=Z(),T()(tu.Z,tp);var tm=tu.Z&&tu.Z.locals?tu.Z.locals:void 0,tf="api.skip-selection-change",tv=tm["expression-editor-suggestion-keyboard-selected"],tg=e=>{if(!e)return;var t=e.querySelectorAll(".semi-tree-option-list .semi-tree-option");if(0!==t.length){var o=[...t],r=o.findIndex(e=>e.classList.contains(tv));return{elements:o,selectedIndex:r,selectedElement:o[r]}}};function th(e,t){var o=e[t];if(!!o)e.forEach(e=>{e.classList.contains(tv)&&e.classList.remove(tv)}),o.classList.add(tv),o.scrollIntoView({behavior:"smooth",block:"nearest"})}function t_(e,t,o){if(!e)return;var r,i,{from:a,to:n,textBefore:l}=o,s=function(e,t){var o,r=null!==(o=_.toSegments(t))&&void 0!==o?o:[];return h.concatFullPath({node:e,segments:r})}(t,l);if(!!s)e.replaceTextByRange({from:a,to:n,text:s,cursorOffset:(null===(i=(r=t).variable)||void 0===i?void 0:i.children)&&0!==r.variable.children.length?0:2,userEvent:tf})}var tx=o("319534");function tw(e){return!e||!Array.isArray(e)||0===e.length}function ty(e,t){var o=tr(t);(0,j.useEffect)(()=>{if(!!e)return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)};function t(e){var t=o.current[e.key];"function"==typeof t&&t(e)}},[e])}function tb(e){var{visible:t,content:o}=e;return(0,k.jsx)("div",{className:tm["expression-editor-suggestion-empty"],style:{display:t?"block":"none"},children:(0,k.jsx)("p",{children:o})})}var tk=(0,j.forwardRef)(function(e,t){var{visible:o,className:r,children:i}=e;return(0,k.jsx)("div",{className:W()(r,tm["expression-editor-suggestion"]),style:{display:o?"block":"none"},ref:t,children:i})}),tj={Renderer:function(e){var t,o,{value:r,variableTree:i,className:a,readonly:n,placeholder:l,dataTestID:s,onChange:d}=e,c=(0,j.useRef)(null),u=tr(i),p=ta(i);var m=(t=c,(0,j.useMemo)(()=>[{type:"character",triggerCharacter:"{",handler(e){var o,{from:r,to:i}=e;return null===(o=t.current)||void 0===o||o.replaceTextByRange({from:r,to:i,text:"{{}}",cursorOffset:-2}),!0}}],[]));var f=(o=u,(0,j.useMemo)(()=>[(0,ts.ut)({}),td.tk.baseTheme({"& .cm-line":{padding:0},"& .cm-placeholder":{color:"inherit",opacity:.333},"& .cm-content":{wordBreak:"break-all"}}),[ts.Cj.whole.of((e,t)=>{var r,i,a,n,l;if(!!o.current){if("Interpolation"===e.node.type.name&&(null===(r=e.node.firstChild)||void 0===r?void 0:r.type.name)==="{{"&&(null===(i=e.node.lastChild)||void 0===i?void 0:i.type.name)==="}}"){;return(a=t.sliceDoc(e.node.firstChild.to,e.node.lastChild.from),n=o.current,(l=_.toSegments(a))&&l[l.length-1].type!==em.EndEmpty&&h.matchTreeBranch({tree:n,segments:l}))?{type:"className",className:"cm-decoration-interpolation-valid"}:{type:"className",className:"cm-decoration-interpolation-invalid"}}}}),td.tk.baseTheme({"& .cm-decoration-interpolation-valid":{color:"#6675D9",caretColor:"#6675D9"}})],[ts.Cj.fromCursor.of((e,t)=>{var{anchor:o}=t.selection.main;if("Interpolation"===e.node.type.name&&e.node.firstChild&&e.node.lastChild&&o>=e.node.firstChild.to&&o<=e.node.lastChild.from)return{type:"background",className:"cm-decoration-interpolation-active",from:e.node.firstChild.from,to:e.node.lastChild.to}}),td.tk.baseTheme({"& .cm-decoration-interpolation-active":{borderRadius:"2px",backgroundColor:"var(--light-usage-fill-color-fill-1, rgba(46, 46, 56, 0.08))"}})]],[])),v=(0,j.useMemo)(()=>({class:"".concat(null!=a?a:""," flow-canvas-not-draggable"),"data-testid":null!=s?s:"","data-flow-editor-selectable":"false"}),[a,s]),g=(0,j.useCallback)(e=>{"function"==typeof d&&d(e.value)},[d]);return(0,j.useEffect)(()=>{var e=c.current;if(!!e)e.updateWholeDecorations()},[p]),(0,j.useEffect)(()=>{var e=c.current;if(!!e)"string"==typeof r&&r!==e.getValue()&&e.setValue(r)},[r]),(0,k.jsx)(te.Th,{plugins:tt.Z,defaultValue:null!=r?r:"",options:{fontSize:14,inputRules:m,readOnly:n,placeholder:l,contentAttributes:v},onFocus:function(){var e=c.current;if(!!e)e.updateWholeDecorations()},onChange:g,extensions:f,didMount:e=>c.current=e})},Popover:function(e){var t,o,r,i,a,n,l,s,d,c,u,p,m,f,v,g,x,w,y,b,S,I,T,{getPopupContainer:E,variableTree:N,className:A,onVisibilityChange:P}=e,M=ta(N),R=(0,j.useRef)(null),z=(0,j.useRef)(null),Z=tr(P),[L,B]=(0,j.useState)(""),D=(0,te.jE)(),O=tr(D),F=function(e){var[t,o]=(0,j.useState)(),r=tr(t);return(0,j.useEffect)(()=>{if(!!e){var t=e.$view;return e.$on("selectionChange",a),e.$on("focus",n),()=>{e.$off("selectionChange",a),e.$off("focus",n)}}function i(e){if(null==e?void 0:e.transactions.some(e=>e.isUserEvent(tf))){o(void 0);return}var i,a,{from:n,to:l,anchor:s,head:d}=t.state.selection.main;if(i={from:n,to:l,anchor:s,head:d},a=r.current,(!!i||!!a)&&(!i||!a||i.anchor!==a.anchor||i.head!==a.head||i.from!==a.from||i.to!==a.to))o({from:n,to:l,anchor:s,head:d})}function a(e){i(e.update)}function n(){i()}},[e]),t}(D),W=function(e){var[t,o]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{if(!!e)return e.$on("focus",t),e.$on("blur",r),()=>{e.$off("focus",t),e.$off("blur",r)};function t(){o(!0)}function r(){o(!1)}},[e]),t}(D);var V=(t=D,o=null==F?void 0:F.anchor,(0,j.useMemo)(()=>{if(!!t&&void 0!==o)return function(e,t){var o=(0,tx.qz)(e.state).cursorAt(t);do if("Interpolation"===o.node.type.name&&o.node.firstChild&&o.node.lastChild&&t>=o.node.firstChild.to&&t<=o.node.lastChild.from){var r=e.state.sliceDoc(o.node.firstChild.to,o.node.lastChild.from),i=t-o.node.firstChild.to;return{from:o.node.firstChild.to,to:o.node.lastChild.from,text:r,offset:i,textBefore:r.slice(0,i)}}while(o.parent())}(t.$view,o)},[t,o]));var U=(r=D,i=M,a=V,(0,j.useMemo)(()=>{if(!r||!a)return[];var e=_.toSegments(a.textBefore);return e?h.pruning({tree:i,segments:e}):[]},[r,i,a]));var K=(n=V,l=U,(0,j.useMemo)(()=>{if(!l)return[];if(!n)return l;var e=tl(n.textBefore);return l.filter(t=>t.label.startsWith(e))},[n,l]));var Y=(s=M,d=U,c=V,(0,j.useMemo)(()=>{if(!!c){if(tw(s))return""===c.textBefore?C.o.t("workflow_variable_refer_no_input"):void 0;if(tw(d)){if(""===c.text)return C.o.t("workflow_variable_refer_no_input");var e=_.toSegments(c.textBefore);if(!e)return;var t=h.matchTreeBranch({tree:null!=s?s:[],segments:e});if(t&&0!==t.length)return C.o.t("workflow_variable_refer_no_sub_variable")}}},[s,d,c]));u=function(e){var[t,o]=(0,j.useState)("");return(0,j.useEffect)(()=>{o(tn())},[e]),t}(K),p=R,m=V,f=()=>{var e=tg(z.current);if(!!e){var{elements:t}=e;th(t,0)}},v=tr(m),(0,j.useEffect)(()=>{if(p.current&&v.current){var e=tl(v.current.textBefore);p.current.search(e),f()}},[u,m]);var H=(g=null==V?void 0:V.text,x=M,(0,j.useMemo)(()=>{if(!g)return;var e=_.toSegments(g);if(!e)return;var t=h.matchTreeBranch({tree:x,segments:e});if(!!t)return t[t.length-1]},[g,x])),G=(0,j.useCallback)((e,t,o)=>{if(!!D&&!!V)t_(D,o,V)},[D,V]),J=W&&(!!V&&K.length>0||!!Y),[q,X]=(0,j.useState)(!1);(0,j.useEffect)(()=>{X(!0)},[F]);var Q=J&&q;var{prev:$,next:ee,apply:et}=(w=D,y=V,b=z,S=R,I=tr(w),T=tr(y),(0,j.useMemo)(()=>({prev:function(){var e=tg(b.current);if(!e)return;var{elements:t,selectedIndex:o}=e;if(1!==t.length){var r=o-1<0?t.length-1:o-1;th(t,r)}},next:function(){var e=tg(b.current);if(!!e){var{elements:t,selectedIndex:o}=e,r=o+1>=t.length?0:o+1;th(t,r)}},apply:function(){if(!T.current)return;var e,t,o,r,i=tg(b.current);if(!i)return;var{selectedElement:a}=i,n=null==a?void 0:a.getAttribute("data-key");if(!n)return;var l=null===(r=S.current)||void 0===r?void 0:null===(o=r.state)||void 0===o?void 0:null===(t=o.keyEntities)||void 0===t?void 0:null===(e=t[n])||void 0===e?void 0:e.data;if(!!l)t_(I.current,l,T.current)}}),[]));return ty(Q,{ArrowUp:$,ArrowDown:ee,Enter:et}),ty(Q,{Escape(){X(!1)}}),(0,j.useEffect)(()=>{var e,t;!0===Q?null===(e=O.current)||void 0===e||e.disableKeybindings(["ArrowUp","ArrowDown","Enter"]):null===(t=O.current)||void 0===t||t.disableKeybindings([])},[Q]),(0,j.useEffect)(()=>{"function"==typeof Z.current&&Z.current(Q)},[Q]),(0,k.jsx)(eS.J2,{trigger:"custom",visible:Q,keepDOM:!0,rePosKey:L,getPopupContainer:E,content:(0,k.jsxs)("div",{onMouseDown:e=>e.preventDefault(),style:{display:Q?"block":"none"},"data-expression-popover":!0,children:[(0,k.jsx)(tb,{visible:!!Y,content:Y}),(0,k.jsx)(tk,{ref:z,visible:!Y,className:A,children:(0,k.jsx)(eS.mp,{className:tm["expression-editor-suggestion-tree"],showFilteredOnly:!0,filterTreeNode:!0,onChangeWithObject:!0,ref:R,treeData:U,searchRender:!1,value:H,emptyContent:null,onSelect:G})})]}),children:(0,k.jsx)(tc.Vj,{side:ts.m6.Anchor,onChange:()=>B(tn())})})},EditorProvider:te.KU},tC=o("1179"),tS=o("448082"),tI=o("667485"),tT=o("179508"),tE=e=>{if(!!e)return{product_draft_status:void 0!==e.product_draft_status?parseInt(e.product_draft_status||"0"):K.Lo5.Default,external_flow_info:e.external_flow_info,schema_type:void 0!==e.schema_type?parseInt(e.schema_type||"0"):K.XQ3.DAG,plugin_id:e.plugin_id,icon_uri:e.icon_uri,url:e.url}},tN=e=>{var t=tE(e.biz_extend);return{workflow_id:e.res_id,url:null==t?void 0:t.url,icon_uri:null==t?void 0:t.icon_uri,name:e.name,desc:e.desc,schema_type:null==t?void 0:t.schema_type,external_flow_info:null==t?void 0:t.external_flow_info,space_id:e.space_id}},tA=o("209282"),tP=o("642385"),tM=e=>{var{spaceId:t="",refreshPage:o}=e,[r,i]=(0,j.useState)(K.wz8.Workflow),a=(0,tA.LA)({onPublishSuccess:()=>{null==o||o()},fromSpace:!0,flowMode:r});return{actionHandler:e=>{i(e.res_type===tT.b0.Imageflow?K.wz8.Imageflow:K.wz8.Workflow),a.setSpace(t),a.showModal({type:tA.AK.WORKFLOW_INFO,product:{meta_info:{entity_id:e.res_id,name:e.name}},source:tP.MU.WORKFLOW_PERSONAL_LIST})},publishModal:a.ModalComponent}},tR=e=>{var t,o,r,i,{spaceId:a,userId:n,refreshPage:l}=e,[s,d]=(0,j.useState)(!1),[c,u]=(0,j.useState)();var p=(t=(0,G._)(function*(e){if(!e.res_id||!a)throw new eX.sH("normal_error","miss workflowId or spaceID");S.E7.info({message:"workflow_list_delete_row",meta:{workflowId:e.res_id}});var t,o=K.KN6.CanDelete;o=(yield K.OHc.GetDeleteStrategy({space_id:a,workflow_id:e.res_id})).data;var r=[K.KN6.CanDelete,K.KN6.RejectProductDraft].includes(o);var i=(t=(0,G._)(function*(t){var o=(null==t?void 0:t.needDeleteBlockwise)?K.sL0.BlockwiseDelete:K.sL0.BlockwiseUnbind;if(!e.res_id||!a)throw new eX.sH("normal_error","miss workflowId or spaceID");try{yield K.OHc.DeleteWorkflow({space_id:a,workflow_id:e.res_id,action:o}),H.Toast.success({content:C.o.t("workflow_add_delete_success"),showClose:!1}),S.E7.info({message:"workflow_list_delete_row_success"}),yield(0,S.Dc)(300),null==l||l()}catch(e){S.E7.error({message:"workflow_list_delete_row_fail",error:e}),H.Toast.error({content:C.o.t("workflow_add_delete_fail"),showClose:!1})}}),function(e){return t.apply(this,arguments)});return{canDelete:r,deleteType:o,handleDelete:r?i:void 0}}),function(e){return t.apply(this,arguments)});var m=(o=(0,G._)(function*(e){var t=e.creator_id===n,o=yield p(e),r=C.o.t("delete_title");o.deleteType===K.KN6.UnListProduct&&(r=C.o.t("workflowstore_unable_to_delete_workflow"));var i=C.o.t("library_delete_desc");o.deleteType===K.KN6.UnListProduct&&(i=t?C.o.t("workflowstore_the_workflow_has_been"):C.o.t("workflowstore_delete_permission"));var a=o.canDelete?C.o.t("confirm"):C.o.t("workflowstore_remove_wf");o.deleteType===K.KN6.UnListProduct&&!t&&(a="");var l=C.o.t("cancel");o.deleteType===K.KN6.UnListProduct&&!t&&(l=C.o.t("confirm")),u({title:r,desc:i,cancelText:l,okText:a,okHandle:()=>{if(o.canDelete){var r;null==o||null===(r=o.handleDelete)||void 0===r||r.call(o,{needDeleteBlockwise:!1})}else o.deleteType===K.KN6.UnListProduct&&t&&window.open("/store/".concat(e.res_type===tT.b0.Workflow?"workflow":"imageflow","/").concat(e.res_id,"?entity_id=true"),"_blank")}}),d(!0)}),function(e){return o.apply(this,arguments)});return{deleteModal:(0,k.jsx)(H.Modal,{maskClosable:!1,centered:!0,visible:s,title:null!==(r=null==c?void 0:c.title)&&void 0!==r?r:"",onOk:()=>{d(!1),null==c||c.okHandle()},onCancel:()=>{d(!1)},closeOnEsc:!0,cancelText:null==c?void 0:c.cancelText,okText:null==c?void 0:c.okText,okButtonColor:"red",children:(0,k.jsx)("div",{className:"coz-common-content",children:null!==(i=null==c?void 0:c.desc)&&void 0!==i?i:""})}),actionHandler:m}},tz=o("842197"),tZ=e=>{var t,{spaceId:o}=e,r=(0,tz.useNavigate)();return{actionHandler:(t=(0,G._)(function*(e){if(!e.res_id||!o)throw new eX.sH("normal_error","miss workflowId or spaceID");S.E7.info({message:"workflow_list_copy_row",meta:{workflowId:e.res_id}});try{var t=!1,{data:i}=yield K.OHc.CopyWorkflow({space_id:o,workflow_id:e.res_id});if(t=!(null==i?void 0:i.workflow_id)){H.Toast.error(C.o.t("workflow_detail_toast_createcopy_failed")),S.E7.error({message:"workflow_list_copy_row_fail",error:new eX.sH("normal_error","result no workflow")});return}H.Toast.success({content:e.res_type===tT.b0.Imageflow?C.o.t("imageflow_detail_toast_createcopy_succeed"):C.o.t("workflow_detail_toast_createcopy_succeed"),showClose:!1}),S.E7.info({message:"workflow_list_copy_row_success",meta:{workflowId:e.res_id}}),yield(0,S.Dc)(300),r("/work_flow?workflow_id=".concat(i.workflow_id,"&space_id=").concat(o))}catch(e){S.E7.error({message:"workflow_list_copy_row_fail",error:e}),H.Toast.error(C.o.t("workflow_detail_toast_createcopy_failed"))}}),function(e){return t.apply(this,arguments)})}},tL=o("383672"),tB=e=>{var t,o,r,{spaceId:i,refreshPage:a}=e;var n=(t=(0,G._)(function*(e,t){yield K.OHc.UpdateWorkflowMeta({space_id:i,workflow_id:t,flow_mode:e}),H.Toast.success(C.o.t("wf_chatflow_123",{Chatflow:C.o.t(e===tL.WorkflowMode.ChatFlow?"wf_chatflow_76":"Workflow")})),yield new Promise(e=>setTimeout(e,300)),null==a||a()}),function(e,o){return t.apply(this,arguments)});var l=(o=(0,G._)(function*(e){var t;return n(tL.WorkflowMode.Workflow,null!==(t=e.res_id)&&void 0!==t?t:"")}),function(e){return o.apply(this,arguments)});return{switchToWorkflow:l,switchToChatflow:(r=(0,G._)(function*(e){var t;return n(tL.WorkflowMode.ChatFlow,null!==(t=e.res_id)&&void 0!==t?t:"")}),function(e){return r.apply(this,arguments)})}},{ActionKey:tD}=tI,tO=e=>{var t,[o]=(0,tS.V)(),{userId:r,onEditWorkflowInfo:i,getCommonActions:a,spaceId:n}=e,{actionHandler:l,deleteModal:s}=tR(e),{renderMenu:d,modal:c}=(0,tC.ju)({spaceId:null!=n?n:""}),{actionHandler:u}=tZ(e),{actionHandler:p,publishModal:m}=tM(e),{switchToChatflow:f,switchToWorkflow:v}=tB({spaceId:null!==(t=e.spaceId)&&void 0!==t?t:"",refreshPage:e.refreshPage}),g={[tD.Copy]:u,[tD.Delete]:l,[tD.Edit]:e=>{i(tN(e))},[tD.SwitchToFuncflow]:v,[tD.SwitchToChatflow]:f},{enablePublishEntry:h}=(0,tA.lR)();return{renderWorkflowResourceActions:e=>{var t,i=tE(e.biz_extend),n=null==i?void 0:i.product_draft_status,l=e.res_type===tT.b0.Imageflow,{actions:s}=e,c=null==s?void 0:s.find(e=>e.key===tD.Delete),u=null==s?void 0:s.find(e=>e.key===tD.Copy),m=null==s?void 0:s.find(e=>e.key===tD.Export),f=null==s?void 0:s.find(e=>e.key===tD.Edit),v=null==s?void 0:s.find(e=>e.key===tD.SwitchToChatflow),_=null==s?void 0:s.find(e=>e.key===tD.SwitchToFuncflow),x=e.creator_id===r,w=[{hide:!f,disabled:(null==f?void 0:f.enable)===!1,actionKey:"edit",actionText:C.o.t("Edit"),handler:()=>{var t;return null==g?void 0:null===(t=g[tD.Edit])||void 0===t?void 0:t.call(g,e)}},{hide:!v,disabled:(null==v?void 0:v.enable)===!1,actionKey:"switchChatflow",actionText:C.o.t("wf_chatflow_121",{flowMode:C.o.t("wf_chatflow_76")}),handler:()=>{var t;return null==g?void 0:null===(t=g[tD.SwitchToChatflow])||void 0===t?void 0:t.call(g,e)}},{hide:!_,disabled:(null==_?void 0:_.enable)===!1,actionKey:"switchWorkflow",actionText:C.o.t("wf_chatflow_121",{flowMode:C.o.t("Workflow")}),handler:()=>{var t;return null==g?void 0:null===(t=g[tD.SwitchToFuncflow])||void 0===t?void 0:t.call(g,e)}},...null!==(t=null==a?void 0:a(e))&&void 0!==t?t:[],{hide:!h||!o["bot.community.store_imageflow"]&&l||!x||(null==i?void 0:i.plugin_id)==="0",actionKey:"publishWorkflowProduct",actionText:n===K.Lo5.Default?C.o.t("workflowstore_submit"):C.o.t("workflowstore_submit_update"),handler:()=>{null==p||p(e)}},{customRender:d({resourceInfo:e,disabled:(null==m?void 0:m.enable)===!1,key:"exportWorkflow"})}];return(0,k.jsx)(H.Table.TableAction,{deleteProps:{hide:!c,disabled:(null==c?void 0:c.enable)===!1,disableConfirm:!0,handler:()=>{var t;return null===(t=g[tD.Delete])||void 0===t?void 0:t.call(g,e)}},copyProps:{hide:!u,disabled:(null==u?void 0:u.enable)===!1,handler:()=>{var t;return null===(t=g[tD.Copy])||void 0===t?void 0:t.call(g,e)}},actionList:w})},modals:[s,m,c]}},tF=e=>{var t=(0,tz.useNavigate)(),o=t=>{S.E7.info({message:"workflow_list_edit_row",meta:{workflowId:t}}),r(t,e)},r=(e,o)=>{if(!!e&&!!o)S.E7.info({message:"workflow_list_navigate_to_detail",meta:{workflowId:e}}),t("/work_flow?workflow_id=".concat(e,"&space_id=").concat(o))};return{handleWorkflowResourceClick:e=>{S.E7.info({message:"workflow_list_click_row"}),o(null==e?void 0:e.res_id)},goWorkflowDetail:r}},tW=e=>{var{from:t=eK.wL.SpaceWorkflowList,bindBizType:o,bindBizId:r,refreshPage:i,spaceId:a,goWorkflowDetail:n,projectId:l,onCreateSuccess:s,hiddenTemplateEntry:d,nameValidators:c}=e,[u,p]=(0,j.useState)(),[m,f]=(0,j.useState)("add"),[v,g]=(0,j.useState)(K.wz8.Workflow),[h,{setTrue:_,setFalse:x}]=(0,eU.Z)(!1),[w]=(0,tS.V)(),y=()=>{f("update"),S.E7.info({message:"workflow_list_open_create_modal"}),_()},I=(0,j.useMemo)(()=>E||w["bot.community.store_imageflow"]?{productCategory:"all",isSpaceWorkflow:!1,dataSourceType:eK.ye.Product}:{workflowTag:1,isSpaceWorkflow:!1,dataSource:eK.ye.Workflow},[w,v]),{node:T}=eY({from:t,flowMode:v,dupText:C.o.t("Copy"),hiddenCreate:!0,hiddenSpaceList:!0,initState:I,projectId:l,onAdd:()=>{null==i||i()},onDupSuccess:e=>{window.open("/work_flow?space_id=".concat(a,"&workflow_id=").concat(e.workflow_id,"&from=dupSuccess"))}}),E=(0,j.useMemo)(()=>(0,K.ikd)(v),[v]);return{openCreateModal:e=>{f("add"),g(e||K.wz8.Workflow),S.E7.info({message:"workflow_list_open_create_modal"}),_()},handleEditWorkflow:e=>{p(e),g(e.flow_mode||K.wz8.Workflow),y()},workflowModal:T,createWorkflowModal:(0,k.jsx)(b.d,{initConfirmDisabled:!0,mode:m,flowMode:v,projectId:l,visible:h,onCancel:x,bindBizType:o,bindBizId:r,workFlow:"update"===m?u:void 0,getLatestWorkflowJson:void 0,customTitleRender:void 0,onSuccess:e=>{var{workflowId:t}=e;if(x(),!t)throw new eX.sH("[Workflow] create failed","create workflow failed, no workflow id");if(s&&"add"===m){s({workflowId:t});return}if("update"===m){null==i||i();return}setTimeout(()=>{null==n||n(t,a)},500)},spaceID:a,nameValidators:c})}},tV=e=>{var{spaceId:t,userId:o,getCommonActions:r}=e,{handleWorkflowResourceClick:i,goWorkflowDetail:a}=tF(t),{openCreateModal:n,workflowModal:l,createWorkflowModal:s,handleEditWorkflow:d}=tW((0,q._)((0,J._)({},e),{goWorkflowDetail:a})),{renderWorkflowResourceActions:c,modals:u}=tO((0,q._)((0,J._)({},e),{userId:o,onEditWorkflowInfo:d,getCommonActions:r}));return{workflowResourceModals:[s,l,...u],openCreateModal:n,handleWorkflowResourceClick:i,renderWorkflowResourceActions:c}};o("302050"),o("459769");var tU=o("533512"),tK=o("559293"),tY=o("299846"),tH=e=>{var{voice:t,onDelete:o,disabled:r}=e,{isPlaying:i,togglePlayPause:a}=(0,tA.xm)(null==t?void 0:t.preview_audio);return t?(0,k.jsxs)("div",{style:{backgroundColor:"var(--coz-mg-card-hovered)",display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",height:"44px",border:"1px solid var(--coz-stroke-primary)",padding:"6px",borderRadius:"var(--coze-8)",cursor:"pointer"},children:[(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,k.jsx)(H.Avatar,{shape:"square",size:"small",src:t.icon_url}),(0,k.jsx)("span",{style:{marginLeft:"8px",marginRight:"2px"},children:t.voice_name}),i?(0,k.jsx)(H.IconButton,{theme:"borderless",disabled:r,onClick:a,size:"small",color:"secondary",icon:(0,k.jsx)(Y.T0r,{color:"#4E40E5"})}):(0,k.jsx)(H.IconButton,{theme:"borderless",disabled:r,onClick:a,size:"small",color:"secondary",icon:(0,k.jsx)(Y.JE7,{color:"#4E40E5"})})]}),(0,k.jsx)(H.IconButton,{disabled:r,onClick:o,size:"small",color:"secondary",icon:(0,k.jsx)(Y.dVD,{})})]}):null},tG=e=>{var[t,o]=(0,j.useState)(null),{loading:r}=(0,tK.Z)(()=>e?e$.lv.APIMGetVoice({voice_ids:[e]}).then(e=>{var t,r,i,a,n=null==e?void 0:null===(r=e.data)||void 0===r?void 0:null===(t=r.voices)||void 0===t?void 0:t[0];return o(null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(i=a.voices)||void 0===i?void 0:i[0]),n}).catch(()=>(o(null),null)):Promise.resolve(null).then(()=>(o(null),null)),{refreshDeps:[e]});return{voice:t,setVoice:o,loading:r}},tJ=e=>{var{value:t,onChange:o,disabled:r,workflowId:i}=e,[a,n]=(0,j.useState)(t),l=(0,tY.rY)(e=>e.space.id)||"",{voice:s,setVoice:d}=tG(a);(0,j.useEffect)(()=>{n(t)},[t]);var{open:c,modal:u}=(0,tA.PF)({spaceId:l,workflowId:i,onSelectVoice:e=>{d(e),null==o||o(e.voice_id)}});return(0,k.jsxs)(k.Fragment,{children:[(null==s?void 0:s.voice_id)?(0,k.jsx)(tH,{disabled:r,voice:s,onDelete:()=>{d(null),null==o||o(void 0)}}):(0,k.jsx)(H.Button,{disabled:r,style:{width:"100%",fontWeight:"500"},size:"small",icon:(0,k.jsx)(Y.PwN,{}),color:"primary",onClick:c,children:C.o.t("workflow_variable_select_voice")}),u]})},tq=e=>(0,k.jsx)(tA.h5,(0,J._)({},e)),tX=o("846940")},972882:function(e,t,o){o.d(t,{w:function(){return i}});var r,i=((r={}).WorkflowAddNode="workflow_addNode",r.BotSkills="bot_skills",r.BotSkillsDouyin="bot_skills_douyin_ide",r.BotMultiSkills="bot_multi_skills",r.BotTrigger="bot_trigger",r.BotShortcut="bot_shortcut",r.SpaceWorkflowList="space_workflow_list",r.WorkflowAgent="workflow_agent",r.ProjectImportLibrary="project_import_library",r.ProjectWorkflowAddNode="project_workflow_addNode",r.ProjectAddWorkflowResource="project_add_workflow_resource",r)},192073:function(e,t,o){o.d(t,{Dc:()=>n,gE:()=>p,pJ:()=>m,E7:()=>l,mk:()=>a}),o("114798");var r,i=o("498842"),a=()=>{if(void 0===r){var{userAgent:e}=navigator,t=/iPad/.test(e),o=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;r=t||o}return r},n=e=>new Promise(t=>{setTimeout(t,e)}),l=i.E7.createReporterWithPreset({namespace:"workflow"}),s=o("490577"),d=o.n(s),c=o("16242"),u={"zh-CN":"zh_CN",zh:"zh-CN",zh_TW:"zh_TW","en-US":"en",en:"en","ja-JP":"ja",ja:"ja","ko-KR":"ko",ko:"ko","fr-FR":"fr",fr:"fr","de-DE":"de",de:"de","it-IT":"it",it:"it","es-ES":"es",es:"es"},p=e=>{var t=null==e?void 0:e.split(" ");if((null==t?void 0:t.length)!==6)return!1;try{var o=d().toString(e,{locale:u["zh-CN"],throwExceptionOnParseError:!0});if(o.includes("null")||o.includes("undefined"))return!1;return!0}catch(e){return!1}},m=(e,t)=>{if(!e)return"";var o,r=c.o.getLanguages();return p(e)?d().toString(e,{locale:null!==(o=u[r[0]])&&void 0!==o?o:u["zh-CN"],use24HourTimeFormat:!0}):null!=t?t:c.o.t("workflow_trigger_param_unvalid_cron",{},"\u53C2\u6570\u4E3A\u975E\u6CD5 cron \u8868\u8FBE\u5F0F")}},13904:function(e,t,o){o.d(t,{d:()=>O});var r=o("255721"),i=o("341333"),a=o("265489"),n=o("938809"),l=o("723530"),s=o("559721"),d=o("405510"),c=o("889707"),u=o("886073"),p=o("411960"),m=o("498842"),f=o("16242"),v=o("826498"),g=o("988726"),h=o("182956"),_=o("299846"),x=o("168074"),w=o("618016"),y=o("646411"),b=o("866466"),k=o.n(b),j=o("462669"),C=o.n(j),S=o("318249"),I=o.n(S),T=o("294754"),E=o.n(T),N=o("13355"),A=o.n(N),P=o("876846"),M=o.n(P),R=o("604417"),z={};z.styleTagTransform=M(),z.setAttributes=E(),z.insert=I().bind(null,"head"),z.domAPI=C(),z.insertStyleElement=A(),k()(R.Z,z);var Z=R.Z&&R.Z.locals?R.Z.locals:void 0,L=["702095075","702095081"],{Checkbox:B}=x.l0,D=e=>{if(!!e)return[{url:e.url||"",uid:e.icon_uri||""}]};function O(e){var t,o,b,k,j,{flowMode:C=d.wz8.Workflow,mode:S,bindBizId:I,bindBizType:T,projectId:E,visible:N,workFlow:A,initConfirmDisabled:P=!1,customTitleRender:M,onSuccess:R,onCancel:z,nameValidators:O=[]}=e,F=(0,l.useRef)(null),[W,V]=(0,l.useState)(P),[U,K]=(0,l.useState)(),Y=(0,v.Pc)(),H=null!==(j=null!==(k=null==Y?void 0:Y.locale)&&void 0!==k?k:navigator.language)&&void 0!==j?j:"en-US";var G=(t=(0,r._)(function*(){var e,t=null===(e=F.current)||void 0===e?void 0:e.formApi;return yield null==t?void 0:t.validate(["name"]),null==t?void 0:t.getValues()}),function(){return t.apply(this,arguments)}),J=()=>{m.E7.info({message:"workflow_info_modal_cancel",namespace:"workflow"}),K(void 0),null==z||z()},q=e=>{if(L.includes(e.code||"")){V(!0),K(e.msg);return}throw J(),e};var X=(o=(0,r._)(function*(){var e,t=null==A?void 0:A.workflow_id;if(m.E7.info({message:"workflow_info_modal_confirm_update",namespace:"workflow",meta:{workflowId:t}}),!t){var o=f.o.t("workflow_list_create_modal_workflow_id_empty");throw new w.sH(p.b.parmasValidation,o)}var r=yield G(),i={workflow_id:t,icon_uri:(null==r?void 0:null===(e=r.icon_uri)||void 0===e?void 0:e[0].uid)||"",name:null==r?void 0:r.name,desc:(null==r?void 0:r.target)?r.target:"",space_id:A.space_id||"",ignore_status_transfer:!0,schema_type:(null==r?void 0:r.schema_type)||(null==A?void 0:A.schema_type)};try{yield d.OHc.UpdateWorkflowMeta(i),m.E7.info({message:"workflow_info_modal_update_success",namespace:"workflow"}),h.Toast.success({content:f.o.t("workflow_list_update_success"),showClose:!1}),yield null==R?void 0:R({workflowId:t,flowMode:C})}catch(e){m.E7.error({message:"workflow_info_modal_update_fail",namespace:"workflow",error:e}),q(e)}}),function(){return o.apply(this,arguments)});var Q=(b=(0,r._)(function*(){m.E7.info({message:"workflow_info_modal_confirm_create",namespace:"workflow"});var e=yield G();try{var t,o,r,n=(0,a._)((0,i._)({},e),{space_id:_.rY.getState().getSpaceId(),name:(null==e?void 0:e.name)||"",desc:(null==e?void 0:e.target)||"",icon_uri:(null==e?void 0:null===(o=e.icon_uri)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:t.uid)||"",flow_mode:C,bind_biz_id:I,bind_biz_type:T,project_id:E,create_conversation:E?null==e?void 0:e.create_conversation:void 0}),l=yield d.OHc.CreateWorkflow(n,{headers:{"x-locale":H}}),s=C===d.wz8.Imageflow?f.o.t("imageflow_create_toast_success"):C===d.wz8.ChatFlow?f.o.t("wf_chatflow_95"):f.o.t("workflow_list_create_success");h.Toast.success({content:s,showClose:!1}),yield null==R?void 0:R({workflowId:null===(r=l.data)||void 0===r?void 0:r.workflow_id,flowMode:C}),m.E7.info({message:"workflow_info_modal_create_success",namespace:"workflow"})}catch(e){m.E7.error({message:"workflow_info_modal_create_fail",namespace:"workflow",error:e}),q(e)}}),function(){return b.apply(this,arguments)}),$=(0,l.useMemo)(()=>{var e=function(e,t){switch(t){case d.wz8.Imageflow:return"add"===e?f.o.t("imageflow_create"):f.o.t("imageflow_edit");case d.wz8.Workflow:return"add"===e?f.o.t("workflow_list_create_modal_title"):f.o.t("workflow_list_edit_modal_title");case d.wz8.ChatFlow:return"add"===e?f.o.t("wf_chatflow_81"):f.o.t("wf_chatflow_84");default:return"add"===e?f.o.t("workflow_list_create_modal_title"):f.o.t("workflow_list_edit_modal_title")}}(S,C);return M&&(0,s.Z)(M)?M(e):e},[S,C,M]),ee=(0,l.useMemo)(()=>C===d.wz8.Imageflow?{nameLabel:f.o.t("imageflow_create_name"),namePlaceholder:f.o.t("imageflow_create_name_placeholder"),descLabel:f.o.t("imageflow_create_description"),descPlaceholder:f.o.t("imageflow_create_description_placeholder"),nameRequiredLabel:f.o.t("imageflow_create_name_placeholder"),nameFormatRuleLabel:f.o.t("imageflow_create_name_wrong_format"),descRequiredLabel:f.o.t("imageflow_create_description_placeholder")}:C===d.wz8.ChatFlow?{nameLabel:f.o.t("wf_chatflow_85"),namePlaceholder:f.o.t("wf_chatflow_91"),descLabel:f.o.t("wf_chatflow_86"),descPlaceholder:f.o.t("wf_chatflow_92"),nameRequiredLabel:f.o.t("wf_chatflow_93"),nameFormatRuleLabel:f.o.t("wf_chatflow_94"),descRequiredLabel:f.o.t("wf_chatflow_122")}:{nameLabel:f.o.t("workflow_list_create_modal_name_label"),namePlaceholder:f.o.t("workflow_list_create_modal_name_placeholder"),descLabel:f.o.t("workflow_list_create_modal_description_label"),descPlaceholder:f.o.t("workflow_list_create_modal_description_placeholder"),nameRequiredLabel:f.o.t("workflow_list_create_modal_name_rule_required"),nameFormatRuleLabel:f.o.t("workflow_list_create_modal_name_rule_reg"),descRequiredLabel:f.o.t("workflow_list_create_modal_description_rule_required")},[C]),et=(0,l.useMemo)(()=>{switch(C){case d.wz8.Imageflow:return y.Tu.Imageflow;case d.wz8.Workflow:return y.Tu.Workflow;case d.wz8.ChatFlow:return y.Tu.ChatFlow;default:return y.Tu.Workflow}},[C]);return(0,n.jsx)(x.M5,{type:"action-small",keepDOM:!1,icon:null,visible:N,onCancel:J,title:$,footer:(0,n.jsxs)(h.Space,{children:[(0,n.jsx)(h.Button,{className:"min-w-[96px]",color:"primary",onClick:J,"data-testid":"workflow.list.create.cancel",children:f.o.t("workflow_list_create_modal_footer_cancel")}),(0,n.jsx)(h.LoadingButton,{className:"min-w-[96px]",color:"hgltplus",disabled:W,onClick:"add"===S?Q:X,"data-testid":"workflow.list.create.submit",children:f.o.t("workflow_list_create_modal_footer_confirm")})]}),children:(0,n.jsxs)(x.l0,{ref:F,showValidateIcon:!1,className:Z["upload-form"],onValueChange:e=>{var{name:t,target:o}=e;K(void 0),V(!(null==t?void 0:t.trim())||!(null==o?void 0:o.trim()))},children:[(0,n.jsx)(u.s,{noLabel:!0,fieldClassName:Z["upload-field"],field:"icon_uri",initValue:D(A),iconType:et,fileBizType:y.ym.BIZ_BOT_WORKFLOW}),(0,n.jsx)(x.P6,{stopValidateWithError:!0,className:Z["textarea-single-line"],field:"name",placeholder:ee.namePlaceholder,label:ee.nameLabel,initValue:null==A?void 0:A.name,rows:1,maxCount:c.hhB,maxLength:c.hhB,rules:[{required:!0,message:ee.nameRequiredLabel},{validator(e,t){if(!c.Pz_.test(t)){var o;return new w.sH(p.b.formValidation,null!==(o=ee.nameFormatRuleLabel)&&void 0!==o?o:"")}return!0}},...O],"data-testid":"workflow.list.create.name.input"}),"add"===S&&E&&C===d.wz8.ChatFlow?(0,n.jsxs)(B,{fieldClassName:Z["conversation-field"],noLabel:!0,initValue:!0,field:"create_conversation",children:[(0,n.jsx)(x.ZT.Text,{className:"coz-fg-primary",children:f.o.t("wf_chatflow_87")}),(0,n.jsx)(h.Tooltip,{position:"top",theme:"dark",style:{width:278},content:f.o.t("wf_chatflow_82"),children:(0,n.jsx)(g.L03,{className:"text-[16px] ml-1.5 coz-fg-dim"})})]}):null,(0,n.jsx)(x.P6,{field:"target",className:Z["textarea-multi-line"],label:ee.descLabel,placeholder:ee.descPlaceholder,initValue:null==A?void 0:A.desc,maxCount:600,maxLength:600,rules:[{required:!0,message:ee.descRequiredLabel}],"data-testid":"workflow.list.create.desc.input"}),"string"==typeof U?(0,n.jsx)(x.l0.ErrorMessage,{error:U}):null]})})}},459769:function(e,t,o){o.d(t,{u:function(){return b}});var r=o(255721),i=o(938809),a=o(842197),n=o(723530),l=o(471108),s=o(405510),d=o(209282),c=o(16242),u=o(182956),p=o(618016),m=o(993301),f=o(646411),v=o(449001),g=o(570395),h=o(524485),_=o(647063),x=o(192073),w=["788664021","788664024"],{Text:y}=u.Typography;function b(e){var t,o,b,k,{data:j,workFlowList:C,copyProductHandle:S,onWorkFlowListChange:I,onAdd:T,onRemove:E,onItemClick:N,onDupSuccess:A,onDelete:P,handleDeleteWorkflow:M,isProfessionalTemplate:R}=e,z=(0,n.useContext)(g.Z),{bot_id:Z}=(0,a.useParams)(),L=(0,a.useNavigate)(),B=(0,d.WC)(e=>(0,d.nz)(null==e?void 0:e.rightsInfo));(0,n.useEffect)(()=>{d.WC.getState().getRights()},[]);function D(){return(D=(0,r._)(function*(e){return(0,h.D)(null==z?void 0:z.modalState)?function(e){return O.apply(this,arguments)}(e):F(e)})).apply(this,arguments)}function O(){return(O=(0,r._)(function*(e){if(!e.spaceId||!e.workflowId)throw new p.sH("normal_error","getProjectWorkflow: empty id");var t,o=null!==(t=(yield s.OHc.GetWorkflowDetailInfo({space_id:e.spaceId,workflow_filter_list:[{workflow_id:e.workflowId}]},{__disableErrorToast:!0})).data)&&void 0!==t?t:[];if(!(null==o?void 0:o.length))throw u.Toast.error(c.o.t("workflow_add_list_added_id_empty")),new p.sH("normal_error","project workflow list no item");return o.at(0)})).apply(this,arguments)}function F(e){return W.apply(this,arguments)}function W(){return(W=(0,r._)(function*(e){if(!e.spaceId||!e.workflowId||!e.pluginId)throw new p.sH("normal_error","getWorkflowItemByPluginId: empty id");var t,o,r,i,a,n,l=null!==(i=null===(t=(yield v.Js.GetPlaygroundPluginList({space_id:e.spaceId,page:1,size:1,plugin_ids:[e.pluginId||""],plugin_types:[e.isImageflow?f.zV.IMAGEFLOW:f.zV.WORKFLOW]},{__disableErrorToast:!0})).data)||void 0===t?void 0:t.plugin_list)&&void 0!==i?i:[];if(!(null==l?void 0:l.length))throw u.Toast.error(c.o.t(e.isImageflow?"imageflow_add_toast_error":"workflow_add_list_added_id_empty")),new p.sH("normal_error","plugin_list no item");var d=l.at(0);return{workflow_id:e.workflowId||"",plugin_id:e.pluginId||"",name:(null==d?void 0:d.name)||"",desc:(null==d?void 0:d.desc_for_human)||"",parameters:null!==(a=null==d?void 0:null===(r=d.plugin_apis)||void 0===r?void 0:null===(o=r.at(0))||void 0===o?void 0:o.parameters)&&void 0!==a?a:[],plugin_icon:(null==d?void 0:d.plugin_icon)||"",version_name:null==d?void 0:d.version_name,flow_mode:(null==d?void 0:d.plugin_type)===f.zV.IMAGEFLOW?s.wz8.Imageflow:null!==(n=e.flowMode)&&void 0!==n?n:s.wz8.Workflow}})).apply(this,arguments)}function V(e){return(null==z?void 0:z.modalState.dataSourceType)===_.ye.Workflow}var U=(t=(0,r._)(function*(){if(!(!z||V(j))){if(R&&!B){L("/sign/oauth?redirect=".concat(encodeURIComponent("/store/bot"),"&platform=volcano&page_from=coze_pro_sign_in"));return}x.E7.info({message:"workflow_modal: dupProduct"});var e="",t="";try{var o=yield S(j,z.spaceId);e=o.pluginId,t=o.workflowId}catch(e){w.includes(null==e?void 0:e.code)?u.Toast.error(e.message):(u.Toast.error(c.o.t("copy_failed")),x.E7.error({message:"dupProduct: copyProductHandle error",error:e}));return}yield(0,x.Dc)(100);try{var r,a=yield F({spaceId:z.spaceId,workflowId:t,pluginId:e,isImageflow:(null==j?void 0:null===(r=j.meta_info)||void 0===r?void 0:r.entity_type)===m._J.ImageflowTemplateV2});null==I||I([...null!=C?C:[],a]),null==T||T(a,{isDup:!0,spaceId:z.spaceId}),A?A(a):u.Toast.success({content:(0,i.jsxs)(u.Space,{spacing:6,children:[(0,i.jsx)(y,{children:c.o.t("workflowstore_workflow_copy_successful")}),(0,i.jsx)(u.Button,{color:"primary",onClick:()=>{window.open("/work_flow?space_id=".concat(z.spaceId,"&workflow_id=").concat(a.workflow_id,"&from=dupSuccess"))},children:c.o.t("workflowstore_continue_editing")})]})})}catch(e){u.Toast.error(c.o.t("workflow_add_list_added_fail")),x.E7.error({message:"dupProduct: getWorkflowItemByPluginId error",error:e})}}}),function(){return t.apply(this,arguments)});var K=(o=(0,r._)(function*(){if(!!z&&!!V(j)){x.E7.info({message:"workflow_modal: dupWorkflowTpl"});var e="",t="";try{var o,r,a,n,l=yield s.OHc.CopyWkTemplateApi({workflow_ids:[j.workflow_id||""],target_space_id:z.spaceId},{__disableErrorToast:!0});t=(null===(o=l.data[null!==(a=j.workflow_id)&&void 0!==a?a:""])||void 0===o?void 0:o.workflow_id)||"",e=(null===(r=l.data[null!==(n=j.workflow_id)&&void 0!==n?n:""])||void 0===r?void 0:r.plugin_id)||"0"}catch(e){u.Toast.error(c.o.t("copy_failed")),x.E7.error({message:"dupWorkflowTpl: CopyWkTemplateApi error",error:e});return}if(!t||"0"===e){u.Toast.error(c.o.t("copy_failed")),x.E7.error({message:"dupWorkflowTpl: CopyWkTemplateApi error",error:new p.sH("normal_error","CopyWkTemplateApi: plugin_id is ".concat(e,", workflow_id is ").concat(t))});return}yield(0,x.Dc)(100);try{var d,m=yield F({spaceId:z.spaceId,workflowId:t,pluginId:e,isImageflow:z.flowMode===s.wz8.Imageflow,flowMode:j.flow_mode}),f=null!==(d=null==j?void 0:j.flow_mode)&&void 0!==d?d:null==z?void 0:z.flowMode;void 0!==f&&(m.flow_mode=f),null==I||I([...null!=C?C:[],m]),null==T||T(m,{isDup:!0,spaceId:z.spaceId}),A?A(m):u.Toast.success({content:(0,i.jsxs)(u.Space,{spacing:6,children:[(0,i.jsx)(y,{children:c.o.t("workflowstore_workflow_copy_successful")}),(0,i.jsx)(u.Button,{color:"primary",onClick:()=>{window.open("/work_flow?space_id=".concat(z.spaceId,"&workflow_id=").concat(m.workflow_id))},children:c.o.t("workflowstore_continue_editing")})]})})}catch(e){u.Toast.error(e.message||c.o.t("workflow_add_list_added_fail")),x.E7.error({message:"dupWorkflowTpl: getWorkflowItemByPluginId error",error:e})}}}),function(){return o.apply(this,arguments)});var Y=(b=(0,r._)(function*(){if(!z||!V(j))return!1;x.E7.info({message:"workflow_modal: addWorkflow"});try{var e=yield function(e){return D.apply(this,arguments)}({spaceId:z.spaceId,workflowId:j.workflow_id,pluginId:j.plugin_id,isImageflow:(null==j?void 0:j.flow_mode)===s.wz8.Imageflow,flowMode:null==j?void 0:j.flow_mode});void 0!==(null==j?void 0:j.flow_mode)&&(e.flow_mode=null==j?void 0:j.flow_mode),null==I||I([...null!=C?C:[],e]);var t=yield null==T?void 0:T(e,{isDup:!1,spaceId:z.spaceId});if((0,l.Z)(t))return t;return!0}catch(e){return u.Toast.error(e.message||c.o.t("workflow_add_list_added_fail")),x.E7.error({message:"addWorkflow: getWorkflowItemByPluginId error",error:e}),!1}}),function(){return b.apply(this,arguments)});var H=(k=(0,r._)(function*(){if(!V(j)||!M)return;x.E7.info({message:"workflow_modal: deleteWorkflow"});var e,t=yield null==M?void 0:M(j);if((null==t?void 0:t.canDelete)&&(yield null==t?void 0:null===(e=t.handleDelete)||void 0===e?void 0:e.call(t)),!C)return;var o=C.find(e=>e.workflow_id===j.workflow_id);if(!!o)null==P||P(o),null==I||I(C.filter(e=>e.workflow_id!==j.workflow_id))}),function(){return k.apply(this,arguments)});return{dupWorkflowTpl:K,dupProduct:U,addWorkflow:Y,removeWorkflow:()=>{if(!C||!V(j))return;x.E7.info({message:"workflow_modal: removeWorkflow"});var e=C.find(e=>e.workflow_id===j.workflow_id);if(!!e)null==E||E(e),null==I||I(C.filter(e=>e.workflow_id!==j.workflow_id))},deleteWorkflow:H,itemClick:()=>{if(!!z){if(x.E7.info({message:"workflow_modal: itemClick"}),N){var e,t,o,r,i,a=N({item:j,type:z.modalState.dataSourceType},z.getModalState(z));if(!a||a.handled)return}if(V(j)){;r=null!==(t=(e=j).workflow_id)&&void 0!==t?t:"",i=new URLSearchParams,Z&&i.append("bot_id",Z),i.append("space_id",null!==(o=null==z?void 0:z.spaceId)&&void 0!==o?o:""),i.append("workflow_id",r),window.open("/work_flow?".concat(i.toString()),"_blank")}else window.open("/template/workflow/".concat(j.meta_info.id,"?entity_id=").concat(m._J.WorkflowTemplateV2),"_blank")}}}}},302050:function(e,t,o){o.d(t,{e:function(){return p}});var r=o(255721),i=o(341333),a=o(265489),n=o(723530),l=o(192935),s=o(642385),d=o(618016),c=o(993301),u=o(449001);function p(){var e,t,{pageSize:o=12,enabled:p=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[m,f]=(0,n.useState)(),[v,g]=(0,n.useState)(c.ER.Heat),[h,_]=(0,n.useState)(),[x,w]=(0,n.useState)(),y=(0,n.useMemo)(()=>({entity_types:[c._J.WorkflowTemplateV2,c._J.ImageflowTemplateV2],page_num:1,page_size:o,category_id:h,sort_type:v,source:x,keyword:m}),[m,v,h,x]),b=(0,n.useMemo)(()=>["workflow_product",JSON.stringify(y)],[y]);var k=(e=(0,r._)(function*(e){return(yield u.yF.PublicGetProductList(e)).data}),function(t){return e.apply(this,arguments)}),{data:j,error:C,fetchNextPage:S,hasNextPage:I,isFetching:T,isFetchingNextPage:E,status:N,refetch:A}=(0,l.N)({enabled:p,queryKey:b,queryFn:e=>{var{pageParam:t}=e;return k(t)},initialPageParam:y,getNextPageParam:(e,t,o)=>{var r;return(null==e?void 0:e.has_more)?(0,a._)((0,i._)({},o),{page_num:(null!==(r=o.page_num)&&void 0!==r?r:1)+1}):null}}),P=(0,n.useMemo)(()=>{var e=[],t={};return null==j||j.pages.forEach(o=>{var r;null==o||null===(r=o.products)||void 0===r||r.forEach(o=>{if(!!o.meta_info.id)!t[o.meta_info.id]&&e.push(o),t[o.meta_info.id]=!0})}),e},[j]);return{updatePageParam:e=>{if("category_id"in e&&_(e.category_id),"sort_type"in e){var t;g(null!==(t=e.sort_type)&&void 0!==t?t:c.ER.Newest)}"keyword"in e&&f(e.keyword),"source"in e&&w(e.source)},workflowProductList:P,queryError:C,loadingStatus:N,refetch:A,fetchNextPage:S,isFetching:T,isFetchingNextPage:E,hasNextPage:I,copyProduct:(t=(0,r._)(function*(e,t){if(!(null==e?void 0:null===(o=e.meta_info)||void 0===o?void 0:o.id))throw new d.sH("normal_error","no productId");var o,r,n,l,p,m,f,v,g,h,_=yield u.yF.PublicDuplicateProduct({product_id:null==e?void 0:null===(r=e.meta_info)||void 0===r?void 0:r.id,space_id:t,entity_type:e.meta_info.entity_type},{__disableErrorToast:!0}),x=null===(n=_.data)||void 0===n?void 0:n.new_entity_id,w=null===(l=_.data)||void 0===l?void 0:l.new_plugin_id;if(!x||!w)throw new d.sH("normal_error","copyProduct fail, no new_entity_id");return(0,s.Gg)(s.Kg.template_action_front,(0,a._)((0,i._)({template_id:null!==(v=e.meta_info.id)&&void 0!==v?v:"",template_name:null!==(g=e.meta_info.name)&&void 0!==g?g:"",template_type:e.meta_info.entity_type===c._J.WorkflowTemplateV2?"workflow":"imageflow",template_tag_professional:e.meta_info.is_professional?"professional":"basic",entity_id:null!==(h=e.meta_info.entity_id)&&void 0!==h?h:""},(null==e?void 0:null===(p=e.meta_info)||void 0===p?void 0:p.is_free)?{template_tag_prize:"free"}:{template_tag_prize:"paid",template_prize_detail:Number(null==e?void 0:null===(f=e.meta_info)||void 0===f?void 0:null===(m=f.price)||void 0===m?void 0:m.amount)||0}),{action:"duplicate",after_id:x})),{workflowId:x,pluginId:w}}),function(e,o){return t.apply(this,arguments)})}}},239713:function(e,t,o){o.d(t,{BD:()=>p.BD,ZP:()=>ta,Do:()=>em.D,md:()=>ti,ye:()=>p.ye,sD:()=>$,wL:()=>m.w});var r,i=o("556923"),a=o("938809"),n=o("723530"),l=o("856306"),s=o.n(l),d=o("405510"),c=o("16242"),u=o("168074"),p=o("647063"),m=o("972882"),f=o("341333"),v=o("265489"),g=o("822257"),h=o("697643"),_=o("889707"),x=o("642385"),w=o("299846"),y=o("618016"),b=o("897538"),k=o("570395"),j=o("934550"),C=o("169702"),S=o("993301");function I(){var e=(0,n.useContext)(k.Z),{run:t,cancel:o}=(0,j.Z)(e=>{e.length>100?d(e.substring(0,100)):d(e)},{wait:300});if(!e)return null;var{dataSourceType:r,query:i,isSpaceWorkflow:l,sortType:s}=e.modalState,d=t=>{var o={query:null!=t?t:""};r===p.ye.Workflow&&(o.workflowTag=l?0:1,o.sortType=void 0),r===p.ye.Product&&(!t&&s===S.ER.Relative&&(o.sortType=S.ER.Heat),t&&!e.modalState.query&&(o.sortType=o.sortType=S.ER.Relative)),e.updateModalState(o)};return(0,a.jsx)(C.yO,{tabIndex:-1,value:i,placeholder:c.o.t("workflow_add_search_placeholder"),"data-testid":"workflow.modal.search",onSearch:e=>{e?t(e):(o(),d(""))}})}var T=o("255721"),E=o("995991"),N=o("988726"),A=o("449001"),P=o("866466"),M=o.n(P),R=o("462669"),z=o.n(R),Z=o("318249"),L=o.n(Z),B=o("294754"),D=o.n(B),O=o("13355"),F=o.n(O),W=o("876846"),V=o.n(W),U=o("986171"),K={};K.styleTagTransform=V(),K.setAttributes=D(),K.insert=L().bind(null,"head"),K.domAPI=z(),K.insertStyleElement=F(),M()(U.Z,K);var Y=U.Z&&U.Z.locals?U.Z.locals:void 0,H=(0,n.forwardRef)((e,t)=>{var o,{from:r,hiddenSpaceList:i,hiddenExplore:l,hiddenLibrary:d,hiddenWorkflowCategories:u=[]}=e,f=(0,n.useContext)(k.Z);var v=(o=(0,T._)(function*(){if(l)return{type:"WorkFlowTemplateTag",data:[]};var e,t,o=(null!==(t=null===(e=(yield A.yF.PublicGetProductCategoryList({entity_type:S._J.TemplateCommon,need_empty_category:!1})).data)||void 0===e?void 0:e.categories)&&void 0!==t?t:[]).map(e=>{var t;return{type:e.id,name:null!==(t=e.name)&&void 0!==t?t:"",icon:e.icon_url,active_icon:e.active_icon_url}});return o.unshift({type:"recommend",name:c.o.t("workflowstore_category1"),icon:(0,a.jsx)(N.Zgu,{}),active_icon:(0,a.jsx)(N.Zgu,{})}),o.unshift({type:"all",name:c.o.t("All"),icon:(0,a.jsx)(N.qIi,{}),active_icon:(0,a.jsx)(N.qIi,{})}),{type:"PublicGetProductCategoryList",data:o}}),function(){return o.apply(this,arguments)}),g=(0,n.useMemo)(()=>(null==f?void 0:f.modalState)?f.modalState.dataSourceType===p.ye.Product?f.modalState.productCategory:f.modalState.workflowTag:"",[null==f?void 0:f.modalState]),h=(0,n.useMemo)(()=>{var e=["workflow-modal-side"];return e.push("flowMode-".concat(null==f?void 0:f.flowMode)),e},[f]),{data:_}=(0,E.a)({enabled:!!f,queryKey:h,queryFn:v});(0,n.useImperativeHandle)(t,()=>({getCurrent:()=>null==_?void 0:_.data.find(e=>e.type===g)}));var x=e=>{null==f||f.updateModalState({isSpaceWorkflow:e!==p.BD.Example,workflowCategory:e,workflowTag:0,query:"",dataSourceType:p.ye.Workflow,productCategory:e,sortType:void 0})},w=(0,n.useMemo)(()=>{var e=d?[]:[{title:c.o.t("project_resource_modal_library_resources",{resource:c.o.t("library_resource_type_workflow")}),icon:(0,a.jsx)(N.Iqn,{className:Y["tool-tag-list-cell-icon"]}),testId:"workflow.modal.search.option.library",category:p.BD.Library}];return r===m.w.ProjectWorkflowAddNode&&e.push({title:c.o.t("project_resource_modal_project_resources",{resource:c.o.t("library_resource_type_workflow")}),icon:(0,a.jsx)(N.Iqn,{className:Y["tool-tag-list-cell-icon"]}),testId:"workflow.modal.search.option.project",category:p.BD.Project}),e.push({title:c.o.t("workflow_add_example"),icon:(0,a.jsx)(N.Iqn,{className:Y["tool-tag-list-cell-icon"]}),testId:"workflow.modal.search.option.example",category:p.BD.Example}),e.filter(e=>!u.includes(e.category))},[r,d,u]);return f?(0,a.jsx)("div",{className:"tool-tag-list ".concat(Y["tool-tag-list"]),children:!i&&(0,a.jsx)("div",{children:w.map(e=>{var t=(null==f?void 0:f.modalState.workflowCategory)===e.category;return(0,a.jsxs)("div",{"data-testid":e.testId,className:s()(Y["tool-tag-list-cell"],{[Y.active]:t}),onClick:()=>x(e.category),children:[e.icon,e.title]},e.testId)})})}):null});H.displayName="WorkflowFilter";var G=o("1179"),J=o("523192"),q=e=>{var{spaceId:t,customCheck:o}=e;return(0,a.jsx)(G.rE,{spaceId:t,className:"mt-1",forms:{[G.b0.Workflow]:J.b},customCheck:o})},X=o("383672"),Q=o("182956");var $=((r={}).Title="title",r.NavigationMy="navigation_my",r.NavigationTeam="navigation_team",r.NavigationExplore="navigation_explore",r.TabAll="tab_all",r.TabMine="tab_mine",r.ListEmptyTitle="list_empty_title",r.CreatedListEmptyTitle="created_list_empty_title",r.CreatedListEmptyDescription="created_list_empty_description",r.NavigationCreate="navigation_create",r.ListError="list_error",r.ListItemRemove="list_item_remove",r.ListItemRemoveConfirmTitle="list_item_remove_confirm_title",r.ListItemRemoveConfirmDescription="list_item_remove_confirm_description",r),ee={[d.wz8.Workflow]:{title:"workflow_add_title",navigation_my:"workflow_add_navigation_my",navigation_team:"workflow_add_navigation_team",navigation_explore:"workflow_add_navigation_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"workflow_add_list_empty_title",created_list_empty_title:"workflow_add_created_list_empty_title",created_list_empty_description:"workflow_add_created_list_empty_description",navigation_create:"workflow_add_create_library",list_error:"workflow_add_list_added_id_empty",list_item_remove:"workflow_add_list_remove",list_item_remove_confirm_title:"workflow_add_remove_confirm_title",list_item_remove_confirm_description:"workflow_add_remove_confirm_content"},[d.wz8.Imageflow]:{title:"imageflow_add",navigation_my:"workflow_add_navigation_my",navigation_team:"imageflow_workspace2",navigation_explore:"imageflow_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"imageflow_detail_no_search_result",created_list_empty_title:"imageflow_title",created_list_empty_description:"imageflow_title_description",navigation_create:"imageflow_create",list_error:"imageflow_add_toast_error",list_item_remove:"workflow_add_list_remove",list_item_remove_confirm_title:"workflow_add_remove_confirm_title",list_item_remove_confirm_description:"workflow_add_remove_confirm_content"},[d.wz8.SceneFlow]:{title:"scene_workflow_popup_title",navigation_my:"workflow_add_navigation_my",navigation_team:"workflow_add_navigation_team",navigation_explore:"workflow_add_navigation_explore",tab_all:"workflow_add_created_tab_all",tab_mine:"workflow_add_created_tab_mine",list_empty_title:"scene_workflow_popup_search_empty",created_list_empty_title:"scene_workflow_popup_list_empty",created_list_empty_description:"",navigation_create:"workflow_add_navigation_create",list_error:"workflow_add_list_added_id_empty",list_item_remove:{key:"scene_workflow_delete_workflow_button",options:{source:c.o.t("scene_mkpl_search_title")}},list_item_remove_confirm_title:{key:"scene_workflow_delete_workflow_popup_title",options:{source:c.o.t("scene_mkpl_search_title")}},list_item_remove_confirm_description:{key:"scene_workflow_delete_workflow_popup_subtitle",options:{source:c.o.t("scene_mkpl_search_title")}}}};function et(){var e,t=(0,n.useContext)(k.Z),o=null!==(e=null==t?void 0:t.flowMode)&&void 0!==e?e:d.wz8.Workflow;return{i18nText:e=>{var r,i,a,n=(null==t?void 0:null===(r=t.i18nMap)||void 0===r?void 0:r[e])||(null===(i=ee[o])||void 0===i?void 0:i[e])||(null===(a=ee[d.wz8.Workflow])||void 0===a?void 0:a[e]),l="string"==typeof n?n:n.key;return c.o.t(l||"",null==n?void 0:n.options)},ModalI18nKey:$}}var eo=o("13904"),er=o("192073"),ei=o("533512"),ea=e=>{var t,o,{className:r,onCreateSuccess:i,nameValidators:l,from:s}=e,d=(0,n.useContext)(k.Z),{i18nText:u,ModalI18nKey:p}=et(),f=(0,ei.d)(),[v,g]=(0,n.useState)(null!==(o=null==d?void 0:d.flowMode)&&void 0!==o?o:X.WorkflowMode.Workflow);if(!d)return null;var{createModalVisible:h,setCreateModalVisible:_,bindBizType:x}=d,w=x===X.BindBizType.DouYinBot||s===m.w.WorkflowAgent,b=[{label:c.o.t("workflow_add_navigation_create"),handler:()=>{g(X.WorkflowMode.Workflow),_(!0)},icon:(0,a.jsx)(N.eTH,{})},{label:c.o.t("wf_chatflow_81"),handler:()=>{g(X.WorkflowMode.ChatFlow),_(!0)},icon:(0,a.jsx)(N.TLD,{})}];return(0,a.jsxs)(a.Fragment,{children:[w?(0,a.jsx)(Q.Button,{className:r,color:"hgltplus",onClick:()=>{s===m.w.WorkflowAgent?g(X.WorkflowMode.ChatFlow):g(X.WorkflowMode.Workflow),_(!0)},children:s===m.w.WorkflowAgent?c.o.t("wf_chatflow_81"):c.o.t("workflow_add_navigation_create")}):(0,a.jsx)(Q.Menu,{trigger:"click",position:"bottom",render:(0,a.jsx)(Q.Menu.SubMenu,{className:"w-[198px]",mode:"menu",children:b.map(e=>(0,a.jsx)(Q.Menu.Item,{onClick:(t,o)=>{o.stopPropagation(),e.handler()},icon:e.icon,children:e.label},e.label))}),children:(0,a.jsx)(Q.Button,{className:r,color:"hgltplus",icon:(0,a.jsx)(N.Wdl,{}),iconPosition:"right",children:d.projectId?c.o.t("wf_chatflow_03"):u(p.NavigationCreate)})}),(0,a.jsx)(eo.d,{initConfirmDisabled:!0,mode:"add",flowMode:v,bindBizType:d.bindBizType,bindBizId:d.bindBizId,projectId:d.projectId,visible:h,onCancel:()=>_(!1),onSuccess:(t=(0,T._)(function*(e){var t,{workflowId:o,flowMode:r}=e;if(_(!1),!o)throw new y.sH("[Workflow] create failed","create workflow failed, no workflow id");yield(0,er.Dc)(500),i?null==i||i({spaceId:d.spaceId,workflowId:o,flowMode:r||X.WorkflowMode.Workflow}):f({workflowId:o,spaceId:null!==(t=d.spaceId)&&void 0!==t?t:""})}),function(e){return t.apply(this,arguments)}),nameValidators:l})]})},en=(0,n.forwardRef)((e,t)=>{var o=(0,n.useContext)(k.Z),{hiddenCreate:r,hiddenExplore:i,from:l,enableImportByFile:s,importByFileCustomCheck:d}=e,c=I();return o?(0,a.jsxs)(u.yh,{style:{paddingTop:16},children:[(0,a.jsxs)(u.yh.Header,{children:[c,!r&&(0,a.jsx)(ea,{className:"!mt-6 w-full",onCreateSuccess:e.onCreateSuccess,nameValidators:e.nameValidators,from:l}),s?(0,a.jsx)(q,{spaceId:o.spaceId,customCheck:d}):null]}),(0,a.jsx)(u.yh.Content,{children:(0,a.jsx)(H,{ref:t,from:e.from,hiddenExplore:i,hiddenSpaceList:e.hiddenSpaceList,hiddenLibrary:e.hiddenLibrary,hiddenWorkflowCategories:e.hiddenWorkflowCategories})})]}):null});en.displayName="WorkflowModalSider";var el=o("441750"),es={};es.styleTagTransform=V(),es.setAttributes=D(),es.insert=L().bind(null,"head"),es.domAPI=z(),es.insertStyleElement=F(),M()(el.Z,es);var ed=el.Z&&el.Z.locals?el.Z.locals:void 0,ec=()=>[{label:c.o.t("workflow_list_status_all"),value:p.aJ},{label:c.o.t("workflow_list_status_published"),value:d.VBX.HadPublished},{label:c.o.t("workflow_list_status_unpublished"),value:d.VBX.UnPublished}],eu=e=>e?ec():ec().filter(e=>e.value!==p.aJ),ep=e=>{var t,o=(0,n.useContext)(k.Z),r=I();if(!o)return null;var{updateModalState:i,flowMode:l}=o,{status:s}=o.modalState,{filterOptionShowAll:d=!1}=e,u=c.o.t(null===(t=ee[l])||void 0===t?void 0:t[$.Title]);return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center w-full justify-between mt-[-4px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-[24px]",children:[(0,a.jsx)("div",{className:ed.titleForAvatar,children:u}),(0,a.jsx)(Q.Select,{insetLabel:c.o.t("publish_list_header_status"),showClear:!1,value:s,optionList:eu(d),onChange:e=>{i({status:e})}})]}),(0,a.jsxs)("div",{className:"flex items-center gap-[12px] mr-[12px]",children:[(0,a.jsx)("div",{className:"w-[208px]",children:r}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(ea,{onCreateSuccess:e.onCreateSuccess,nameValidators:e.nameValidators})})]})]}),(0,a.jsx)(Q.Banner,{type:"info",className:"mt-[16px] pt-[7px] pb-[7px] rounded-lg",description:c.o.t("dy_avatar_add_workflow_limit"),closeIcon:null})]})},em=o("524485"),ef=[{label:c.o.t("Popular",{},"\u6700\u53D7\u6B22\u8FCE"),value:S.ER.Heat},{label:c.o.t("mkpl_published",{},"\u6700\u8FD1\u53D1\u5E03"),value:S.ER.Newest}],ev=[{label:c.o.t("store_search_rank_default",{},"\u76F8\u5173\u6027"),value:S.ER.Relative}].concat(ef),eg=()=>{var e=(0,n.useContext)(k.Z),{updateModalState:t}=e,{query:o,sortType:r}=(null==e?void 0:e.modalState)||{};return(0,a.jsx)(u.Cj,{label:c.o.t("Sort"),value:r,optionList:o?ev:ef,onChange:e=>{t({sortType:e})}})},eh=o("818575"),e_={};e_.styleTagTransform=V(),e_.setAttributes=D(),e_.insert=L().bind(null,"head"),e_.domAPI=z(),e_.insertStyleElement=F(),M()(eh.Z,e_);var ex=eh.Z&&eh.Z.locals?eh.Z.locals:void 0,ew=e=>e?ec():ec().filter(e=>e.value!==p.aJ),ey=()=>[{label:c.o.t("filter_all"),value:X.WorkflowMode.All},{label:c.o.t("library_resource_type_workflow"),value:X.WorkflowMode.Workflow},{label:c.o.t("wf_chatflow_76"),value:X.WorkflowMode.ChatFlow}].filter(e=>(e.value,X.WorkflowMode.ChatFlow,!0)),eb=e=>{var t=(0,n.useContext)(k.Z),{i18nText:o,ModalI18nKey:r}=et(),i=(0,n.useMemo)(()=>t?[{label:o(r.TabAll),value:p.gp.All},{label:o(r.TabMine),value:p.gp.Mine}]:[],[]);if(!t)return null;var{spaceType:l,updateModalState:s,modalState:d}=t,{dataSourceType:m,isSpaceWorkflow:f,status:v,creator:g,listFlowMode:h,workflowCategory:_}=t.modalState,{hideSider:x,hiddenCreate:w,filterOptionShowAll:y=!1,hideCreatorSelect:j=!1,hiddenListFlowModeFilter:C=!1}=e,S=_===p.BD.Example,I=(0,em.D)(d);return(0,a.jsxs)("div",{className:"".concat(ex.header," ").concat(x?"w-full justify-between":""),children:[(f||S)&&m===p.ye.Workflow?(0,a.jsxs)(a.Fragment,{children:[C?null:(0,a.jsx)(u.Cj,{label:c.o.t("Type"),showClear:!1,value:h,optionList:ey(),onChange:e=>{s({listFlowMode:e})}}),I||S?null:(0,a.jsx)(u.Cj,{label:c.o.t("publish_list_header_status"),showClear:!1,value:v,optionList:ew(y),onChange:e=>{s({status:e})}}),l===b.Sn.Team&&!j&&!S&&(0,a.jsx)(u.Cj,{label:c.o.t("Creator"),showClear:!1,value:g,onChange:e=>{s({creator:e})},optionList:i})]}):null,x?(0,a.jsx)("div",{className:"flex items-center mr-[-24px]",children:!w&&(0,a.jsx)(ea,{className:"ml-12px",onCreateSuccess:e.onCreateSuccess,nameValidators:e.nameValidators})}):null,m===p.ye.Product?(0,a.jsx)(eg,{}):null]})},ek=o("345305"),ej=o("475210"),eC=o("967756"),eS=o("142969"),eI=o("911379"),eT=o("155884"),eE=o("495778"),eN=o("302050"),eA=o("462458"),eP=o("716486"),eM=o("114798"),eR=o.n(eM),ez=o("646411"),eZ=e=>{var{data:t,onImport:o}=e,r=(null==t?void 0:t.plugin_id)&&(null==t?void 0:t.plugin_id)!=="0",i=(0,a.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,a.jsx)(Q.Button,{disabled:!r,color:"primary","data-testid":"workflow.modal.add",onClick:e=>{e.stopPropagation(),(null==t?void 0:t.workflow_id)&&(null==o||o({workflow_id:t.workflow_id,name:t.name||""}))},children:c.o.t("project_resource_modal_copy_to_project")})});return r?i:(0,a.jsx)(Q.Tooltip,{position:"top",content:c.o.t("project_toast_only_published_resources_can_be_imported"),children:i})},eL=o("459769"),eB=o("696636"),eD={};eD.styleTagTransform=V(),eD.setAttributes=D(),eD.insert=L().bind(null,"head"),eD.domAPI=z(),eD.insertStyleElement=F(),M()(eB.Z,eD);var eO=eB.Z&&eB.Z.locals?eB.Z.locals:void 0,{Paragraph:eF,Text:eW}=Q.Typography,eV=e=>{var{type:t,format:o,assist_type:r}=e,i="";return t&&(i=t===d.n$I.String&&o===d.vGB.ImageUrl?"Image":t===d.n$I.String&&r?eI.Tg[r]:eI.fw[t]),i},eU=e=>{var{children:t,items:o}=e;return(0,a.jsx)(u.J2,{stopPropagation:!0,position:"top",spacing:0,content:(0,a.jsx)("div",{className:eO.popover,children:o.map((e,t)=>(0,a.jsxs)("div",{className:eO.item,children:[(0,a.jsxs)("div",{className:eO.header,children:[(0,a.jsx)(eW,{ellipsis:{showTooltip:{opts:{content:e.name||"",position:"top",style:{wordBreak:"break-word"}}}},children:(0,a.jsx)("span",{className:eO.name,children:e.name||"-"})}),(0,a.jsx)("span",{className:eO.type,children:e.type||"-"}),!!e.required&&(0,a.jsx)("span",{className:eO.required,children:c.o.t("workflow_add_parameter_required")})]}),(0,a.jsx)("div",{className:eO.footer,children:(0,a.jsx)(eF,{ellipsis:{rows:2,showTooltip:{opts:{content:e.desc||"",position:"top",style:{wordBreak:"break-word"}}}},children:(0,a.jsx)("span",{className:eO.footer,children:e.desc||"-"})})})]},"item".concat(t)))}),children:t})},eK=e=>{var t,o,r,i,l,d,c,m,{data:g,style:h,className:_}=e,x=(0,n.useContext)(k.Z);var w=(m=0,(null==x?void 0:x.modalState.dataSourceType)===p.ye.Workflow)?(null===(c=g.start_node)||void 0===c?void 0:null===(d=c.node_param)||void 0===d?void 0:null===(l=d.input_parameters)||void 0===l?void 0:l.map(e=>{var t=eV(e);return{name:e.name,desc:e.desc,required:e.required,type:t}}))||[]:(null==g?void 0:null===(i=g.workflow_extra)||void 0===i?void 0:null===(r=i.start_node)||void 0===r?void 0:null===(o=r.node_param)||void 0===o?void 0:null===(t=o.input_parameters)||void 0===t?void 0:t.map(e=>{var t=eV((0,v._)((0,f._)({},e),{type:e.input_type}));return{name:e.name,desc:e.desc,required:e.is_required,type:t}}))||[];return(0,a.jsx)("div",{className:s()(eO.container,_),style:h,children:(0,a.jsx)("div",{className:eO.wrapper,children:(0,a.jsx)(u.Dj,{items:w,overflowRenderer:e=>{var t=e.slice(-1*e.length);return t.length?(0,a.jsx)(eU,{items:w,children:(0,a.jsx)("div",{children:(0,a.jsxs)(Q.Tag,{style:{flex:"0 0 auto"},size:"mini",color:"primary",children:["+",t.length]})})}):null},visibleItemRenderer:e=>(0,a.jsx)(eU,{items:w,children:(0,a.jsx)("div",{style:{marginRight:8},children:(0,a.jsx)(Q.Tag,{size:"mini",color:"primary",children:e.name})})})})})})},eY=o("498842"),eH=e=>{var{className:t,onDelete:o}=e,[r,i]=(0,n.useState)(!1),l=()=>i(!1);return(0,a.jsx)("div",{className:t,onClick:e=>e.stopPropagation(),children:(0,a.jsx)(Q.Popconfirm,{visible:r,title:c.o.t("scene_workflow_popup_delete_confirm_title"),content:c.o.t("scene_workflow_popup_delete_confirm_subtitle"),okText:c.o.t("shortcut_modal_confirm"),cancelText:c.o.t("shortcut_modal_cancel"),trigger:"click",position:"bottomRight",onConfirm:()=>new Promise((e,t)=>{null==o||o().then(()=>{l(),e(!0)}).catch(e=>{eY.kg.error({error:e,eventName:"delete workflow error"}),t(e)})}),onCancel:l,okButtonColor:"red",children:(0,a.jsx)(Q.IconButton,{icon:(0,a.jsx)(N.dVD,{}),type:"primary",onClick:e=>{e.stopPropagation(),i(!0)}})})})},eG=o("545145"),eJ=o("513747"),eq={};eq.styleTagTransform=V(),eq.setAttributes=D(),eq.insert=L().bind(null,"head"),eq.domAPI=z(),eq.insertStyleElement=F(),M()(eJ.Z,eq);var eX=eJ.Z&&eJ.Z.locals?eJ.Z.locals:void 0,eQ=e=>{var[t,{setFalse:o,setTrue:r}]=(0,eG.Z)(!1),{i18nText:i,ModalI18nKey:n}=et();return(0,a.jsx)(Q.Button,(0,v._)((0,f._)({},e),{color:t?"red":"primary",className:s()({[eX.button]:!0,[eX.moreLevel]:!0}),onMouseEnter:()=>{r()},onMouseLeave:()=>{o()},"data-testid":"workflow.modal.button.added",children:t?i(n.ListItemRemove):c.o.t("workflow_add_list_added")}))},e$=o("383968"),e0={};e0.styleTagTransform=V(),e0.setAttributes=D(),e0.insert=L().bind(null,"head"),e0.domAPI=z(),e0.insertStyleElement=F(),M()(e$.Z,e0);var e1=e$.Z&&e$.Z.locals?e$.Z.locals:void 0,e2=e=>{var{data:t,style:o,isAdded:r,onAdd:i,onRemove:l,className:d,from:p,workflowNodes:f,loading:v,hideAddedCount:g}=e,{plugin_id:h}=t||{},_=p===m.w.WorkflowAddNode||p===m.w.ProjectWorkflowAddNode,x=(0,n.useContext)(k.Z),w=(0,em.D)(null==x?void 0:x.modalState),y="0"!==h||w,[b,j]=(0,n.useState)((f||[]).length),C=p===m.w.WorkflowAgent,S=(0,n.useMemo)(()=>{var e;return null==t?void 0:null===(e=t.check_result)||void 0===e?void 0:e.find(e=>e.type===X.CheckType.BotAgent)},[t]),{i18nText:I,ModalI18nKey:E}=et();return(0,a.jsx)("div",{className:s()(e1.container,d),style:o,onClick:e=>e.stopPropagation(),children:(()=>{if(C&&S&&!S.is_pass)return(0,a.jsx)(u.u,{position:"top",className:e1.not_publish_tooltip,content:(0,a.jsx)("span",{className:e1.content,children:S.reason}),children:(0,a.jsx)(Q.LoadingButton,{disabled:!0,color:"primary",className:e1.button,"data-testid":"workflow.modal.add",children:c.o.t("workflow_add_list_add")})});if(r)return(0,a.jsx)(u.gn,{title:I(E.ListItemRemoveConfirmTitle),content:I(E.ListItemRemoveConfirmDescription),okType:"danger",position:"topRight",onConfirm:l,zIndex:9999,okText:c.o.t("neutral_age_gate_confirm",{},"Confirm"),cancelText:c.o.t("workflow_240218_17",{},"Cancel"),children:(0,a.jsx)("div",{children:(0,a.jsx)(eQ,{})})});if(!y){var e="workflow_add_not_allow_before_publish";return _&&(e="wf_node_add_wf_modal_tip_must_publish_to_add"),(0,a.jsx)(u.u,{position:"top",className:e1.not_publish_tooltip,content:(0,a.jsx)("span",{className:e1.content,children:c.o.t(e)}),children:(0,a.jsx)(Q.LoadingButton,{disabled:!0,color:"primary",className:e1.button,"data-testid":"workflow.modal.add",children:c.o.t("workflow_add_list_add")})})}return r?null:(0,a.jsxs)(Q.LoadingButton,{onClick:(0,T._)(function*(){(yield null==i?void 0:i())&&j(e=>e+1)}),color:"primary",className:e1.button,"data-testid":"workflow.modal.add",children:[c.o.t("workflow_add_list_add"),_&&0!==b&&!g?(0,a.jsx)("span",{className:e1.workflow_count_span,children:b}):null]})})()})},e6=o("379602"),e4={};e4.styleTagTransform=V(),e4.setAttributes=D(),e4.insert=L().bind(null,"head"),e4.domAPI=z(),e4.insertStyleElement=F(),M()(e6.Z,e4);var e3=e6.Z&&e6.Z.locals?e6.Z.locals:void 0,{Text:e8}=Q.Typography,e5=e=>eR().unix(Number(e)).format("YYYY-MM-DD"),e9=[],e7=e=>{var t,{data:o,workFlowList:r=e9,from:i,workflowNodes:l,dupText:g,itemShowDelete:h,hideAddedCount:_,disableExternalLinks:x}=e,w=(0,n.useContext)(k.Z),y=null==o?void 0:null===(t=o.meta_info)||void 0===t?void 0:t.is_professional,{dupWorkflowTpl:b,addWorkflow:j,removeWorkflow:C,deleteWorkflow:S,itemClick:I}=(0,eL.u)((0,v._)((0,f._)({},e),{isProfessionalTemplate:y}));if(!w)return null;var E={unpublished:{label:c.o.t("workflow_add_status_unpublished"),icon:(0,a.jsx)(N.gO2,{className:"coz-fg-dim text-xs"})},published:{label:c.o.t("workflow_add_status_published"),icon:(0,a.jsx)(N.nAC,{className:"text-xs coz-fg-hglt-green"})}},{orderBy:A,spaceType:P}=w,{creator:M,status:R,isSpaceWorkflow:z,workflowCategory:Z}=w.modalState,L=P===ez.Sn.Team;function B(e){return(null==w?void 0:w.modalState.dataSourceType)===p.ye.Workflow}var D=B(o)?o.plugin_id:"",O=!(0,eA.Z)(D)&&z?E["0"===D?"unpublished":"published"]:void 0;return(0,a.jsxs)("div",{className:e3.container,onClick:()=>{x?(0,eP.Z)():I()},children:[(0,a.jsx)("div",{className:e3.left,children:(0,a.jsx)("div",{className:e3.icon,children:(0,a.jsx)(u.Ee,{preview:!1,src:B(o)?o.url:o.meta_info.icon_url})})}),(0,a.jsxs)("div",{className:e3.center,children:[(0,a.jsx)("div",{className:e3.header,children:(0,a.jsxs)("div",{className:e3.title_wrapper,children:[(0,a.jsx)(e8,{ellipsis:{showTooltip:!0},className:e3.title,children:B(o)?o.name:o.meta_info.name}),(0,em.D)(null==w?void 0:w.modalState)||Z===p.BD.Example?null:O?(0,a.jsxs)("div",{className:s()(e3.status),children:[O.icon,(0,a.jsx)("span",{className:e3.text,children:O.label})]}):null]})}),(0,a.jsx)("div",{className:e3.content,children:(0,a.jsx)(e8,{ellipsis:{showTooltip:{opts:{style:{maxWidth:600,wordBreak:"break-word"}}}},className:e3.desc,children:(B(o)?o.desc:o.meta_info.description)||""})}),(0,a.jsxs)("div",{className:e3.footer,children:[(0,a.jsx)(eK,{data:o}),(()=>{if(!B(o)){var e,t,r,n,l,s="".concat(c.o.t("workflow_add_list_updated")," ").concat(e5(o.meta_info.listed_at));return(0,a.jsxs)("div",{className:e3.info,children:[(0,a.jsxs)("div",{className:e3.creator,children:[(0,a.jsx)(u.qE,{className:e3["creator-avatar"],src:null===(e=o.meta_info.user_info)||void 0===e?void 0:e.avatar_url}),(0,a.jsx)(e8,{ellipsis:{showTooltip:!0},className:e3["creator-name"],children:null!==(l=null===(t=o.meta_info.user_info)||void 0===t?void 0:t.name)&&void 0!==l?l:c.o.t("workflow_add_list_unknown")}),(0,a.jsx)("span",{className:e3.symbol,children:"|"})]}),(0,a.jsx)("span",{className:e3.date,children:s}),(Number(null==o?void 0:null===(r=o.workflow_extra)||void 0===r?void 0:r.duplicate_count)||0)>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:e3.symbol,children:"|"}),(0,a.jsxs)(e8,{className:e3.date,children:[Number(null==o?void 0:null===(n=o.workflow_extra)||void 0===n?void 0:n.duplicate_count)||0," ",c.o.t("workflowstore_card_duplicate")]})]}):null]})}if(z||Z===p.BD.Example){var f,v,g,h=M!==p.gp.Mine&&L||i===m.w.ProjectImportLibrary,_=A===d.d$J.CreateTime?"".concat(c.o.t("workflow_add_list_created")," ").concat(e5(o.create_time)):R===d.VBX.HadPublished?"".concat(c.o.t("workflow_add_list_publised")," ").concat(e5(o.update_time)):"".concat(c.o.t("workflow_add_list_updated")," ").concat(e5(o.update_time));return(0,a.jsxs)("div",{className:e3.info,children:[h?(0,a.jsxs)("div",{className:e3.creator,children:[(0,a.jsx)(u.qE,{className:e3["creator-avatar"],src:null===(f=o.creator)||void 0===f?void 0:f.avatar_url}),(0,a.jsx)(e8,{ellipsis:{showTooltip:!0},className:e3["creator-name"],children:null!==(g=null===(v=o.creator)||void 0===v?void 0:v.name)&&void 0!==g?g:c.o.t("workflow_add_list_unknown")}),(0,a.jsx)("span",{className:e3.symbol,children:"|"})]}):null,(0,a.jsx)("span",{className:e3.date,children:_})]})}return z?null:(0,a.jsxs)("div",{className:e3.creator,children:[(0,a.jsx)(u.Ee,{preview:!1,src:o.template_author_picture_url,className:e3.avatar}),(0,a.jsx)(e8,{ellipsis:{showTooltip:!0},className:e3.name,children:o.template_author_name||"-"})]})})()]})]}),(0,a.jsx)("div",{className:e3.right,children:(0,a.jsx)("div",{className:e3.buttons,children:(()=>{if(Z===p.BD.Example&&B(o)){var t,n,s=null==o?void 0:null===(n=o.check_result)||void 0===n?void 0:n.find(e=>e.type===X.CheckType.BotAgent);var d=(0,a.jsx)(Q.LoadingButton,{color:"primary","data-testid":"workflow.modal.add",disabled:s&&!(null==s?void 0:s.is_pass),onClick:(t=(0,T._)(function*(e){e.stopPropagation(),yield b()}),function(e){return t.apply(this,arguments)}),children:g||c.o.t("workflowstore_duplicate_and_add")});return s&&!s.is_pass&&s.reason?(0,a.jsx)(u.u,{content:s.reason,children:d}):d}return i===m.w.ProjectImportLibrary?(0,a.jsx)(eZ,{data:o,onImport:e.onImport}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e2,{isAdded:r.some(e=>e.workflow_id===(null==o?void 0:o.workflow_id)),workflowNodes:l,from:i,data:o,onAdd:()=>j(),onRemove:()=>{C()},hideAddedCount:_}),h?(0,a.jsx)(eH,{className:"ml-[4px]",onDelete:S}):null]})})()})})]})},te=o("291318"),tt={};tt.styleTagTransform=V(),tt.setAttributes=D(),tt.insert=L().bind(null,"head"),tt.domAPI=z(),tt.insertStyleElement=F(),M()(te.Z,tt);var to=te.Z&&te.Z.locals?te.Z.locals:void 0,tr=e=>{var t,o,{excludedWorkflowIds:r,from:i,projectId:l}=e,s=(0,n.useContext)(k.Z),{i18nText:v,ModalI18nKey:g}=et(),{updatePageParam:h,isFetching:x,workflowList:w,fetchNextPage:y,loadingStatus:b,refetch:j,hasNextPage:C,handleDelete:I,status:T}=(0,eE.S)({pageSize:10,enabled:(null==s?void 0:s.modalState.dataSourceType)===p.ye.Workflow,from:i,fetchWorkflowListApi:(null==s?void 0:null===(o=s.modalState)||void 0===o?void 0:o.workflowCategory)!==p.BD.Example?_.OHc.GetWorkFlowList.bind(_.OHc):_.OHc.GetExampleWorkFlowList.bind(_.OHc)}),{workflowProductList:E,updatePageParam:A,fetchNextPage:P,isFetching:M,loadingStatus:R,hasNextPage:z,copyProduct:Z}=(0,eN.e)({pageSize:10,enabled:(null==s?void 0:s.modalState.dataSourceType)===p.ye.Product});(0,n.useEffect)(()=>{if(!!s){var{modalState:e,flowMode:t}=s;if(e.dataSourceType===p.ye.Workflow){var o,r,i=(0,em.D)(e);!e.isSpaceWorkflow&&(o=e.query?1:e.workflowTag),e.workflowCategory===p.BD.Example?(o=d.Vp9.All,r=d.uql.GuanFang):r=e.isSpaceWorkflow?d.uql.User:d.uql.GuanFang;var a=void 0;e.isSpaceWorkflow&&(a=e.status===p.aJ||i?void 0:e.status),h({space_id:s.spaceId,flow_mode:e.listFlowMode,name:e.query,order_by:e.isSpaceWorkflow?s.orderBy:void 0,status:a,type:r,project_id:(0,em.D)(e)?l:void 0,login_user_create:e.isSpaceWorkflow?e.creator===p.gp.Mine:void 0,tags:o,bind_biz_type:s.bindBizType,bind_biz_id:s.bindBizId})}else"recommend"===e.productCategory?A({keyword:e.query,sort_type:e.sortType,category_id:void 0,source:S.QJ.Recommend,entity_type:(0,_.ikd)(t)?S._J.WorkflowTemplateV2:S._J.ImageflowTemplateV2}):"all"===e.productCategory?A({keyword:e.query,sort_type:e.sortType,category_id:void 0,source:void 0,entity_type:(0,_.ikd)(t)?S._J.WorkflowTemplateV2:S._J.ImageflowTemplateV2}):A({keyword:e.query,sort_type:e.sortType,category_id:e.productCategory,source:void 0,entity_type:(0,_.ikd)(t)?S._J.WorkflowTemplateV2:S._J.ImageflowTemplateV2})}},[s]),(0,G.HY)({onSuccess:e=>{T===d.VBX.HadPublished?null==s||s.updateModalState({status:d.VBX.UnPublished}):j()},spaceId:(null==s?void 0:s.spaceId)||"",resType:G.b0.Workflow});var{nodes:L}=(0,eT.I)((0,ek.N)(e=>({nodes:e.nodes}))),B=(0,n.useMemo)(()=>{var e=L.filter(e=>e.type===eI.ny.SubWorkflow);return(0,ej.Z)(e,e=>{var t,o;return null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(t=o.inputs)||void 0===t?void 0:t.workflowId})},[L]),D=(0,n.useMemo)(()=>r?w.filter(e=>!r.includes(e.workflow_id||"")):w,[r,w]),O=(0,n.useRef)(null),F=(0,n.useRef)(null),[W]=(0,eC.Z)(F,{root:()=>O.current,threshold:.8});if((0,eS.Z)(()=>{O.current&&O.current.scrollTo({top:0})},[null==s?void 0:s.modalState]),(0,n.useEffect)(()=>{if(!!W)if(K===p.ye.Workflow){if("success"!==b||x||!C)return;y()}else{if("success"!==R||M||!z)return;P()}},[W,b,x,C,R,M,z]),(0,n.useEffect)(()=>{if(!!(null==s?void 0:s.modalState.isSpaceWorkflow)){var e=()=>{"visible"===document.visibilityState&&j()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}},[null==s?void 0:s.modalState.isSpaceWorkflow,j]),!s)return null;function V(e){return(null==s?void 0:s.modalState.dataSourceType)===p.ye.Workflow}var{modalState:U}=s,{dataSourceType:K}=s.modalState,Y=K===p.ye.Workflow?b:R,H=K===p.ye.Workflow?C:z,J=K===p.ye.Workflow?D:E,q=i===m.w.WorkflowAgent;return(0,a.jsx)(u.vy,{children:(0,a.jsx)(Q.Spin,{spinning:"pending"===Y,wrapperClassName:to.spin,style:{height:"100%",width:"100%"},children:(0,a.jsxs)("div",{className:"".concat(to["workflow-content"]," new-workflow-modal-content"),ref:O,children:["pending"!==Y&&J.length>0&&(0,a.jsxs)(u.vy.Content,{style:{minHeight:"100%",paddingBottom:q?"60px":0},children:[(0,a.jsx)(a.Fragment,{children:J.map(t=>{var o;return(0,a.jsx)(e7,(0,f._)({data:t,itemShowDelete:(null==s?void 0:s.bindBizType)===d.k5N.DouYinBot,workflowNodes:V(t)&&null!==(o=B[t.workflow_id||""])&&void 0!==o?o:[],handleDeleteWorkflow:I,copyProductHandle:Z},e),V(t)?t.workflow_id:t.meta_info.entity_id)})}),H?(0,a.jsx)("div",{ref:F,children:(0,a.jsxs)("div",{className:to["loading-more"],children:[(0,a.jsx)(N.j2n,{className:"animate-spin coz-fg-dim mr-[4px]"}),(0,a.jsx)("div",{children:c.o.t("Loading")})]})}):null]}),"success"===Y&&0===J.length&&(t=!!U.query,(0,a.jsx)(u.YZ,{isNotFound:t,notFound:{title:v(g.ListEmptyTitle)},empty:{title:v(g.CreatedListEmptyTitle),description:v(g.CreatedListEmptyDescription)}}))]})})})},ti=e=>{var{flowMode:t=d.wz8.Workflow,initState:o,hideSider:r=!1,bindBizId:i,bindBizType:l,projectId:s,i18nMap:u,from:j}=e,{space_type:C,id:S}=(0,w.rY)(e=>e.space),I=(0,n.useRef)(null),[T,E]=(0,n.useState)({status:null!==(F=null==o?void 0:o.status)&&void 0!==F?F:d.VBX.HadPublished,dataSourceType:null!==(W=null==o?void 0:o.dataSourceType)&&void 0!==W?W:p.ye.Workflow,creator:null!==(V=null==o?void 0:o.creator)&&void 0!==V?V:p.gp.All,workflowTag:null!==(U=null==o?void 0:o.workflowTag)&&void 0!==U?U:0,productCategory:null!==(K=null==o?void 0:o.productCategory)&&void 0!==K?K:"",query:null!==(Y=null==o?void 0:o.query)&&void 0!==Y?Y:"",isSpaceWorkflow:null===(H=null==o?void 0:o.isSpaceWorkflow)||void 0===H||H,workflowCategory:j===m.w.ProjectWorkflowAddNode?p.BD.Project:p.BD.Library,listFlowMode:null!==(G=null==o?void 0:o.listFlowMode)&&void 0!==G?G:d.wz8.All}),N=(0,n.useCallback)(e=>{E((0,f._)({},T,e))},[T]),[A,P]=(0,n.useState)(d.d$J.UpdateTime),[M,R]=(0,n.useState)(!1);(0,g.Z)(()=>{var t,r,i,a,n,l,s,c;E({status:null!==(t=null==o?void 0:o.status)&&void 0!==t?t:d.VBX.HadPublished,dataSourceType:null!==(r=null==o?void 0:o.dataSourceType)&&void 0!==r?r:p.ye.Workflow,creator:null!==(i=null==o?void 0:o.creator)&&void 0!==i?i:p.gp.All,workflowTag:null!==(a=null==o?void 0:o.workflowTag)&&void 0!==a?a:0,productCategory:null!==(n=null==o?void 0:o.productCategory)&&void 0!==n?n:"",query:null!==(l=null==o?void 0:o.query)&&void 0!==l?l:"",isSpaceWorkflow:null===(s=null==o?void 0:o.isSpaceWorkflow)||void 0===s||s,workflowCategory:j===m.w.ProjectWorkflowAddNode?p.BD.Project:p.BD.Library,listFlowMode:null!==(c=null==o?void 0:o.listFlowMode)&&void 0!==c?c:d.wz8.All}),er.E7.info({message:"useWorkflowModalParts mounted",meta:{from:e.from}})});var z={spaceId:null!=S?S:"",spaceType:null!=C?C:b.Sn.Team,bindBizId:i,bindBizType:l,projectId:s,flowMode:t,modalState:T,updateModalState:N,orderBy:A,setOrderBy:P,createModalVisible:M,setCreateModalVisible:R,getModalState:e=>(0,f._)({},e.modalState),i18nMap:u};if(!C||!S)return er.E7.errorEvent({eventName:"workflow_modal_in_bot_no_spaceId",error:new y.sH("normal_error","no spaceId")}),{sider:null,content:null,filter:null};var Z=l===d.k5N.DouYinBot,L=r||Z,B=L?null:(0,a.jsx)(h.aH,{client:d.fB_,children:(0,a.jsx)(k.Z.Provider,{value:z,children:(0,a.jsx)(en,(0,f._)({ref:I},e))})}),D=(0,a.jsx)(h.aH,{client:d.fB_,children:(0,a.jsx)(k.Z.Provider,{value:z,children:(0,a.jsx)(tr,(0,v._)((0,f._)({},e),{onDupSuccess:o=>{if(!!e.onDupSuccess){if(T.dataSourceType===p.ye.Product){var r,i,a,n=null!==(a=({[m.w.SpaceWorkflowList]:x.JN.template,[m.w.WorkflowAddNode]:x.JN.flowIde,[m.w.BotSkills]:x.JN.botIde,[m.w.BotMultiSkills]:x.JN.botIde,[m.w.BotTrigger]:x.JN.botIde,[m.w.BotShortcut]:x.JN.botIde,[m.w.WorkflowAgent]:x.JN.botIde})[e.from||""])&&void 0!==a?a:x.JN.botIde;(0,x.Gg)(x.Kg.flow_duplicate_click,{store_type:(0,_.ikd)(t)?x.Pv.workflow:x.Pv.imageflow,resource:n,category_name:(null===(i=I.current)||void 0===i?void 0:null===(r=i.getCurrent())||void 0===r?void 0:r.name)||"",duplicate_type:e.from===m.w.BotSkills?x.OX.toBot:x.OX.toWorkspace})}e.onDupSuccess(o)}}}))})}),O=(0,a.jsx)(h.aH,{client:d.fB_,children:(0,a.jsx)(k.Z.Provider,{value:z,children:Z?(0,a.jsx)(ep,(0,f._)({},e)):(0,a.jsx)(eb,(0,f._)({},e))})});if(L&&!Z){var F,W,V,U,K,Y,H,G,J,q=c.o.t(null===(J=ee[t])||void 0===J?void 0:J[$.Title]);O=(0,a.jsxs)("div",{className:"flex flex-col items-start flex-grow flex-shrink-0",children:[(0,a.jsx)("div",{className:ed.title,children:q}),O]})}return{sider:B,filter:O,content:D}},ta=e=>{var t,o,{className:r,visible:n,onClose:l}=e,p=(0,i._)(e,["className","visible","onClose"]),{sider:m,filter:f,content:v}=ti(p),g=null!==(o=p.flowMode)&&void 0!==o?o:d.wz8.Workflow,h=p.bindBizType===d.k5N.DouYinBot;return(0,a.jsx)(u.FS,{visible:n,onCancel:l,siderWrapperClassName:p.hideSider||h?"hidden":"",header:c.o.t(null===(t=ee[g])||void 0===t?void 0:t[$.Title]),className:s()(ed["workflow-modal"],r,"new-workflow-modal",h?ed["douyin-workflow-modal"]:""),sider:m,filter:f,content:v})}},647063:function(e,t,o){o.d(t,{BD:function(){return d},aJ:function(){return s},gp:function(){return n},ye:function(){return l}});var r,i,a,n=((r={}).All="1",r.Mine="2",r);var l=((i={}).Workflow="workflow",i.Product="product",i),s="all";var d=((a={}).Project="project",a.Library="library",a.Example="example",a)},524485:function(e,t,o){o.d(t,{D:function(){return i}});var r=o(647063),i=e=>(null==e?void 0:e.workflowCategory)===r.BD.Project},570395:function(e,t,o){var r=o(723530).createContext(null);t.Z=r},511126:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".wrap--KwLlPO8yKqAcE4UE{background:rgba(186,192,255,.2);border-radius:8px;display:flex;gap:16px;padding:12px 16px}.button--sR3GN8Zo3ggrgeP7,.icon--g97rGZQMU4xoAVWU{align-items:center;display:flex}.content--Xn4s2GofSKMWjAcV{flex:1 1}.content--Xn4s2GofSKMWjAcV .title--y3hexMJ0HQgBbGnS{font-size:16px;font-weight:500}.content--Xn4s2GofSKMWjAcV .desc--XLOlyFKgzn4R95yx{line-height:20px}",""]),n.locals={wrap:"wrap--KwLlPO8yKqAcE4UE",button:"button--sR3GN8Zo3ggrgeP7",icon:"icon--g97rGZQMU4xoAVWU",content:"content--Xn4s2GofSKMWjAcV",title:"title--y3hexMJ0HQgBbGnS",desc:"desc--XLOlyFKgzn4R95yx"},t.Z=n},467189:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".list--PZXFLD6GQG6UMJoa{max-height:152px;overflow-y:auto}.collaborator-item--xnFRZG9UM14HlgfR{align-items:center;box-sizing:border-box;display:flex;font-size:14px;gap:8px;height:40px;justify-content:flex-start;line-height:20px;padding:0 8px}.collaborator-item--xnFRZG9UM14HlgfR+.collaborator-item--xnFRZG9UM14HlgfR{border-top:1px solid var(--light-usage-border-color-border,rgba(29,28,35,.08))}.collaborator-avatar--QRPajj5sdWMMe0c7{line-height:1}.collaborator-name-wrapper--XWYBSDcEPcx2Q2aA{align-items:center;display:flex;flex:1 1;gap:4px;width:0}.collaborator-role--vDBi_JhQFiUAGsAw{color:var(--light-usage-text-color-text-1,rgba(29,28,35,.8));margin-left:8px}",""]),n.locals={list:"list--PZXFLD6GQG6UMJoa","collaborator-item":"collaborator-item--xnFRZG9UM14HlgfR",collaboratorItem:"collaborator-item--xnFRZG9UM14HlgfR","collaborator-avatar":"collaborator-avatar--QRPajj5sdWMMe0c7",collaboratorAvatar:"collaborator-avatar--QRPajj5sdWMMe0c7","collaborator-name-wrapper":"collaborator-name-wrapper--XWYBSDcEPcx2Q2aA",collaboratorNameWrapper:"collaborator-name-wrapper--XWYBSDcEPcx2Q2aA","collaborator-role":"collaborator-role--vDBi_JhQFiUAGsAw",collaboratorRole:"collaborator-role--vDBi_JhQFiUAGsAw"},t.Z=n},753804:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".custom-pop-style--HB2GEmH4lklph4Vc.coz-select-tag-popover.semi-popover-wrapper{background:var(--Bg-COZ-bg-max,#363d4d);padding:8px}.custom-pop-style--HB2GEmH4lklph4Vc.coz-select-tag-popover.semi-popover-wrapper svg{color:var(--Bg-COZ-bg-max,#363d4d)}.custom-pop-style--HB2GEmH4lklph4Vc.coz-select-tag-popover.semi-popover-wrapper .semi-popover-content{color:var(--Fg-COZ-fg-primary,#ffffffc9);display:flex;flex-wrap:wrap;gap:3px;max-width:240px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.custom-pop-style--HB2GEmH4lklph4Vc.coz-select-tag-popover.semi-popover-wrapper .semi-popover-content svg{color:var(--Fg-COZ-fg-primary,#ffffffc9)}.custom-pop-style--HB2GEmH4lklph4Vc.coz-select-tag-popover.semi-popover-wrapper .tag--Ek96f3Mh6T0np0w5{background:var(--Mg-COZ-mg-primary,#ffffff0f);pointer-events:none}.search-wrapper--ckOnOnQdZAAlOnoB .semi-select.semi-select-filterable .semi-select-selection{margin-left:3px}.search-wrapper--ckOnOnQdZAAlOnoB .semi-select.semi-select-filterable .semi-select-selection .semi-select-content-wrapper,.search-wrapper--ckOnOnQdZAAlOnoB .semi-select.semi-select-filterable .semi-select-selection .semi-tag-group{flex-wrap:nowrap;gap:2px}.search-wrapper--ckOnOnQdZAAlOnoB .semi-select.semi-select-filterable.semi-select-open .semi-select-content-wrapper,.search-wrapper--ckOnOnQdZAAlOnoB .semi-select.semi-select-filterable.semi-select-open .semi-tag-group{flex-wrap:wrap;padding-block:3px}.custom-dropdown-style--PY74Y1dAyiUjKKvt .semi-select-option-empty{justify-content:flex-start;line-height:16px;padding:8px}",""]),n.locals={"custom-pop-style":"custom-pop-style--HB2GEmH4lklph4Vc",customPopStyle:"custom-pop-style--HB2GEmH4lklph4Vc",tag:"tag--Ek96f3Mh6T0np0w5","search-wrapper":"search-wrapper--ckOnOnQdZAAlOnoB",searchWrapper:"search-wrapper--ckOnOnQdZAAlOnoB","custom-dropdown-style":"custom-dropdown-style--PY74Y1dAyiUjKKvt",customDropdownStyle:"custom-dropdown-style--PY74Y1dAyiUjKKvt"},t.Z=n},152854:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".container--IJLZe_C0NJciyg3W:focus-within{border-color:var(--coz-fg-hglt)}.mask-font-family--jmCnlHSIP2sLYhKA{font-family:inherit}.textarea--CUznfSg5Hc4NeqdK::-webkit-input-placeholder{color:rgba(var(--coze-fg-1),var(--coze-fg-1-alpha));font-size:14px;font-weight:400;line-height:20px}.textarea--CUznfSg5Hc4NeqdK::-ms-input-placeholder{color:rgba(var(--coze-fg-1),var(--coze-fg-1-alpha));font-size:14px;font-weight:400;line-height:20px}.textarea--CUznfSg5Hc4NeqdK::placeholder{color:rgba(var(--coze-fg-1),var(--coze-fg-1-alpha));font-size:14px;font-weight:400;line-height:20px}",""]),n.locals={container:"container--IJLZe_C0NJciyg3W","mask-font-family":"mask-font-family--jmCnlHSIP2sLYhKA",maskFontFamily:"mask-font-family--jmCnlHSIP2sLYhKA",textarea:"textarea--CUznfSg5Hc4NeqdK"},t.Z=n},796589:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".empty-image--dchqwZHIK4PNsjTi{height:200px;width:200px}.empty-content--u5ZwnMUC5dIq1U4q{text-align:center;width:100%}",""]),n.locals={"empty-image":"empty-image--dchqwZHIK4PNsjTi",emptyImage:"empty-image--dchqwZHIK4PNsjTi","empty-content":"empty-content--u5ZwnMUC5dIq1U4q",emptyContent:"empty-content--u5ZwnMUC5dIq1U4q"},t.Z=n},574940:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".ui-mouse-pad-selector--G1xthelR22Y0WuuM{align-items:center;border:1px solid rgba(29,28,35,.08);border-radius:8px;box-sizing:border-box;display:flex;height:32px;padding:8px 12px;position:relative;width:68px}.ui-mouse-pad-selector-icon--UcgylYw687I65e9l{height:20px;margin-right:12px}.ui-mouse-pad-selector-arrow--jMVJOWHm2ZAV5INZ{font-size:12px;height:16px}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB{padding:16px}.ui-mouse-pad-selector-popover-options--it22mPN_ecQn5ZSa{display:flex;gap:12px;margin-top:12px}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option--ndcNzG6D1_0ee4mH{align-items:center;background:var(--coz-mg-card,#fff);border:1px solid var(--coz-stroke-plus,rgba(6,7,9,.15));border-radius:var(--default,8px);box-sizing:border-box;display:flex;flex-direction:column;padding-bottom:20px;width:220px}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-icon--JhS24bg8bu8Zso3q{padding-top:26px}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-title--YN2GiqBzQ703T4Yi{padding-top:8px}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-subTitle--M4jQZ4thZI18o17G{padding:4px 12px 0}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-icon-selected--AGdy5b0tvsAUHcAU{color:#1300dd}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-subTitle-selected--OoHKKWAZ9WQb39AI,.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-title-selected--Z6Iyhf8X90Zez6_p{color:var(--coz-fg-hglt,#4e40e5)}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-selected--tHp67XBwhQcxJ3GV{background-color:var(--coz-mg-hglt,rgba(186,192,255,.2));border:1px solid var(--coz-stroke-hglt,#4e40e5);border-radius:var(--default,8px);cursor:pointer}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option--ndcNzG6D1_0ee4mH:hover:not(.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-selected--tHp67XBwhQcxJ3GV){background-color:var(--coz-mg-card-hovered,#fff);border:1px solid var(--coz-stroke-plus,rgba(6,7,9,.15));border-radius:var(--default,8px);box-shadow:0 8px 24px 0 rgba(0,0,0,.16),0 16px 48px 0 rgba(0,0,0,.08);cursor:pointer}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option--ndcNzG6D1_0ee4mH:active:not(.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option-selected--tHp67XBwhQcxJ3GV){background-color:rgba(46,46,56,.12)}.ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB .mouse-pad-option--ndcNzG6D1_0ee4mH:last-of-type{padding-top:13px}.ui-mouse-pad-selector--G1xthelR22Y0WuuM:hover{background-color:rgba(46,46,56,.08);border-color:#4d53e8;cursor:pointer}.ui-mouse-pad-selector--G1xthelR22Y0WuuM:active,.ui-mouse-pad-selector--G1xthelR22Y0WuuM:focus{background-color:rgba(46,46,56,.12);border-color:#4d53e8}.ui-mouse-pad-selector-active--aV2T0OcBzYoX5Wra{border-color:#4d53e8}",""]),n.locals={"ui-mouse-pad-selector":"ui-mouse-pad-selector--G1xthelR22Y0WuuM",uiMousePadSelector:"ui-mouse-pad-selector--G1xthelR22Y0WuuM","ui-mouse-pad-selector-icon":"ui-mouse-pad-selector-icon--UcgylYw687I65e9l",uiMousePadSelectorIcon:"ui-mouse-pad-selector-icon--UcgylYw687I65e9l","ui-mouse-pad-selector-arrow":"ui-mouse-pad-selector-arrow--jMVJOWHm2ZAV5INZ",uiMousePadSelectorArrow:"ui-mouse-pad-selector-arrow--jMVJOWHm2ZAV5INZ","ui-mouse-pad-selector-popover":"ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB",uiMousePadSelectorPopover:"ui-mouse-pad-selector-popover--SFixu0L0GWo3jZXB","ui-mouse-pad-selector-popover-options":"ui-mouse-pad-selector-popover-options--it22mPN_ecQn5ZSa",uiMousePadSelectorPopoverOptions:"ui-mouse-pad-selector-popover-options--it22mPN_ecQn5ZSa","mouse-pad-option":"mouse-pad-option--ndcNzG6D1_0ee4mH",mousePadOption:"mouse-pad-option--ndcNzG6D1_0ee4mH","mouse-pad-option-icon":"mouse-pad-option-icon--JhS24bg8bu8Zso3q",mousePadOptionIcon:"mouse-pad-option-icon--JhS24bg8bu8Zso3q","mouse-pad-option-title":"mouse-pad-option-title--YN2GiqBzQ703T4Yi",mousePadOptionTitle:"mouse-pad-option-title--YN2GiqBzQ703T4Yi","mouse-pad-option-subTitle":"mouse-pad-option-subTitle--M4jQZ4thZI18o17G",mousePadOptionSubTitle:"mouse-pad-option-subTitle--M4jQZ4thZI18o17G","mouse-pad-option-icon-selected":"mouse-pad-option-icon-selected--AGdy5b0tvsAUHcAU",mousePadOptionIconSelected:"mouse-pad-option-icon-selected--AGdy5b0tvsAUHcAU","mouse-pad-option-subTitle-selected":"mouse-pad-option-subTitle-selected--OoHKKWAZ9WQb39AI",mousePadOptionSubTitleSelected:"mouse-pad-option-subTitle-selected--OoHKKWAZ9WQb39AI","mouse-pad-option-title-selected":"mouse-pad-option-title-selected--Z6Iyhf8X90Zez6_p",mousePadOptionTitleSelected:"mouse-pad-option-title-selected--Z6Iyhf8X90Zez6_p","mouse-pad-option-selected":"mouse-pad-option-selected--tHp67XBwhQcxJ3GV",mousePadOptionSelected:"mouse-pad-option-selected--tHp67XBwhQcxJ3GV","ui-mouse-pad-selector-active":"ui-mouse-pad-selector-active--aV2T0OcBzYoX5Wra",uiMousePadSelectorActive:"ui-mouse-pad-selector-active--aV2T0OcBzYoX5Wra"},t.Z=n},546623:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".guiding-content--V8DwlvrQbg3uRWZg{box-sizing:border-box;padding:16px;width:277px}.guiding-content-title--t6SGsH_zezAzdNDT{font-weight:600}.guiding-content-desc--Ta2WmhwKX28kvLJ3{color:rgba(29,28,35,.6);font-size:12px}.guiding-content-button--kS8EK49vPcibU7Ek{background-color:#4d53e8;border-radius:8px;height:32px;width:100%}.guiding-content-mouse-option--wQR85RypcH8Ug37K{align-items:center;display:flex;margin-bottom:16px;margin-top:16px}.guiding-content-mouse-option-icon--Jpre1AUge8J_WfXK{color:#4d53e8;margin-right:4px;text-align:center;transform:scale(.577) translate(-5px);width:32px}.guiding-content-pad-option--MrhCB8SmV0DPwiIs{align-items:center;display:flex;margin-bottom:16px}.guiding-content-pad-option-icon--IMhhc1p5zPYv0wmU{color:#3ec254;margin-right:4px;text-align:center;transform:scale(.577) translate(-13px);width:32px}",""]),n.locals={"guiding-content":"guiding-content--V8DwlvrQbg3uRWZg",guidingContent:"guiding-content--V8DwlvrQbg3uRWZg","guiding-content-title":"guiding-content-title--t6SGsH_zezAzdNDT",guidingContentTitle:"guiding-content-title--t6SGsH_zezAzdNDT","guiding-content-desc":"guiding-content-desc--Ta2WmhwKX28kvLJ3",guidingContentDesc:"guiding-content-desc--Ta2WmhwKX28kvLJ3","guiding-content-button":"guiding-content-button--kS8EK49vPcibU7Ek",guidingContentButton:"guiding-content-button--kS8EK49vPcibU7Ek","guiding-content-mouse-option":"guiding-content-mouse-option--wQR85RypcH8Ug37K",guidingContentMouseOption:"guiding-content-mouse-option--wQR85RypcH8Ug37K","guiding-content-mouse-option-icon":"guiding-content-mouse-option-icon--Jpre1AUge8J_WfXK",guidingContentMouseOptionIcon:"guiding-content-mouse-option-icon--Jpre1AUge8J_WfXK","guiding-content-pad-option":"guiding-content-pad-option--MrhCB8SmV0DPwiIs",guidingContentPadOption:"guiding-content-pad-option--MrhCB8SmV0DPwiIs","guiding-content-pad-option-icon":"guiding-content-pad-option-icon--IMhhc1p5zPYv0wmU",guidingContentPadOptionIcon:"guiding-content-pad-option-icon--IMhhc1p5zPYv0wmU"},t.Z=n},871136:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".mode-select-container--JTes5ax0vj8lwbEW .coz-single-select{background:#f5f5f7;border:none;border-radius:8px;padding:4px}.mode-select-container--JTes5ax0vj8lwbEW .coz-single-select .semi-radio-addon-buttonRadio{border-radius:6px}.mode-select-container--JTes5ax0vj8lwbEW .coz-single-select .semi-radio-addon-buttonRadio-disabled{color:rgba(var(--coze-fg-2),var(--coze-fg-2-alpha));cursor:pointer}.mode-select-container--JTes5ax0vj8lwbEW .coz-single-select .semi-radio-buttonRadioGroup:not(:last-child):after{display:none}.export-modal-container--cTKbJf9_oHkk7OVr .semi-modal-content .semi-modal-header .semi-modal-title{font-size:20px;font-weight:500;line-height:28px}.export-modal-container--cTKbJf9_oHkk7OVr .semi-modal .semi-modal-content{gap:0}",""]),n.locals={"mode-select-container":"mode-select-container--JTes5ax0vj8lwbEW",modeSelectContainer:"mode-select-container--JTes5ax0vj8lwbEW","export-modal-container":"export-modal-container--cTKbJf9_oHkk7OVr",exportModalContainer:"export-modal-container--cTKbJf9_oHkk7OVr"},t.Z=n},936421:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".container--JcnASmalW81Wqs4w .warning-icon--u2aYuVuHMWTZrmdc{display:block}.container--JcnASmalW81Wqs4w .upload-icon--Xofb_hNe88UPdT4m,.container--JcnASmalW81Wqs4w:hover .warning-icon--u2aYuVuHMWTZrmdc{display:none}.container--JcnASmalW81Wqs4w:hover .upload-icon--Xofb_hNe88UPdT4m{display:block}",""]),n.locals={container:"container--JcnASmalW81Wqs4w","warning-icon":"warning-icon--u2aYuVuHMWTZrmdc",warningIcon:"warning-icon--u2aYuVuHMWTZrmdc","upload-icon":"upload-icon--Xofb_hNe88UPdT4m",uploadIcon:"upload-icon--Xofb_hNe88UPdT4m"},t.Z=n},24892:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".modal--Xsk09tpogY96wVfU .semi-modal-wrap .semi-modal .semi-modal-content{gap:0}",""]),n.locals={modal:"modal--Xsk09tpogY96wVfU"},t.Z=n},171881:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".upload-content--kc3ZV3QfAlETXZwY{align-items:center;background:var(--coz-mg-card,#fff);display:flex;flex-direction:column;gap:6px;height:100%;justify-content:center;width:100%}",""]),n.locals={"upload-content":"upload-content--kc3ZV3QfAlETXZwY",uploadContent:"upload-content--kc3ZV3QfAlETXZwY"},t.Z=n},78970:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".upload--cnSqIqksLggSXdOR .semi-upload-drag-area{border:1px dashed var(--coz-stroke-plus,rgba(68,83,130,.25));border-radius:8px;height:320px;overflow:hidden}.upload--cnSqIqksLggSXdOR .semi-upload-drag-area-tips{font-weight:400}.upload--cnSqIqksLggSXdOR .semi-upload-drag-area-legal{border:1px dashed var(--coz-stroke-hglt)}.upload--cnSqIqksLggSXdOR .semi-upload-drag-area-main-text{margin-bottom:0}.upload--cnSqIqksLggSXdOR .semi-upload-file-list{display:none}.upload-loading--uEBN9nnIEYHkcQQN .semi-upload-drag-area{background-color:var(--coz-mg-card,#fff);border-color:var(--coz-stroke-primary,rgba(82,100,154,.13))}.drag-area-disabled--ClF5ypXa3UeSBTbw .semi-upload-drag-area{display:none}.disabled--HscF72w8_WYGTz4w{opacity:.5}",""]),n.locals={upload:"upload--cnSqIqksLggSXdOR","upload-loading":"upload-loading--uEBN9nnIEYHkcQQN",uploadLoading:"upload-loading--uEBN9nnIEYHkcQQN","drag-area-disabled":"drag-area-disabled--ClF5ypXa3UeSBTbw",dragAreaDisabled:"drag-area-disabled--ClF5ypXa3UeSBTbw",disabled:"disabled--HscF72w8_WYGTz4w"},t.Z=n},76133:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".premium-level-select--oGHdMacjRXYSrUL6{margin-bottom:80px}.premium-level-select--oGHdMacjRXYSrUL6 .coz-segment-tab{border:.5px solid #52649a21;border-radius:36px}.premium-level-select--oGHdMacjRXYSrUL6 .coz-segment-tab .semi-radio-checked{-webkit-backdrop-filter:blur(40px);backdrop-filter:blur(40px);background:linear-gradient(#fff,#fff) padding-box,linear-gradient(111.43deg,#5147ff,#b04cea,#ff7847) border-box;border:1px solid transparent;border-radius:28px;overflow:hidden}.premium-level-select--oGHdMacjRXYSrUL6 .semi-radio-buttonRadioGroup{border-radius:28px;overflow:hidden}",""]),n.locals={"premium-level-select":"premium-level-select--oGHdMacjRXYSrUL6",premiumLevelSelect:"premium-level-select--oGHdMacjRXYSrUL6"},t.Z=n},534087:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".task-item--eZXr8nhb4MEKzcRj{overflow:hidden;position:relative}.task-item--eZXr8nhb4MEKzcRj .right-status--lePYstsM1UgDAA0A{align-items:center;display:flex}.task-item--eZXr8nhb4MEKzcRj .right-status--lePYstsM1UgDAA0A .coz-tag.coz-tag-small{font-size:12px;font-weight:500;line-height:16px;padding:2px 4px}.task-item--eZXr8nhb4MEKzcRj .right-operations--blgRWM_4BlsGlA2I{cursor:pointer;display:none;z-index:1}.task-item--eZXr8nhb4MEKzcRj .progress-text--RdkQWR7i7u4rYnD2{color:var(--coz-fg-secondary);display:block;font-size:12px;font-weight:400;line-height:16px}.task-item--eZXr8nhb4MEKzcRj .progress--kl4lnUmvrdkNQ1Ai{height:100%;left:0;margin:0;position:absolute;top:0;width:100%}.task-item--eZXr8nhb4MEKzcRj .progress-inner--nQIYxXmWGCMeB4kz{background:linear-gradient(180deg,rgba(161,170,255,.38) 0,rgba(161,170,255,0));height:100%}.task-item--eZXr8nhb4MEKzcRj:hover{background-color:var(--coz-mg-secondary-hovered)}.task-item--eZXr8nhb4MEKzcRj:hover .right-operations--blgRWM_4BlsGlA2I{align-items:center;display:flex}.task-item--eZXr8nhb4MEKzcRj:hover .right-status--lePYstsM1UgDAA0A{display:none}",""]),n.locals={"task-item":"task-item--eZXr8nhb4MEKzcRj",taskItem:"task-item--eZXr8nhb4MEKzcRj","right-status":"right-status--lePYstsM1UgDAA0A",rightStatus:"right-status--lePYstsM1UgDAA0A","right-operations":"right-operations--blgRWM_4BlsGlA2I",rightOperations:"right-operations--blgRWM_4BlsGlA2I","progress-text":"progress-text--RdkQWR7i7u4rYnD2",progressText:"progress-text--RdkQWR7i7u4rYnD2",progress:"progress--kl4lnUmvrdkNQ1Ai","progress-inner":"progress-inner--nQIYxXmWGCMeB4kz",progressInner:"progress-inner--nQIYxXmWGCMeB4kz"},t.Z=n},969881:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".expression-editor-suggestion--KZv0F2sMrWUJeyeX{background:var(--light-usage-bg-color-bg-3,#fff);max-height:236px;overflow:auto;width:272px}.expression-editor-suggestion--KZv0F2sMrWUJeyeX,.expression-editor-suggestion-empty--I4mKlF7r2cKnt30A{border:.5px solid rgba(153,182,255,.12);border-radius:8px;box-shadow:0 4px 12px 0 rgba(0,0,0,.25);z-index:1000}.expression-editor-suggestion-empty--I4mKlF7r2cKnt30A{background:#fff}.expression-editor-suggestion-empty--I4mKlF7r2cKnt30A p{color:var(--light-usage-text-color-text-2,rgba(29,28,35,.6));font-size:12px;font-style:normal;font-weight:600;line-height:16px;margin:4px 6px}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-search-wrapper{display:none}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list{min-width:100%;padding:4px;padding-left:0;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list li{height:32px}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option{background-color:transparent;pointer-events:none}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label{border-radius:4px;height:24px;margin-right:4px;padding:0 4px;pointer-events:auto}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label:hover{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label:active{background:var(--light-usage-fill-color-fill-2,rgba(46,46,56,.12))}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text{display:inline-block;white-space:nowrap;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text span{display:inline-block;white-space:nowrap;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text .semi-tree-option-highlight{color:var(--light-usage-warning-color-warning,#ff9600)}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-selected{color:var(--light-usage-primary-color-primary,#4d53e8);font-weight:600}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-disabled .semi-tree-option-label{background:transparent;cursor:not-allowed}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-list .semi-tree-option-disabled .semi-icon+.semi-tree-option-label{color:var(--light-usage-text-color-text-0,#1d1c23)}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-empty-icon{width:16px}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-expand-icon{border-radius:4px;height:16px;margin-right:0;padding:4px;pointer-events:auto;width:16px}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-expand-icon:hover{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-expand-icon:active{background:var(--light-usage-fill-color-fill-2,rgba(46,46,56,.12))}.expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2 .semi-tree-option-expand-icon svg{height:16px;width:16px}.expression-editor-suggestion-keyboard-selected--G0bPbSXSGHI82nxF .semi-tree-option-label{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))!important}",""]),n.locals={"expression-editor-suggestion":"expression-editor-suggestion--KZv0F2sMrWUJeyeX",expressionEditorSuggestion:"expression-editor-suggestion--KZv0F2sMrWUJeyeX","expression-editor-suggestion-empty":"expression-editor-suggestion-empty--I4mKlF7r2cKnt30A",expressionEditorSuggestionEmpty:"expression-editor-suggestion-empty--I4mKlF7r2cKnt30A","expression-editor-suggestion-tree":"expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2",expressionEditorSuggestionTree:"expression-editor-suggestion-tree--R3ZhRf7FIkodLHh2","expression-editor-suggestion-keyboard-selected":"expression-editor-suggestion-keyboard-selected--G0bPbSXSGHI82nxF",expressionEditorSuggestionKeyboardSelected:"expression-editor-suggestion-keyboard-selected--G0bPbSXSGHI82nxF"},t.Z=n},275538:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".expression-editor-counter--EedkfbNYyisqi7zu{bottom:0;color:var(--semi-color-text-2);position:absolute;right:0}.expression-editor-counter--EedkfbNYyisqi7zu p{display:flex;flex-direction:column;font-size:12px;justify-content:center;line-height:16px;min-height:24px;padding:3px 12px 5px;text-align:right}.expression-editor-counter-error--RhFyn3QKYi48XRP0{color:var(--semi-color-danger)}",""]),n.locals={"expression-editor-counter":"expression-editor-counter--EedkfbNYyisqi7zu",expressionEditorCounter:"expression-editor-counter--EedkfbNYyisqi7zu","expression-editor-counter-error":"expression-editor-counter-error--RhFyn3QKYi48XRP0",expressionEditorCounterError:"expression-editor-counter-error--RhFyn3QKYi48XRP0"},t.Z=n},470946:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".slate-editable--XdZakPQoFe8OxYDA{user-select:text!important;-webkit-user-select:text!important;-moz-user-select:text!important;-ms-user-select:text!important;-o-user-select:text!important}",""]),n.locals={"slate-editable":"slate-editable--XdZakPQoFe8OxYDA",slateEditable:"slate-editable--XdZakPQoFe8OxYDA"},t.Z=n},728348:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".expression-editor-suggestion-pin--HVlqgh37IcunDzsO{height:1.5rem;position:absolute;transform:translateY(-.5rem);width:0}.expression-editor-suggestion--agjvY9VcSML97ti4{background:var(--light-usage-bg-color-bg-3,#fff);max-height:236px;overflow:auto;width:272px}.expression-editor-suggestion--agjvY9VcSML97ti4,.expression-editor-suggestion-empty--T3xbdMeyqh0zuYcF{border:.5px solid rgba(153,182,255,.12);border-radius:8px;box-shadow:0 4px 12px 0 rgba(0,0,0,.25);z-index:1000}.expression-editor-suggestion-empty--T3xbdMeyqh0zuYcF{background:#fff}.expression-editor-suggestion-empty--T3xbdMeyqh0zuYcF p{color:var(--light-usage-text-color-text-2,rgba(29,28,35,.6));font-size:12px;font-style:normal;font-weight:600;line-height:16px;margin:4px 6px}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-search-wrapper{display:none}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list{min-width:100%;padding:4px;padding-left:0;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list li{height:32px}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option{background-color:transparent;pointer-events:none}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label{border-radius:4px;height:24px;margin-right:4px;padding:0 4px;pointer-events:auto}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label:hover{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label:active{background:var(--light-usage-fill-color-fill-2,rgba(46,46,56,.12))}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text{display:inline-block;white-space:nowrap;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text span{display:inline-block;white-space:nowrap;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-label .semi-tree-option-label-text .semi-tree-option-highlight{color:var(--light-usage-warning-color-warning,#ff9600)}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-selected{color:var(--light-usage-primary-color-primary,#4d53e8);font-weight:600}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-disabled .semi-tree-option-label{background:transparent;cursor:not-allowed}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-list .semi-tree-option-disabled .semi-icon+.semi-tree-option-label{color:var(--light-usage-text-color-text-0,#1d1c23)}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-empty-icon{width:16px}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-expand-icon{border-radius:4px;height:16px;margin-right:0;padding:4px;pointer-events:auto;width:16px}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-expand-icon:hover{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-expand-icon:active{background:var(--light-usage-fill-color-fill-2,rgba(46,46,56,.12))}.expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42 .semi-tree-option-expand-icon svg{height:16px;width:16px}.expression-editor-suggestion-keyboard-selected--grvQsC6V32sKAOqc .semi-tree-option-label{background:var(--light-usage-fill-color-fill-1,rgba(46,46,56,.08))!important}",""]),n.locals={"expression-editor-suggestion-pin":"expression-editor-suggestion-pin--HVlqgh37IcunDzsO",expressionEditorSuggestionPin:"expression-editor-suggestion-pin--HVlqgh37IcunDzsO","expression-editor-suggestion":"expression-editor-suggestion--agjvY9VcSML97ti4",expressionEditorSuggestion:"expression-editor-suggestion--agjvY9VcSML97ti4","expression-editor-suggestion-empty":"expression-editor-suggestion-empty--T3xbdMeyqh0zuYcF",expressionEditorSuggestionEmpty:"expression-editor-suggestion-empty--T3xbdMeyqh0zuYcF","expression-editor-suggestion-tree":"expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42",expressionEditorSuggestionTree:"expression-editor-suggestion-tree--jT6ZMIEOkQeDaH42","expression-editor-suggestion-keyboard-selected":"expression-editor-suggestion-keyboard-selected--grvQsC6V32sKAOqc",expressionEditorSuggestionKeyboardSelected:"expression-editor-suggestion-keyboard-selected--grvQsC6V32sKAOqc"},t.Z=n},30131:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".item--UIAJZGG0fI40xkIg{color:#1d1c23;display:flex;font-size:14px}.itemTitle--cPtVj5Ctug0bPUWE{flex:1 1}.itemContent--DoICu2lYDu0zPRbY,.itemTitle--cPtVj5Ctug0bPUWE{align-items:center;display:flex}.close--bBvfoPPqugjPLYWv{cursor:pointer;position:absolute;right:24px;top:24px}",""]),n.locals={item:"item--UIAJZGG0fI40xkIg",itemTitle:"itemTitle--cPtVj5Ctug0bPUWE",itemContent:"itemContent--DoICu2lYDu0zPRbY",close:"close--bBvfoPPqugjPLYWv"},t.Z=n},850138:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".image-uploader--iSvqR0mb4ACwwJak.semi-input-wrapper:hover{background-color:var(--semi-color-white)}.image-uploader--iSvqR0mb4ACwwJak.can-action--IZeALQpK30wr0Mdl.semi-input-wrapper{transition:all .1s}.image-uploader--iSvqR0mb4ACwwJak.can-action--IZeALQpK30wr0Mdl.semi-input-wrapper:hover{background:rgba(46,46,56,.08)}.image-uploader--iSvqR0mb4ACwwJak.can-action--IZeALQpK30wr0Mdl.semi-input-wrapper:active{background:rgba(46,46,56,.12)}.image-uploader--iSvqR0mb4ACwwJak .action--BONLHGhfpYEep6O9{align-items:center;border-radius:4px;color:rgba(29,28,35,.6);cursor:pointer;display:inline-flex;font-size:12px;height:20px;justify-content:center;transition:all .2s;width:20px}.image-uploader--iSvqR0mb4ACwwJak .action--BONLHGhfpYEep6O9:hover{background-color:rgba(46,46,56,.08)}.image-uploader--iSvqR0mb4ACwwJak .action--BONLHGhfpYEep6O9:active{background-color:rgba(46,46,56,.12)}.image-uploader--iSvqR0mb4ACwwJak .action--BONLHGhfpYEep6O9.disabled--itWXVBQY_dUmoCZ4{background-color:rgba(46,46,56,.08);cursor:not-allowed}.image-uploader--iSvqR0mb4ACwwJak .input-img-thumb--WNkKEaJ1YCg0tFbe{align-items:center;border-radius:.125rem;display:inline-flex;flex-grow:0;flex-shrink:0;height:20px;justify-content:center;overflow:hidden;width:20px}.image-uploader--iSvqR0mb4ACwwJak .input-img-thumb--WNkKEaJ1YCg0tFbe img{border-radius:.125rem;max-height:100%;max-width:100%;object-fit:contain;object-position:center}.image-uploader--iSvqR0mb4ACwwJak .input-img-thumb--WNkKEaJ1YCg0tFbe .semi-image-status{background:none}.image-uploader--iSvqR0mb4ACwwJak .input-img-thumb--WNkKEaJ1YCg0tFbe .semi-image-status svg{color:rgba(6,7,9,.3);width:17px}.img-popover-content--vl7eduJ0KkN0RcVC{padding:8px}",""]),n.locals={"image-uploader":"image-uploader--iSvqR0mb4ACwwJak",imageUploader:"image-uploader--iSvqR0mb4ACwwJak","can-action":"can-action--IZeALQpK30wr0Mdl",canAction:"can-action--IZeALQpK30wr0Mdl",action:"action--BONLHGhfpYEep6O9",disabled:"disabled--itWXVBQY_dUmoCZ4","input-img-thumb":"input-img-thumb--WNkKEaJ1YCg0tFbe",inputImgThumb:"input-img-thumb--WNkKEaJ1YCg0tFbe","img-popover-content":"img-popover-content--vl7eduJ0KkN0RcVC",imgPopoverContent:"img-popover-content--vl7eduJ0KkN0RcVC"},t.Z=n},703259:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".history-item--pd1U0jIwOicceq86{padding-bottom:16px}",""]),n.locals={"history-item":"history-item--pd1U0jIwOicceq86",historyItem:"history-item--pd1U0jIwOicceq86"},t.Z=n},604417:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".upload-form--m3KUT_tbqmAJ2inZ .textarea-single-line--bHnX9kmcYbEUcwFP .semi-input-textarea-counter{position:absolute;right:0;top:4px}.upload-form--m3KUT_tbqmAJ2inZ .textarea-multi-line--D8bL1v0yljAego0e{margin-bottom:16px}.upload-form--m3KUT_tbqmAJ2inZ .conversation-field--GUpz6fwDkkt7opZN{padding:0}.upload-form--m3KUT_tbqmAJ2inZ .schema_type--dyIsWwgdp9klIcn6,.upload-form--m3KUT_tbqmAJ2inZ .upload-field--JNhg3c8aR4UFMoGZ{padding-top:0}.upload-form-item--VkPVMzqLbaARCAqJ .semi-form-field-label-text{display:none}.add-card--JKhGMIqw3v4XORlt{background-color:#fff;border-radius:8px}.add-card-inner--kZfSWZmSP4r3D1YK{display:flex;flex-direction:column;justify-content:center}",""]),n.locals={"upload-form":"upload-form--m3KUT_tbqmAJ2inZ",uploadForm:"upload-form--m3KUT_tbqmAJ2inZ","textarea-single-line":"textarea-single-line--bHnX9kmcYbEUcwFP",textareaSingleLine:"textarea-single-line--bHnX9kmcYbEUcwFP","textarea-multi-line":"textarea-multi-line--D8bL1v0yljAego0e",textareaMultiLine:"textarea-multi-line--D8bL1v0yljAego0e","conversation-field":"conversation-field--GUpz6fwDkkt7opZN",conversationField:"conversation-field--GUpz6fwDkkt7opZN",schema_type:"schema_type--dyIsWwgdp9klIcn6",schemaType:"schema_type--dyIsWwgdp9klIcn6","upload-field":"upload-field--JNhg3c8aR4UFMoGZ",uploadField:"upload-field--JNhg3c8aR4UFMoGZ","upload-form-item":"upload-form-item--VkPVMzqLbaARCAqJ",uploadFormItem:"upload-form-item--VkPVMzqLbaARCAqJ","add-card":"add-card--JKhGMIqw3v4XORlt",addCard:"add-card--JKhGMIqw3v4XORlt","add-card-inner":"add-card-inner--kZfSWZmSP4r3D1YK",addCardInner:"add-card-inner--kZfSWZmSP4r3D1YK"},t.Z=n},513747:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,"button.button--bP9LxU2BlwMj6DJl{min-width:76px}button.button--bP9LxU2BlwMj6DJl.moreLevel--Zs4dsdCuJD0HiDmo{background:var(--light-usage-bg-color-bg-0,#fff);border:none;color:var(--light-usage-primary-color-primary-disabled,#b4baf6)}button.button--bP9LxU2BlwMj6DJl.mouseIn--TOH0VqXOoCMD6khb{background-color:rgba(var(--coze-red-5),1)!important;color:#fff}",""]),n.locals={button:"button--bP9LxU2BlwMj6DJl",moreLevel:"moreLevel--Zs4dsdCuJD0HiDmo",mouseIn:"mouseIn--TOH0VqXOoCMD6khb"},t.Z=n},383968:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".font-normal--qW4A40gWjnMGFhCv{cursor:text;font-size:12px;font-style:normal;font-weight:400;line-height:16px}.container--nwBsCD9mys2dqse6{margin-left:8px}.container--nwBsCD9mys2dqse6 .button--uE4EJQfD2EQULl6q{cursor:pointer;width:76px}.not_publish_tooltip--ZqYlcgS0VMAI7SgB{border-radius:6px;padding:12px}.not_publish_tooltip--ZqYlcgS0VMAI7SgB .content--PliCjs2JtUaORNnZ{color:#fff;cursor:text;font-size:12px;font-style:normal;font-weight:400;line-height:20px}.workflow_count_span--GDBD_G8PvEokN_mS{background-color:#4d53e8;border-radius:8px;color:#fff;display:inline-block;font-size:10px;height:16px;line-height:17px;margin-left:6px;vertical-align:1px;width:16px}",""]),n.locals={"font-normal":"font-normal--qW4A40gWjnMGFhCv",fontNormal:"font-normal--qW4A40gWjnMGFhCv",container:"container--nwBsCD9mys2dqse6",button:"button--uE4EJQfD2EQULl6q",not_publish_tooltip:"not_publish_tooltip--ZqYlcgS0VMAI7SgB",notPublishTooltip:"not_publish_tooltip--ZqYlcgS0VMAI7SgB",content:"content--PliCjs2JtUaORNnZ",workflow_count_span:"workflow_count_span--GDBD_G8PvEokN_mS",workflowCountSpan:"workflow_count_span--GDBD_G8PvEokN_mS"},t.Z=n},379602:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".font-normal--KuKuoCEYKz0LHBgT{font-size:12px;font-style:normal;font-weight:400;line-height:16px}.container--Y6kCYuZxKI8Ork9x{align-items:center;border-top:1px solid var(--light-usage-border-color-border,rgba(28,29,35,.12));cursor:pointer;display:flex;flex-direction:row;justify-content:space-between;padding:12px 16px 14px;width:100%}.container--Y6kCYuZxKI8Ork9x:first-child,.container--Y6kCYuZxKI8Ork9x:hover{border-top:1px solid transparent}.container--Y6kCYuZxKI8Ork9x:hover{background:var(--light-usage-fill-color-fill-0,rgba(46,47,56,.04));border-radius:8px}.container--Y6kCYuZxKI8Ork9x:hover+div{border-top:1px solid transparent}.container--Y6kCYuZxKI8Ork9x .left--VhppPlhzGciSD8DZ{margin-right:16px}.container--Y6kCYuZxKI8Ork9x .left--VhppPlhzGciSD8DZ .icon--WCH86KcfgQIhKrU3,.container--Y6kCYuZxKI8Ork9x .left--VhppPlhzGciSD8DZ .icon--WCH86KcfgQIhKrU3 img{height:36px;width:36px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU{display:flex;flex:1 1;flex-direction:column;width:0}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .header--IVwkQxTLAwwQSeK_{align-items:center;display:flex;justify-content:flex-start;padding-bottom:2px;width:100%}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .header--IVwkQxTLAwwQSeK_ .title_wrapper--gTJRAYDoGK80DPNC{align-items:center;align-self:stretch;cursor:pointer;display:flex;flex:1 1;width:0}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .header--IVwkQxTLAwwQSeK_ .title_wrapper--gTJRAYDoGK80DPNC .title--_aAvufa6XUIfpQTe{color:var(--coz-fg-primary,#060709);font-size:14px;font-style:normal;font-weight:600;line-height:20px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .header--IVwkQxTLAwwQSeK_ .title_wrapper--gTJRAYDoGK80DPNC .status--vlvXbWtauyUcBvwN{align-items:center;display:flex;flex-direction:row;margin-left:8px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .header--IVwkQxTLAwwQSeK_ .title_wrapper--gTJRAYDoGK80DPNC .status--vlvXbWtauyUcBvwN .text--zQv_5VogU9kjWcvd{color:var(--coz-fg-primary,#060709);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-left:4px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .content--hf3XE0ebvVgj1p_m{cursor:pointer;display:flex;flex-direction:column;margin-top:4px;width:100%}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .content--hf3XE0ebvVgj1p_m .desc--uq3uvNkoSOIkWoWT{color:var(--coz-fg-secondary,#06070980);font-size:12px;font-style:normal;font-weight:400;line-height:16px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2{display:flex;flex-direction:column;width:100%}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .creator--aMvVkwJlXggNELBo{align-items:center;border-radius:3px;cursor:pointer;display:flex}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .creator--aMvVkwJlXggNELBo .avatar--BtUWyj0hukwPHZrc{display:flex;height:12px;width:12px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .creator--aMvVkwJlXggNELBo .avatar--BtUWyj0hukwPHZrc img{height:12px;width:12px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .creator--aMvVkwJlXggNELBo .name--Zfr41w4kbsA30mdu{color:var(--coz-fg-secondary,#06070980);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-left:4px;max-width:106px;word-break:break-word}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs{align-items:center;cursor:pointer;display:inline-flex}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs .creator--aMvVkwJlXggNELBo{background:unset}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs .creator-avatar--ylHmgbcNA0Bg58Eo{height:12px;width:12px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs .creator-name--LYzx6J5ScJky1i6l{color:var(--coz-fg-secondary,#06070980);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-left:4px;max-width:70px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs .symbol--dVPpGv2XEQTWlvgr{color:var(--coz-stroke-primary);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin:0 8px}.container--Y6kCYuZxKI8Ork9x .center--pxKmWk4p3JQOY1BU .footer--_zFJiphnY4L2jFi2 .info--FHkEl84JeJA25jVs .date--Ph3CYs2ZC74VQKKz{color:var(--coz-fg-dim,#06070966);font-size:12px;font-style:normal;font-weight:400;line-height:16px}.container--Y6kCYuZxKI8Ork9x .right--xvNGVn4z0Yp99T14{display:flex;flex-direction:column;margin-left:16px}.container--Y6kCYuZxKI8Ork9x .right--xvNGVn4z0Yp99T14 .buttons--UY5uGPfqPII1tFe7{align-items:center;align-self:stretch;display:flex}",""]),n.locals={"font-normal":"font-normal--KuKuoCEYKz0LHBgT",fontNormal:"font-normal--KuKuoCEYKz0LHBgT",container:"container--Y6kCYuZxKI8Ork9x",left:"left--VhppPlhzGciSD8DZ",icon:"icon--WCH86KcfgQIhKrU3",center:"center--pxKmWk4p3JQOY1BU",header:"header--IVwkQxTLAwwQSeK_",title_wrapper:"title_wrapper--gTJRAYDoGK80DPNC",titleWrapper:"title_wrapper--gTJRAYDoGK80DPNC",title:"title--_aAvufa6XUIfpQTe",status:"status--vlvXbWtauyUcBvwN",text:"text--zQv_5VogU9kjWcvd",content:"content--hf3XE0ebvVgj1p_m",desc:"desc--uq3uvNkoSOIkWoWT",footer:"footer--_zFJiphnY4L2jFi2",creator:"creator--aMvVkwJlXggNELBo",avatar:"avatar--BtUWyj0hukwPHZrc",name:"name--Zfr41w4kbsA30mdu",info:"info--FHkEl84JeJA25jVs","creator-avatar":"creator-avatar--ylHmgbcNA0Bg58Eo",creatorAvatar:"creator-avatar--ylHmgbcNA0Bg58Eo","creator-name":"creator-name--LYzx6J5ScJky1i6l",creatorName:"creator-name--LYzx6J5ScJky1i6l",symbol:"symbol--dVPpGv2XEQTWlvgr",date:"date--Ph3CYs2ZC74VQKKz",right:"right--xvNGVn4z0Yp99T14",buttons:"buttons--UY5uGPfqPII1tFe7"},t.Z=n},696636:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".font-normal--zzrY6jvchAVeg85A{color:rgba(28,31,35,.8);font-size:12px;font-style:normal;font-weight:400;line-height:16px}.container--hqVG9rNfc9x_1o5G{margin:4px 0 8px;width:100%}.container--hqVG9rNfc9x_1o5G .wrapper--pHGxdJ9DY5UX2iwu{cursor:pointer;display:flex;flex-direction:column;position:relative}.container--hqVG9rNfc9x_1o5G .wrapper--pHGxdJ9DY5UX2iwu .popover_help_block--JzbmrgrwXIA6107N{height:100%;left:0;position:absolute;top:0;width:100%}.popover--KJXcIkxuiU2kqpnw{border-radius:6px;box-shadow:0 4px 14px 0 rgba(0,0,0,.1),0 0 1px 0 rgba(0,0,0,.3);max-height:400px;overflow:auto;padding:12px;width:260px}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u{display:flex;flex-direction:column;margin-top:4px}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u:first-child{margin-top:0}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .header--tSLJBVVR8ekI4mYA{align-items:center;display:flex}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .header--tSLJBVVR8ekI4mYA .name--GxgKVwLpz5gqEi2x{color:rgba(28,31,35,.8);color:#1c1f23;font-size:12px;font-style:normal;font-weight:700;line-height:16px;word-break:break-word}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .header--tSLJBVVR8ekI4mYA .required--zuykqoYZ1Iq8akqy,.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .header--tSLJBVVR8ekI4mYA .type--NO2DEaIZb0kFJ_eh{color:rgba(28,31,35,.8);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-left:12px}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .header--tSLJBVVR8ekI4mYA .required--zuykqoYZ1Iq8akqy{color:#fc8800}.popover--KJXcIkxuiU2kqpnw .item--cSKBR_DCwwQ2fr2u .footer--dxm0bQTJHE4Cj8Vn{color:rgba(28,31,35,.8);color:rgba(28,31,35,.6);font-size:12px;font-style:normal;font-weight:400;line-height:16px;margin-top:4px;width:100%;word-break:break-word}",""]),n.locals={"font-normal":"font-normal--zzrY6jvchAVeg85A",fontNormal:"font-normal--zzrY6jvchAVeg85A",container:"container--hqVG9rNfc9x_1o5G",wrapper:"wrapper--pHGxdJ9DY5UX2iwu",popover_help_block:"popover_help_block--JzbmrgrwXIA6107N",popoverHelpBlock:"popover_help_block--JzbmrgrwXIA6107N",popover:"popover--KJXcIkxuiU2kqpnw",item:"item--cSKBR_DCwwQ2fr2u",header:"header--tSLJBVVR8ekI4mYA",name:"name--GxgKVwLpz5gqEi2x",required:"required--zuykqoYZ1Iq8akqy",type:"type--NO2DEaIZb0kFJ_eh",footer:"footer--dxm0bQTJHE4Cj8Vn"},t.Z=n},291318:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".container--pXd4ywD7cEYl9IOD{height:100%;padding:0 24px;width:100%}.scroll_load_more--NoZpaBljlUZIjEfZ{padding:8px}.scroll_load_more--NoZpaBljlUZIjEfZ.empty--iwO4tmiT5nQ7FEn4{height:0;padding:0}.workflow-content--oeYDCNYu5zopqzMK{height:100%;overflow:auto;padding-bottom:12px;width:100%}.workflow-content--oeYDCNYu5zopqzMK .loading-more--Bp1gHGbQ3qEV4Ynt{text-align:center}.spin--oeLyjTRCMdcZX4ru{height:100%;width:100%}.spin--oeLyjTRCMdcZX4ru .semi-spin-children{height:100%}",""]),n.locals={container:"container--pXd4ywD7cEYl9IOD",scroll_load_more:"scroll_load_more--NoZpaBljlUZIjEfZ",scrollLoadMore:"scroll_load_more--NoZpaBljlUZIjEfZ",empty:"empty--iwO4tmiT5nQ7FEn4","workflow-content":"workflow-content--oeYDCNYu5zopqzMK",workflowContent:"workflow-content--oeYDCNYu5zopqzMK","loading-more":"loading-more--Bp1gHGbQ3qEV4Ynt",loadingMore:"loading-more--Bp1gHGbQ3qEV4Ynt",spin:"spin--oeLyjTRCMdcZX4ru"},t.Z=n},818575:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".header--JQ1uvZd0QeUsVVJE{align-items:center;display:flex;gap:12px}.workflow-status-radio--R8sviwCcX9YLiXeD .semi-radio-buttonRadioGroup{padding:0}.workflow-status-radio--R8sviwCcX9YLiXeD .semi-radio-buttonRadioGroup:first-child .semi-radio-addon-buttonRadio{border-radius:0;border-right:1px solid var(--semi-color-fill-2)}.workflow-status-radio--R8sviwCcX9YLiXeD .semi-radio-addon-buttonRadio{color:rgba(28,31,35,.4);font-size:14px;padding:0 16px}.workflow-status-radio--R8sviwCcX9YLiXeD .semi-radio-addon-buttonRadio-hover{background-color:transparent}.workflow-status-radio--R8sviwCcX9YLiXeD .semi-radio-addon-buttonRadio-checked{background-color:transparent;color:var(--light-usage-text-color-text-0,#1c1d23)}",""]),n.locals={header:"header--JQ1uvZd0QeUsVVJE","workflow-status-radio":"workflow-status-radio--R8sviwCcX9YLiXeD",workflowStatusRadio:"workflow-status-radio--R8sviwCcX9YLiXeD"},t.Z=n},441750:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".workflow-modal--b5GhFZYSA_QRO9Af{height:100%}.workflow-modal--b5GhFZYSA_QRO9Af .title--FFom9Db6mY0RMHyB{margin-bottom:var(--coze-24)}.workflow-modal--b5GhFZYSA_QRO9Af .title--FFom9Db6mY0RMHyB,.workflow-modal--b5GhFZYSA_QRO9Af .title-for-avatar--lLNAres4a7o9qg60{color:rgba(var(--coze-fg-4),var(--coze-fg-4-alpha));font-size:var(--coze-20);font-weight:500;line-height:1.75rem}.douyin-workflow-modal--KZRpG2BH3zY18cjR .semi-modal{width:800px}",""]),n.locals={"workflow-modal":"workflow-modal--b5GhFZYSA_QRO9Af",workflowModal:"workflow-modal--b5GhFZYSA_QRO9Af",title:"title--FFom9Db6mY0RMHyB","title-for-avatar":"title-for-avatar--lLNAres4a7o9qg60",titleForAvatar:"title-for-avatar--lLNAres4a7o9qg60","douyin-workflow-modal":"douyin-workflow-modal--KZRpG2BH3zY18cjR",douyinWorkflowModal:"douyin-workflow-modal--KZRpG2BH3zY18cjR"},t.Z=n},986171:function(e,t,o){var r=o(160052),i=o.n(r),a=o(570717),n=o.n(a)()(i());n.push([e.id,".tool-tag-list--oujTmKvl_yAd2Ppn{flex:1 1;flex-shrink:0;overflow:auto;padding-top:16px;white-space:nowrap}.tool-tag-list-label--XOsd39eEz4IQiq2a{color:var(--light-usage-text-color-text-3,rgba(28,29,35,.35));font-size:12px;font-weight:600;height:40px;line-height:40px;margin-bottom:8px;padding:0 12px}.tool-tag-list-cell--HC9sNSkspeEecK9b{align-items:center;border-radius:3px;color:#1d1c23;cursor:pointer;display:flex;font-size:14px;height:32px;line-height:32px;margin-bottom:4px;padding:0 10px 0 12px;position:relative}.tool-tag-list-cell-icon--TCB49aQy6h8xKee7{align-items:center;display:flex;flex-shrink:0;justify-content:center;margin-right:8px}.tool-tag-list-cell-icon--TCB49aQy6h8xKee7>svg{height:20px;width:20px}.tool-tag-list-cell-icon--TCB49aQy6h8xKee7>svg>path{fill:#1d1c23}.tool-tag-list-cell-icon--TCB49aQy6h8xKee7>img{height:24px;padding:4px;width:24px}.tool-tag-list-cell-divider--M8CI9U_LZCkEZvD5{background:rgba(28,29,35,.12);margin:12px;width:calc(100% - 24px)}.tool-tag-list-cell--HC9sNSkspeEecK9b:hover{background:var(--light-usage-fill-color-fill-0,rgba(46,50,56,.05));border-radius:8px;color:var(--light-usage-text-color-text-0,#1c1f23)}.tool-tag-list-cell--HC9sNSkspeEecK9b.active--k7DLgzylIA3dCeDx{background:var(--light-usage-fill-color-fill-0,rgba(46,47,56,.05));border-radius:8px;color:var(--light-usage-text-color-text-0,#1c1d23);font-size:14px;font-weight:600}.tool-tag-list-cell--HC9sNSkspeEecK9b.active--k7DLgzylIA3dCeDx .tool-tag-list-cell-icon--TCB49aQy6h8xKee7>svg{height:20px;width:20px}.tool-tag-list-cell--HC9sNSkspeEecK9b.active--k7DLgzylIA3dCeDx .tool-tag-list-cell-icon--TCB49aQy6h8xKee7>svg>path{fill:#4d53e8}",""]),n.locals={"tool-tag-list":"tool-tag-list--oujTmKvl_yAd2Ppn",toolTagList:"tool-tag-list--oujTmKvl_yAd2Ppn","tool-tag-list-label":"tool-tag-list-label--XOsd39eEz4IQiq2a",toolTagListLabel:"tool-tag-list-label--XOsd39eEz4IQiq2a","tool-tag-list-cell":"tool-tag-list-cell--HC9sNSkspeEecK9b",toolTagListCell:"tool-tag-list-cell--HC9sNSkspeEecK9b","tool-tag-list-cell-icon":"tool-tag-list-cell-icon--TCB49aQy6h8xKee7",toolTagListCellIcon:"tool-tag-list-cell-icon--TCB49aQy6h8xKee7","tool-tag-list-cell-divider":"tool-tag-list-cell-divider--M8CI9U_LZCkEZvD5",toolTagListCellDivider:"tool-tag-list-cell-divider--M8CI9U_LZCkEZvD5",active:"active--k7DLgzylIA3dCeDx"},t.Z=n}}]);
//# sourceMappingURL=https://sourcemap-redirect.coze.cn/obj/coze-sourcemap/ol-sourcemap/bot/1.0.2.2476/51770.d16dd301.js.map