!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)._hasdk=t()}(this,(function(){"use strict";var e=function(e){return function(t){return function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}(t)===e}},t=e("function"),n=e("object"),i=e("array"),r=e("string"),o=e("number"),s=e("boolean"),a=e("undefined"),c=e("null");function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,S(i.key),i)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g(e);if(t){var r=g(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,n)}}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},b.apply(this,arguments)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(a.push(i.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function S(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var T="baseinfotype",I="customEvent",_="elementEvent",C="clickEvent",U="HW_",x="HWBS_",j="id",R="idts",E="viewts",O="QuotaExceededError",D=Array.prototype,N=function(e,t){return D.includes&&e.includes===D.includes?e.includes(t):-1!==e.indexOf(t)},P=function(e,t,n){var i,r=D.forEach;if(r&&e.forEach===r)e.forEach(t,n);else if((i=e)&&"object"===u(i)&&isFinite(i.length)&&i.length>=0&&i.length===Math.floor(i.length)&&i.length<Math.pow(2,32))for(var o=0,s=e.length;o<s;o++)o in e&&t.call(n,e[o],o,e);else for(var a in e)Object.hasOwnProperty.call(e,a)&&t.call(n,e[a],a,e)},A=function(e){return P(D.slice.call(arguments,1),(function(t){P(t,(function(t,n){e[n]=t}))})),e},H=function(e,t){return e.indexOf(t)},M=function(){var e=new Uint8Array(16),t=window;return(t.crypto||t.webkitCrypto||t.mozCrypto||t.oCrypto||t.msCrypto).getRandomValues(e),function(e,t){if(D.map&&e.map===D.map)return e.map(t);var n=[];return P(e,(function(e,i,r){n.push(t(e,i,r))})),n}(e,(function(e){return("0"+e.toString(16)).substr(-2)})).join("")},B="2.2.3-505",L=["token","ha_linker"],X="https://h5hosting-drcn.dbankcdn.cn/cch5/apms/ha_".concat(B,"/modules/autotracker.min.js");function q(e){return e.tagName.toLowerCase()}var F=function(e){var t=[];return P(e,(function(e,n){i(e)?P(e,(function(i,r){t.push(n+"="+e[r])})):t.push(n+"="+e)})),t.join("&")},J=function(){return!a(window.XMLHttpRequest)&&"withCredentials"in new XMLHttpRequest},W=navigator,z=function(){return W&&!a(W.sendBeacon)},$=function e(t){var n=t.parentElement;if(!n)return null;var i=q(n);return"body"===i||"html"===i?null:"a"===i?n:e(n)},Z=function(){return(new Date).getTime()},Q=function(e){e.length},G=function(){return window.haJsBridge||{}},K=function(e){var t=null;try{if(G().haGetDeviceInfo){var n=Z(),i=G().haGetDeviceInfo(e),o=Z();t=r(i)?JSON.parse(i):i,Q("get device info ".concat(e," use ").concat(o-n," ms. info: ").concat(JSON.stringify(t)))}}catch(e){console.error("json parse device info error.")}return t},Y=window,V={get:function(e){return Y.localStorage.getItem(e)},set:function(e,t){try{Y.localStorage.setItem(e,t)}catch(e){if(e.name===O)throw new Error(e.name);console.error(e)}},remove:function(e){Y.localStorage.removeItem(e)},isSupport:function(){var e=!0;try{var t="__local_store_support__",n="testIsSupportStorage";this.set(t,n),this.get(t)!==n&&(e=!1),this.remove(t)}catch(t){e=!1}return e},length:function(){return Y.localStorage.length},key:function(e){return Y.localStorage.key(e)}},ee=document,te=function(e){var t=new RegExp("(^|;)[ ]*"+e+"=([^;]*)").exec(ee.cookie);return t?decodeURIComponent(t[2]):null},ne=function(e,t,n,i,r,o){if(e&&!/^(?:expires|max-age|path|domain|secure)$/i.test(e)){var s=[];if(s.push("".concat(e,"=").concat(encodeURIComponent(t))),n){var a=new Date;a.setTime(a.getTime()+n),s.push("expires=".concat(a.toUTCString()))}s.push("path=".concat(i||"/")),r&&s.push("domain=".concat(r)),!0===o&&s.push("secure"),ee.cookie=s.join("; ")}},ie=function(e){var t=new Date;t.setTime(t.getTime()-1);var n=te(e);c(n)||(ee.cookie=e+"="+n+";expires="+t.toUTCString()+";path=/")};function re(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener?e.addEventListener(t,n,i):e.attachEvent("on".concat(t),n)}var oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=k(e.split("?"),2),i=n[0],r=n[1];if(!r)return e;var o=r.split("&").filter((function(e){return!N(t,e.split("=")[0].toLocaleLowerCase())}));return o.length?"".concat(i,"?").concat(o.join("&")):i},se=function(e){var t={};e.includes("#")&&(e=e.split("#")[0]);var n=e.split("?")[1];if(!n)return t;for(var i=n.split("&"),r=0;r<i.length;++r){var o=k(i[r].split("="),2),s=o[0],a=o[1];t[decodeURIComponent(s)]=decodeURIComponent(a)}return t},ae=Object.freeze({__proto__:null,deleteUrlQuery:oe,getQueryParamsFromUrl:se}),ce=document,ue=document,le=window,he=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l(this,e),this.isH5=n,this.waitTime=0,this.waitTimeFlagTime=0,this.waitTimeFlag=!0,this.accessTime=Z(),this.config={defaultCookie:{},useCookie:!0,isInit:!1,usedPageUrl:!0,intervalTime:18e5,batchSend:!1},this.globals={idsite:"",title:ue.title,id:"unknown",rid:"unknown",idts:Z(),idvc:0,idn:"",di:{sessionId:"unknown"},refts:Z(),viewts:Z(),CXX:"",uid:"",cvar:""},this.customData={},P(ae,(function(e,n){t[n]=e})),re(le,"beforeunload",this.beforeUnloadHandler.bind(this)),re(ue,"visibilitychange",this.stateChanged.bind(this)),this.updateSessionId()}return d(e,[{key:"updateSessionId",value:function(){var e=K("sessionId");e&&e.sessionId&&(this.globals.di.sessionId=e.sessionId)}},{key:"beforeUnloadHandler",value:function(){this.config.isInit&&this.config.useCookie&&ne(this.getStoreName(E),Z(),7776e6,"/"),this.stateChanged()}},{key:"getStoreName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U,n=arguments.length>2?arguments[2]:void 0;return e&&this.globals.idsite?"".concat(t).concat(e,"_").concat(this.globals.idsite,"_").concat((n||location.host).replace(/\./g,"_")):""}},{key:"handleSessionId",value:function(){var e=this.getStoreName("idn"),t=te(e);t||(t=M()),this.globals.idn=t,this.config.useCookie&&ne(e,t,this.config.intervalTime,"/")}},{key:"stateChanged",value:function(){"visible"===ue.visibilityState&&this.updateSessionId(),"hidden"===ue.visibilityState&&this.config.batchSend&&this.batchSendNow(),this.waitTimeFlag?this.waitTime+=Z()-(this.waitTimeFlagTime||this.accessTime):this.waitTimeFlagTime=Z(),this.waitTimeFlag=!this.waitTimeFlag}},{key:"getData",value:function(e,t,n){var i=le.navigator.userAgent,r=this.globals,o=r.id,s=r.rid,a=r.di,c=r.CXX,u=r.idsite,l=r.uid,h=r.cvar,d=r.idts,f=r.idvc,v=r.idn,g=r.refts,p=r.viewts;return{type:e,vf:o,rid:s,nsid:a.sessionId,rt:t.eventTime,ut:i.match(/AppleWebKit.*Mobile.*/)?-1!==H(i," wv")?2:1:0,cxx:c,idsite:u,suid:l,cvar:t.cvar||h,idts:d,idvc:f,idn:v,refts:g,viewts:p,hsv:B,data:n}}},{key:"getFinalSendData",value:function(e){var t=new Date,i=this.globals,r=i.title,o=i.id,s=i.idsite,a=i.cvar,c=i.idts,u=i.idvc,l=i.idn,h=i.refts,d=i.viewts,f=i.rid,v=i.di,g=this.config.usedPageUrl,p={idsite:encodeURIComponent(s),rec:"1",r:"886244",h:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),url:encodeURIComponent(this.deleteUrlQuery(g?le.location.href:"/",L)),_id:encodeURIComponent(o),_rid:encodeURIComponent(f),_nsid:encodeURIComponent(v.sessionId),_idts:c,_idvc:u,_idn:l,urlref:this.deleteUrlQuery(ue.referrer,L),_refts:h,_viewts:d,scd:"24",vpr:"".concat(le.screen.width," X ").concat(le.screen.height),cvar:n(e.cvar||a)?encodeURIComponent(JSON.stringify(e.cvar||a)):encodeURIComponent(e.cvar||a),pdf:"1",qt:"0",data:this.isH5?JSON.stringify(e):encodeURIComponent(JSON.stringify(e))};return e.type===C||e.type===_?A({link:encodeURIComponent(r)},p):A({action_name:encodeURIComponent(r)},p)}},{key:"initCookie",value:function(e){this.config.isInit=!0;var t=this.config,n=t.useCookie,i=t.defaultCookie.domain;if(n){if(i){var r=this.getStoreName(j,U),o=this.getStoreName(R,U);ie(r),ie(o)}var s=this.getStoreName(j,U,i),a=this.getStoreName(R,U,i),c=te(s),u=te(a);e&&e(s,c,a,u,i),c||(V.isSupport()&&V.get(s)?(c=V.get(s),u=V.get(a)||Z()):(c=M(),u=Z()),ne(s,c,7776e6,"/",i),ne(a,u,7776e6,"/",i)),this.globals.id=c,this.globals.idts=u||Z();var l=this.getStoreName("refts"),h=te(l);h||ue.referrer&&(h=Z(),ne(l,h,7776e6,"/")),this.globals.refts=h||Z();var d=this.getStoreName(E),f=te(d);this.globals.viewts=f||Z();var v=this.getStoreName("idvc"),g=te(v);g=g?Number(g)+1:V.isSupport()&&V.get(v)?Number(V.get(v))+1:1,ne(v,g,7776e6,"/"),this.globals.idvc=g,V.isSupport()&&!V.get(s)&&(V.set(s,c),V.set(a,u),V.set(v,g))}else this.globals.id="unknown",this.globals.idts=Z(),this.globals.refts=Z(),this.globals.viewts=Z(),this.globals.idvc=0;this.handleSessionId()}},{key:"setIdsite",value:function(e){return r(e)?new RegExp("^[a-zA-Z0-9_./][A-Za-z0-9_./]*$").test(e)?(this.globals.idsite=e,this.initCookie(),this):(console.error("idsite is invalid."),this):(console.error("idsite type should be string."),this)}},{key:"setAutoTrack",value:function(e,t,i){var r=this;if(!n(e))return this;var o=function(t,n){var i=new t(r);i.init(e),n&&n(i)};if(t)o(t,i);else if(le.HAAutoTracker)o(le.HAAutoTracker,i);else{var s=Z();!function(e,t){var n=ce.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=t,n.src=e,ce.getElementsByTagName("head")[0].appendChild(n)}(e.autotracker_url||X,(function(){var e=Z();Q("[load+excute] HAWebSDK autotracker module use ".concat(e-s," ms.")),o(le.HAAutoTracker,i)}))}return this}}]),e}(),de=function(){function e(t,n,i){l(this,e),this.core=t,this.dataType=n,this.serverUrl=i,this.state=0,this.keys=[],this.queue=[],this.intervalID=null}return d(e,[{key:"isH5",value:function(){return!0===this.core.isH5||void 0!==G().haGetDeviceInfo}},{key:"init",value:function(){var e=this;if(this.core.config.batchSend){P(["batchSend"],(function(t){var n=e[t];e[t]=function(){0===this.state?n.apply(this,arguments):this.queue.push([t,arguments])}})),!this.intervalID&&this.core.config.batchSend.interval&&(this.intervalID=setInterval((function(){e.batchSend()}),this.core.config.batchSend.interval))}else this.intervalID&&clearInterval(this.intervalID)}},{key:"batchSend",value:function(){var e=this,t=this.getEventsToSendFromStorage();0!==t.length&&(this.state=1,this.onReport(this.core.getFinalSendData(t),(function(t){e.state=0,200===t.status?(e.core.config.batchSend.retryTimes=10,P(e.keys,(function(e){V.remove(e)})),e.keys=[],e.batchSend(),e.queue.length>0&&(e[e.queue[0][0]].apply(e,e.queue[0][1]),e.queue=e.queue.splice(0,1))):e.core.config.batchSend.retryTimes<=1?e.intervalID&&clearInterval(e.intervalID):e.core.config.batchSend.retryTimes--}),!0))}},{key:"onceSend",value:function(e,t){this.onReport(this.core.getFinalSendData(e),t,!1)}},{key:"addToStorage",value:function(e,t){try{var n=JSON.stringify(e);if(G().haEncrypt){var i=Z();n=G().haEncrypt(n);var r=Z();Q("data encrypt use ".concat(r-i," ms. encrypted data: ").concat(n))}V.set(this.core.getStoreName(M(),x),n)}catch(n){n.message===O&&(this.onceSend(e,t),this.batchSend())}}},{key:"getEventsToSendFromStorage",value:function(){var e=[],t=0;if(this.isH5())for(var n=0;n<V.length();n++){var i=V.key(n);if(0===H(i,x)&&-1!==H(i,this.core.globals.idsite)){var r=K("network");if(r&&!1===r.network||"false"===r.network)return e;break}}for(;t<V.length();){var o=V.key(t);if(0===H(o,x)&&-1!==H(o,this.core.globals.idsite)){var s=V.get(o);try{if(G().haDecrypt){var a=Z();if(!(s=G().haDecrypt(s))){V.remove(o);continue}var c=Z();Q("data decrypt use ".concat(c-a," ms. decrypted data: ").concat(s))}(s=JSON.parse(s)).dataType===this.dataType&&(this.keys.push(o),delete s.dataType,e.push(s))}catch(e){console.error("get storage error.",e)}if(this.keys.length===this.core.config.batchSend.maxLength)return e}t++}return e}},{key:"getServerUrl",value:function(){var e="",t=this.core,n=t.globals.idsite,i=t.config,r=i.debugMode,o=i.customUrlParams,s=i.serverUrl;return r&&(e="x_hasdk_debug=true"),e=e?e+"&idsite="+n:"idsite="+n,F(o)&&(e=e+"&"+F(o)),(this.serverUrl||s)+"?"+e}},{key:"onReport",value:function(e,t,n){if(this.core.globals.idsite)if(this.core.config.serverUrl)if(this.core.config.batchSend&&n)this.sendByAjax(e,t);else if(this.core.config.requestMode)switch(this.core.config.requestMode){case"beacon":this.sendByBeacon(e);break;case"ajax":J()?this.sendByAjax(e,t):this.sendByBeacon(e);break;case"img":this.sendByImg(e)}else this.core.config.isImg?this.sendByImg(e):z()?this.sendByBeacon(e):J()?this.sendByAjax(e,t):this.sendByImg(e);else console.error("serverUrl is empty");else console.error("idsite is empty")}},{key:"sendByAjax",value:function(e,n){var i=F(e),r=new XMLHttpRequest;r.open("POST",this.getServerUrl(),!0),A(this.core.config.defaultHeaders,{idsite:this.core.globals.idsite}),P(this.core.config.defaultHeaders,(function(e,t){r.setRequestHeader(t,e)})),this.core.config.batchSend&&(r.timeout=this.core.config.batchSend.timeout),r.send(i),r.onreadystatechange=function(){r.readyState==r.DONE&&n&&t(n)&&n(r)}}},{key:"sendByImg",value:function(e){var t=F(e);this.core.config.debugMode&&(t="x_hasdk_debug=true&"+t);var n=new Image(1,1);n.onerror=function(){},n.src=this.core.config.serverUrl+"?"+t}},{key:"sendByBeacon",value:function(e){var t=F(e),n=new Blob([t],{type:"application/x-www-form-urlencoded;charset=UTF-8"});navigator.sendBeacon(this.getServerUrl(),n)}}]),e}(),fe=document,ve=window,ge=function(e){v(u,e);var c=m(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l(this,u),(e=c.call(this,t)).config.linker={},e.config.serverUrl="",e.config.requestMode="",e.config.isImg=!1,e.config.debugMode=!1,e.config.customUrlParams={},e.config.defaultHeaders={"Content-type":"application/x-www-form-urlencoded;charset=UTF-8"},e.defaultSender=new de(y(e)),e.reportMap={},re(fe,"click",e.hrefIntercept.bind(y(e)),!0),e}return d(u,[{key:"urlAddLinker",value:function(e,t){if(!e)return e;var n=e.split("#"),i=n[0],r=n[1]?"#".concat(n[1]):"",o=i.replace(/(https|http):\/\/([^/?]+)(.*)/,"$2"),s=!1;if((this.config.linker.exclude&&(s=this.config.linker.exclude.includes(o)),this.config.linker.domains&&!s)&&this.config.linker.domains.filter((function(e){return new RegExp("".concat(e,"$"),"i").test(o)})).length){t&&t.preventDefault();var a=this.getStoreName(j,U,this.config.defaultCookie.domain),c={ts:Z(),id:te(a)};this.config.linker.ext&&(c.ext=this.config.linker.ext),i=H(i,"?")>-1?"".concat(i,"&ha_linker=").concat(ve.btoa(JSON.stringify(c))).concat(r):"".concat(i,"?ha_linker=").concat(ve.btoa(JSON.stringify(c))).concat(r)}return i}},{key:"hrefIntercept",value:function(e){var t=e.target||e.srcElement;if(!("a"===q(t))){var n=$(t);if(!n)return;t=n}var i=t.getAttribute("href");i&&(i=this.urlAddLinker(i,e),H(i,"ha_linker")>-1&&ve.open(i,t.getAttribute("target")||"_self"))}},{key:"initCookie",value:function(){var e=this;b(g(u.prototype),"initCookie",this).call(this,(function(t,n,i,r,o){var s=se(fe.location.href).ha_linker;if(s)try{var a=JSON.parse(ve.atob(s));!(Z()-a.ts>(a.ext||1e4))&&a.id&&(n||(n=a.id,ne(t,n,7776e6,"/",o),r=Z(),ne(i,r,7776e6,"/",o)),e.globals.rid=a.id)}catch(e){console.error("Invalid linker:"+e)}}))}},{key:"getSender",value:function(){var e=this,t=null;return P(this.reportMap,(function(n){n.url===e.config.serverUrl&&(t=n.sender)})),t||this.defaultSender}},{key:"push",value:function(){for(var e=arguments,t=this,n=function(){var n=e[i],o=n.shift();setTimeout((function(){try{r(o)?t[o].apply(t,n):t.apply(t,n)}catch(e){console.error("Invalid method:"+o+", please check!")}}),0)},i=0;i<arguments.length;++i)n();return this}},{key:"setOnReportUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this.config.serverUrl=e;var n=e;return a(t)||(n=t),this.reportMap[n]||(this.reportMap[n]={url:e,sender:new de(this,n,e)},this.config.batchSend&&this.reportMap[n].sender.init()),this}},{key:"setTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.globals.title=e,this}},{key:"setUserAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.globals.id=e,this}},{key:"setCXX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.globals.CXX=e,this}},{key:"setUid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.globals.uid=e,this}},{key:"setPageData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.globals.cvar=e,this}},{key:"setCustomData",value:function(e){return n(e)||t(e)?this.customData=e:console.error("The arguments of the setCustomData() method is invalid."),this}},{key:"setHttpHeader",value:function(e){return n(e)?(A(this.config.defaultHeaders,e),this):(console.error("custom header type should be object."),this)}},{key:"setIsUseCookie",value:function(e){if(!s(e))return console.error("useCookie type should be boolean"),this;if(this.config.useCookie=e,!this.config.useCookie){var t=fe.cookie.split("; "),n=/^(HW_)(id|idts|idvc|idn|viewts|refts)_/;P(t,(function(e){var t=e.split("=");n.test(t[0])&&ie(t[0])})),this.initCookie()}return this}},{key:"setReportMethod",value:function(e){return s(e)?(this.config.isImg=e,this):(console.error("isImg type should be boolean."),this)}},{key:"setSessionTimeoutDuration",value:function(e){return o(e)?(this.config.intervalTime=e,this):(console.error("intervalTime type should be number."),this)}},{key:"setDebugMode",value:function(e){return s(e)?(this.config.debugMode=e,this):(console.error("debugMode type should be boolean"),this)}},{key:"setCustomUrlParams",value:function(e){if(!n(e))return console.error("customUrlParams type should be object"),this;for(var t in e){if(N(["x_hasdk_debug","url","_id","_idts","_idvc","h","m","s","_rid"],t))return console.error("customUrlParams can'n include x_hasdk_debug, url, _id, _idts, _idvc, h, m, s, _rid"),this;var i=e[t];if(!i||!o(i)&&!r(i))return console.error("customUrlParams object value should be number or string"),this;if(!new RegExp("^[a-zA-Z0-9_./][A-Za-z0-9_./]*$").test(t)||!new RegExp("^[a-zA-Z_0-9_./][A-Za-z0-9_./]*$").test(i))return console.error("customUrlParams object include invalid key or value"),this;A(this.config.customUrlParams,f({},t,i))}return this}},{key:"setIstUseUrl",value:function(e){return s(e)?(this.config.usedPageUrl=e,this):(console.error("usedPageUrl type should be boolean."),this)}},{key:"setRequestMode",value:function(e){return"ajax"!==e||J()?"beacon"!==e||z()?(N(["beacon","ajax","img"],e)&&(this.config.requestMode=e),this):(console.error("navigator.sendBeacon() is not supported."),this):(console.error("XMLHttpRequest is not supported."),this)}},{key:"setBatchSend",value:function(e){if(!V.isSupport())return console.error("localStorage is not supported, so batch send is not supported."),this;if(!J())return console.error("XMLHttpRequest is not supported, so batch send is not supported."),this;var t={timeout:6e3,interval:6e3,maxLength:6,retryTimes:10};return s(e)&&e?this.config.batchSend=t:n(e)&&(this.config.batchSend=A(t,e)),P(this.reportMap,(function(e){e.sender&&e.sender.init()})),this}},{key:"batchSendNow",value:function(){return P(this.reportMap,(function(e){e.sender&&e.sender.batchSend()})),this}},{key:"setLinker",value:function(e){return n(e)?i(e.domains)?e.exclude&&!i(e.exclude)?(console.error("custom exclude type should be Array."),this):(this.config.linker=e,this):(console.error("custom domains type should be Array."),this):(console.error("custom linker type should be object."),this)}},{key:"setUrlLinker",value:function(e){return this.urlAddLinker(e)}},{key:"setCookie",value:function(e){return n(e)?(this.config.defaultCookie=e,this):(console.error("custom cookie type should be object."),this)}}]),u}(he),pe=document,ye=window,me=pe.documentElement,be=pe.body;var ke=document,we=window,Se=function(e){v(n,e);var t=m(n);function n(){var e;return l(this,n),(e=t.call(this)).config.baseinfotypeSwitch1=!1,e.switch1Num=0,e.config.baseinfotypeSwitch2=!1,e.switch2Num=0,e}return d(n,[{key:"setBaseinfotypeSwitch",value:function(e){return s(e)?(this.config.baseinfotypeSwitch1=e,e&&0===this.switch1Num&&(this.switch1Num++,re(ke,"DOMContentLoaded",this.reportPageEntryEvent.bind(this))),this):(console.error("baseinfotypeSwitch1 type should be boolean."),this)}},{key:"setWindowCloseSwitch",value:function(e){return s(e)?(this.config.baseinfotypeSwitch2=e,e&&0===this.switch2Num&&(this.switch2Num++,re(we,"beforeunload",this.reportPageCloseEvent.bind(this))),this):(console.error("baseinfotypeSwitch2 type should be boolean."),this)}},{key:"sendPageinfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.waitTime=0,this.waitTimeFlagTime=0,this.waitTimeFlag=!0,this.accessTime=Z(),this.config.baseinfotypeSwitch1=!0,this.reportPageEntryEvent(e,t),this}},{key:"sendPageClose",value:function(){return this.config.baseinfotypeSwitch2=!0,this.reportPageCloseEvent(),this}},{key:"sendData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s={eventTime:Z(),eventName:e,eventLabel:t,customData:n,cvar:i};return this.execReport(I,s,r,o),this}},{key:"sendClickData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s={eventTime:Z(),eventName:e,eventLabel:t,customData:n,cvar:i};return this.execReport(C,s,r,o),this}},{key:"bindclick",value:function(e,t,n,i,r){var o=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=e===ke?ke:ke.getElementById(e);return a?(re(a,t,(function(t){var c=t.screenX,u=t.screenY,l=t.clientX,h=t.clientY,d=ye.innerHeight||me.clientHeight||be.clientHeight||0,f=ye.innerWidth||me.clientWidth||be.clientWidth||0,v={eventTime:Z(),elementId:e,cls:a.className,data:n,cvar:i,position:{res:"".concat(c,"X").concat(u),vpr:"".concat(l,"X").concat(h),doc:"".concat(f,"X").concat(d)}};o.execReport(_,v,r,s)})),this):this}},{key:"reportPageEntryEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.execReport(T,{eventTime:Z()},e,t)}},{key:"reportPageCloseEvent",value:function(){this.execReport(T,{eventTime:Z()})}},{key:"execReport",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.handleSessionId();var r=this.getEventData(e,t),o=this.getSender();this.config.batchSend&&!i?(r.dataType=o.dataType,o.addToStorage(r,n)):o.onceSend(r,n)}},{key:"getEventData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.currentUrl,i=void 0===n?we.location.href:n,r={url:oe(this.config.usedPageUrl?i:"/",L),title:this.globals.title,at:this.accessTime,rf:oe(ke.referrer,L)};return e===T?(r.res="".concat(we.screen.width," X ").concat(we.screen.height),r.cwt=t.eventTime,r.dt=this.waitTime):e===I||e===C?(r.en=t.eventName,r.el=t.eventLabel,r.cd=t.customData):e===_&&(r.ei=t.elementId===ke?"#document":t.elementId,r.ec=t.cls,r.ps=t.position,r.data=t.data||""),this.getData(e,t,r)}}]),n}(ge),Te=Z(),Ie=new Se,_e=Z();return Q("[excute] hawebsdk use ".concat(_e-Te," ms.")),Ie}));
