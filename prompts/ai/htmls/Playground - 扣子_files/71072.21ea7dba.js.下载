"use strict";(self.webpackChunkapp_botstudio_main=self.webpackChunkapp_botstudio_main||[]).push([["71072"],{870429:function(e,r,o){o.d(r,{CH:()=>ep,kq:()=>ec,Co:()=>ea,pH:()=>ed,Rq:()=>x,tl:()=>ew,uR:()=>ej,ew:()=>ei});var t,l,n=o("255721"),s=o("938809"),i=o("723530"),a=o("559293"),d=o("797602"),c=o("16242"),m=o("182956"),u=o("449001"),p=e=>{var r,o,{visible:t,onClose:l,onSuccess:p,spaceId:x,libraryId:h,mode:y="create"}=e,_="edit"===y,v=_?c.o.t("memory_library_general_edit_memory_lib"):c.o.t("memory_library_general_create_memory_lib"),f=(0,i.useRef)(null),{loading:g}=(0,a.Z)((0,n._)(function*(){return _&&h?(yield u.v6.GetMemorybaseById({id:h})).memorybase_info:null}),{manual:!1,ready:_&&!!h,onSuccess:e=>{var r;if(!!e&&!!_)null===(r=f.current)||void 0===r||r.setValues({name:e.name,description:e.desc})}});var{run:j,loading:b}=(0,a.Z)((r=(0,n._)(function*(e){var r,o,t,l,n;if(_&&h)return yield u.v6.UpdateMemorybase({id:h,show_name:e.name.trim(),desc:(null===(t=e.description)||void 0===t?void 0:t.trim())||""}),{memoryLibraryId:h,name:e.name.trim(),description:(null===(l=e.description)||void 0===l?void 0:l.trim())||""};return{memoryLibraryId:null!==(n=(yield u.v6.CreateMemorybase({name:e.name.trim(),description:(null===(r=e.description)||void 0===r?void 0:r.trim())||"",space_id:x})).memorybase_id)&&void 0!==n?n:"",name:e.name.trim(),description:(null===(o=e.description)||void 0===o?void 0:o.trim())||""}}),function(e){return r.apply(this,arguments)}),{manual:!0,onSuccess:e=>{m.Toast.success(_?c.o.t("memory_library_validate_memory_lib_update_success"):c.o.t("memory_library_validate_memory_lib_create_success")),null==p||p(e)},ready:!!x});var M=(o=(0,n._)(function*(){var e,r=yield null===(e=f.current)||void 0===e?void 0:e.validate();r&&(yield j(r))}),function(){return o.apply(this,arguments)});return(0,s.jsx)(m.Modal,{title:v,visible:t,onCancel:l,onOk:M,confirmLoading:b||g,width:480,okText:_?c.o.t("Update"):c.o.t("Confirm"),cancelText:c.o.t("Cancel"),children:(0,s.jsxs)(m.Form,{getFormApi:e=>f.current=e,onSubmit:M,children:[(0,s.jsx)(d.NB,{field:"name",label:c.o.t("memory_library_general_memory_lib_name"),placeholder:c.o.t("memory_library_form_please_input_memory_lib_name"),autoComplete:"off",maxLength:20,rules:[{required:!0,message:c.o.t("memory_library_form_please_input_memory_lib_name")},{max:20,message:c.o.t("memory_library_general_memory_lib_name_cannot_exceed",{count:20})},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:c.o.t("memory_library_general_memory_lib_name_limit")}]}),(0,s.jsx)(m.Form.TextArea,{field:"description",label:c.o.t("memory_library_general_memory_lib_description"),placeholder:c.o.t("memory_library_form_please_input_memory_lib_descriptio"),maxLength:500,maxCount:500,rows:3,rules:[{max:500,message:c.o.t("memory_library_general_memory_lib_description_cannot_e",{count:500})}]})]},_?"edit-".concat(h):"create")})},x=e=>{var{spaceId:r,libraryId:o,mode:t="create",onSuccess:l}=e,[n,a]=(0,i.useState)(!1);return{open:()=>a(!0),close:()=>a(!1),modal:n&&(0,s.jsx)(p,{onClose:()=>a(!1),visible:!0,spaceId:r,libraryId:o,mode:t,onSuccess:e=>{a(!1),null==l||l(e)}})}},h=o("345305"),y=o("972344"),_=o("341333"),v=o("265489"),f=o("888953"),g=o("922321"),j=o("468745"),b=()=>({memorybaseId:"",memorybaseInfo:{data:null,loading:!1},currentUser:null,selectedUser:null,userListInfo:{data:[],hasMore:!1,loading:!1,loadingMore:!1},memoryMetaInfo:{data:[],hasMore:!1,loading:!1,loadingMore:!1},statusInfo:{isLoading:!1,hasError:!1},searchValue:"",selectedConnectorIds:[],connectorList:{data:[],loading:!1}}),M=(0,g.Ue)()((0,f.mW)((0,f.XR)((e,r)=>(0,v._)((0,_._)({},b()),{setMemorybaseId:r=>{e({memorybaseId:r},!1,"setMemorybaseId")},setMemorybaseInfo:r=>{e({memorybaseInfo:r},!1,"setMemorybaseInfo")},updateMemorybaseInfoByImmer:r=>{e((0,j.Uy)(r),!1,"updateMemorybaseInfoByImmer")},setUserListInfo:o=>{var{memorybaseId:t}=r();if(!!t)e({userListInfo:o},!1,"setUserListInfo")},updateUserInfoByImmer:r=>{e((0,j.Uy)(r),!1,"updateUserInfoByImmer")},setSelectedUser:r=>{e({selectedUser:r},!1,"setSelectedUser")},setMemoryMetaInfo:r=>{e({memoryMetaInfo:r},!1,"setMemoryMetaInfo")},updateMemoryMetaInfoByImmer:r=>{e((0,j.Uy)(r),!1,"updateMemoryMetaInfoByImmer")},clearMemoryMetaInfo:()=>{e({memoryMetaInfo:b().memoryMetaInfo},!1,"clearMemoryMetaInfo")},setSearchValue:r=>{e({searchValue:r},!1,"setSearchValue")},setSelectedConnectorIds:r=>{e({selectedConnectorIds:r},!1,"setSelectedChannels")},setConnectorList:r=>{e({connectorList:r},!1,"setConnectorList")},updateConnectorListByImmer:r=>{e((0,j.Uy)(r),!1,"updateConnectorListByImmer")},clear:()=>{e((0,_._)({},b()),!1,"clear")}})),{enabled:!1,name:"Data.MemoryIDE"})),I=e=>{var{memorybaseId:r}=e,{setMemorybaseId:o,updateMemorybaseInfoByImmer:t}=M((0,h.N)(e=>({setMemorybaseId:e.setMemorybaseId,updateMemorybaseInfoByImmer:e.updateMemorybaseInfoByImmer})));(0,i.useEffect)(()=>{if(!!r)o(r)},[r]);var{loading:l}=(0,a.Z)((0,n._)(function*(){return(yield u.v6.GetMemorybaseById({id:r})).memorybase_info}),{manual:!1,refreshDeps:[r],ready:!!r,onSuccess:e=>{t(r=>({memorybaseInfo:{data:e||null,loading:!1}}))}});(0,i.useEffect)(()=>{l&&t(e=>{e.memorybaseInfo.loading=!0})},[l])},N=e=>{var r,{memorybaseId:o,className:t,renderNavBar:l,renderContent:n}=e,{memorybaseInfo:i}=M((0,h.N)(e=>({memorybaseInfo:e.memorybaseInfo})));return I({memorybaseId:o}),(0,s.jsx)(y.xV,{namespace:y.xW.MEMORY,children:(0,s.jsxs)(m.Layout,{className:t||"flex flex-col p-[24px] pt-5 gap-[16px] !bg-transparent",title:"".concat((null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.name)||c.o.t("memory_library_general_memory_lib")),children:[null==l?void 0:l(),null==n?void 0:n()]})})},z=o("856306"),w=o.n(z),C=o("988726"),S=()=>{var e,{runAsync:r,loading:o}=(0,a.Z)((e=(0,n._)(function*(e){var r,o;yield u.v6.DeleteMemoryMeta({memorybase_id:M.getState().memorybaseId,connector_id:null!==(r=String(e.connector_id))&&void 0!==r?r:"",connector_uid:null!==(o=e.connector_uid)&&void 0!==o?o:""})}),function(r){return e.apply(this,arguments)}));return{deleteMemoryByConnector:r,loading:o}},k=o("387294"),T=e=>{var r,{params:o,onSuccess:t,onError:l,reloadDeps:s=[],target:i=null,ready:a=!0}=e;var{loading:d,data:c,loadingMore:m,mutate:p,cancel:x,reload:h,loadMore:y}=(0,k.Z)((r=(0,n._)(function*(e){if(!o.memorybase_id||!o.connector_id||!o.connector_uid||!a)return{list:[],hasMore:!1,nextCursorId:"0"};var r,t,l,n=yield u.v6.GetMemoryMetaList((0,v._)((0,_._)({},o),{cursor_id:null==e?void 0:e.nextCursorId,limit:15})),s=(null===(r=n.data)||void 0===r?void 0:r.memory_meta_list)||[],i=(null===(t=n.data)||void 0===t?void 0:t.has_more)||!1;return{list:s,hasMore:i,nextCursorId:(null===(l=n.data)||void 0===l?void 0:l.next_cursor_id)||"0"}}),function(e){return r.apply(this,arguments)}),{isNoMore:e=>!(null==e?void 0:e.hasMore),target:i,onBefore:()=>{(m||d)&&x()},onSuccess:t,onError:l,reloadDeps:s});return{loading:d,data:c,loadingMore:m,mutate:p,cancel:x,reload:h,loadMore:y,pageSize:15}},B=e=>{var r,{params:o,onSuccess:t,onError:l,reloadDeps:s=[],target:i=null,ready:a=!0}=e;var{loading:d,data:c,loadingMore:m,mutate:p,cancel:x,reload:h,loadMore:y}=(0,k.Z)((r=(0,n._)(function*(e){if(!o.memorybase_id||!a)return{list:[],hasMore:!1,nextPageIndex:1};var r,t,l=(null==e?void 0:e.nextPageIndex)||1,n=yield u.v6.GetMemoryMetaUserList({memorybase_id:o.memorybase_id,user_name:o.user_name,connector_ids:o.connector_ids,offset:(l-1)*25,limit:25}),s=(null===(r=n.data)||void 0===r?void 0:r.user_infos)||[];return{list:s,hasMore:(null===(t=n.data)||void 0===t?void 0:t.has_more)||!1,nextPageIndex:l+1}}),function(e){return r.apply(this,arguments)}),{isNoMore:e=>!(null==e?void 0:e.hasMore),target:i,onBefore:()=>{(m||d)&&x()},onSuccess:t,onError:l,reloadDeps:s});return{loading:d,data:c,loadingMore:m,mutate:p,cancel:x,reload:h,loadMore:y,pageSize:25}},A=e=>{var{target:r}=e,{memorybaseId:o,searchValue:t,selectedConnectorIds:l,setUserListInfo:n,updateUserInfoByImmer:s,setSelectedUser:a}=M((0,h.N)(e=>({memorybaseId:e.memorybaseId,searchValue:e.searchValue,selectedConnectorIds:e.selectedConnectorIds,setUserListInfo:e.setUserListInfo,updateUserInfoByImmer:e.updateUserInfoByImmer,setSelectedUser:e.setSelectedUser}))),{loading:d,data:c,loadingMore:m,reload:u,loadMore:p,mutate:x}=B({target:r,params:{memorybase_id:o,user_name:t,connector_ids:l},reloadDeps:[o,t,l],ready:!!o,onSuccess:e=>{var r=(null==e?void 0:e.list)||[];n({data:r,hasMore:(null==e?void 0:e.hasMore)||!1,loading:!1,loadingMore:!1}),r.length>0&&(!e||2===e.nextPageIndex)&&a(r[0])}});return(0,i.useEffect)(()=>{s(e=>{e.userListInfo.loading=d,e.userListInfo.loadingMore=m})},[d,m,s]),{data:c,hasMore:(null==c?void 0:c.hasMore)||!1,userList:(null==c?void 0:c.list)||[],loading:d,loadingMore:m,reload:u,loadMore:p,mutate:x}},U=()=>{var e=(0,i.useRef)(null),{userList:r,loading:o,loadingMore:t,reload:l}=A({target:e}),{selectedUser:a,setSelectedUser:d,clearMemoryMetaInfo:u}=M((0,h.N)(e=>({selectedUser:e.selectedUser,setSelectedUser:e.setSelectedUser,clearMemoryMetaInfo:e.clearMemoryMetaInfo}))),{deleteMemoryByConnector:p}=S(),[x,y]=(0,i.useState)(null),[_,v]=(0,i.useState)(null),f=e=>(null==a?void 0:a.connector_id)===e.connector_id&&(null==a?void 0:a.connector_uid)===e.connector_uid;return(0,i.useEffect)(()=>{r.length>0&&!a&&d(r[0])},[r,a,d]),(0,i.useEffect)(()=>{!a&&u()},[a,u]),(0,s.jsx)("div",{className:"flex flex-col h-full coz-bg-max",children:(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3",children:(0,s.jsx)(m.Spin,{spinning:o,wrapperClassName:"!h-full !w-full flex-grow overflow-hidden",childStyle:{height:"100%",flexGrow:1,width:"100%"},children:(0,s.jsxs)("div",{className:"flex flex-col gap-1 h-full overflow-auto",ref:e,children:[r.map(e=>""!==e.connector_uid?(0,s.jsx)("div",{className:w()("w-full h-8 px-2 py-1.5 rounded-lg hover:coz-mg-primary cursor-pointer","flex items-center justify-between",f(e)&&"coz-mg-primary"),onClick:()=>d(e),onMouseEnter:()=>{var r;return y(null!==(r=e.connector_uid)&&void 0!==r?r:null)},onMouseLeave:()=>y(null),children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,s.jsx)(C.U5H,{}),(0,s.jsx)(m.Typography.Text,{ellipsis:{showTooltip:!0},className:"text-[14px] coz-fg-plus font-medium truncate flex-1",children:e.connector_uid})]}),(0,s.jsx)(m.Popconfirm,{visible:_===e.connector_uid,trigger:"custom",style:{width:240},okButtonColor:"red",okText:c.o.t("Delete"),cancelText:c.o.t("Cancel"),title:c.o.t("db_del_table_confirm_title"),position:"rightTop",onClickOutSide:()=>v(null),content:c.o.t("memory_library_action_delete_after_user_memory_data"),onConfirm:(0,n._)(function*(){var r,o;yield p({connector_id:null!==(r=e.connector_id)&&void 0!==r?r:"",connector_uid:null!==(o=e.connector_uid)&&void 0!==o?o:""}),l(),v(null),y(null)}),onCancel:e=>{e.stopPropagation(),v(null)},children:(0,s.jsx)("div",{children:x===e.connector_uid?(0,s.jsx)(m.Tooltip,{content:c.o.t("memory_library_action_delete_user_long_term_memory_dat"),children:(0,s.jsx)(m.IconButton,{size:"mini",color:"secondary",icon:(0,s.jsx)(C.dVD,{className:"text-[14px]"}),iconPosition:"left",onClick:()=>{var r;return v(null!==(r=e.connector_uid)&&void 0!==r?r:null)}})}):null})})]})},"".concat(e.connector_id,"-").concat(e.connector_uid)):null),t?(0,s.jsx)("div",{className:"flex justify-center py-2",children:(0,s.jsx)(m.Spin,{size:"small"})}):null]})})})})},O=o("973746"),D=o("666428"),L=e=>{var r,{target:o}=e,{memorybaseId:t,selectedUser:l,setMemoryMetaInfo:n,updateMemoryMetaInfoByImmer:s}=M((0,h.N)(e=>({memorybaseId:e.memorybaseId,selectedUser:e.selectedUser,setMemoryMetaInfo:e.setMemoryMetaInfo,updateMemoryMetaInfoByImmer:e.updateMemoryMetaInfoByImmer}))),{loading:a,data:d,loadingMore:c,reload:m,loadMore:u,mutate:p}=T({target:o,params:{memorybase_id:t,connector_id:(null==l?void 0:null===(r=l.connector_id)||void 0===r?void 0:r.toString())||"",connector_uid:(null==l?void 0:l.connector_uid)||""},reloadDeps:[t,l],ready:!!(t&&(null==l?void 0:l.connector_id)&&(null==l?void 0:l.connector_uid)),onSuccess:e=>{n({data:(null==e?void 0:e.list)||[],hasMore:(null==e?void 0:e.hasMore)||!1,loading:!1,loadingMore:!1})}});return(0,i.useEffect)(()=>{s(e=>{e.memoryMetaInfo.loading=a,e.memoryMetaInfo.loadingMore=c})},[a,c]),{data:d,hasMore:(null==d?void 0:d.hasMore)||!1,loading:a,loadingMore:c,reload:m,loadMore:u,mutate:p}},H=o("312186"),V=()=>{var e,{runAsync:r,loading:o,data:t}=(0,a.Z)((e=(0,n._)(function*(e){var r;yield u.v6.UpdateMemoryMeta({memory_id:null!==(r=e.slice_id)&&void 0!==r?r:"",memorybase_id:M.getState().memorybaseId,raw_content:e.content,memory_type:e.memory_type,meta_type:e.meta_type})}),function(r){return e.apply(this,arguments)}));return{updateMemoryMeta:r,loading:o,data:t}},E=()=>{var e,r=M(e=>e.memorybaseId);var{runAsync:o,loading:t}=(0,a.Z)((e=(0,n._)(function*(e){var o;yield u.v6.DeleteMemoryMeta({memorybase_id:r,memory_id:null!==(o=e.slice_id)&&void 0!==o?o:"",meta_type:e.meta_type})}),function(r){return e.apply(this,arguments)}),{manual:!0});return{deleteMemoryMeta:o,loading:t}},R=o("888779");var W=((t=(0,H.Cd)("preview-context-menu-items")).registerSome([{type:"edit",module:{Component:R.i1}},{type:"delete",module:{Component:R.sL}}]),t),q=o("221968"),Y=o.n(q),P=e=>{var{eventTime:r}=e;return(0,s.jsx)("div",{className:"flex items-center justify-between coz-fg-dim pt-2 px-0",children:(0,s.jsx)("span",{className:"text-[14px] leading-5",children:Y()(Number(r)).format("YYYY-MM-DD HH:mm")})})},Z=o("371202");var G=((l=(0,H.Hu)("hover-edit-bar-actions")).registerSome([{type:"edit",module:{Component:Z.i1}},{type:"delete",module:{Component:Z.sL}}]),l),X=e=>{var{chunks:r,memoryId:o,readonly:t=!1,onChange:l,onAddChunk:n,onDeleteChunk:a}=e,[d,c]=(0,i.useState)(r),[m,u]=(0,i.useState)(null),{updateMemoryMeta:p}=V(),{deleteMemoryMeta:x}=E(),{editor:h}=(0,H.nR)({chunk:m,onInitFailed:()=>{u(null)},customRequest:{updateRemoteChunk:p,deleteRemoteChunk:x}}),{saveChunk:y}=(0,H.Bo)({chunks:d,documentId:o,onChunksChange:e=>{null==l||l(e),u(null)},onAddChunk:n,onDeleteChunk:a});return(0,H.OR)("previewContextMenuItemAction",(0,i.useCallback)(e=>{var{type:r,newChunk:o,chunks:t,targetChunk:n}=e;"delete"===r&&(null==a||a(n),t&&c(t),t&&(null==l||l(t))),"edit"===r&&u(n)},[a,l])),(0,H.OR)("hoverEditBarAction",(0,i.useCallback)(e=>{var{type:r,targetChunk:o,chunks:t,newChunk:n}=e;"delete"===r&&(null==a||a(o),t&&c(t),t&&(null==l||l(t))),"edit"===r&&u(o)},[a,l])),(0,i.useEffect)(()=>{c(r)},[r]),(0,s.jsx)(s.Fragment,{children:d.map(e=>(0,s.jsx)("div",{children:e.data_editor_chunk_uuid===(null==m?void 0:m.data_editor_chunk_uuid)&&m?(0,s.jsx)(H.R_,{editor:h,onBlur:e=>{y((0,v._)((0,_._)({},m),{content:e}))},editorBottomSlot:e.event_time?(0,s.jsx)(P,{eventTime:e.event_time}):null}):(0,s.jsx)(H.iF,{chunk:e,chunks:d,chunkClassName:w()("border-0 border-b coz-bg-max rounded-none !mb-0","hover:coz-mg-hglt-secondary-hovered hover:rounded-[8px]"),readonly:t,onActivateEditMode:u,hoverEditBarActionsRegistry:G,previewContextMenuItemsRegistry:W,bottomSlot:e.event_time?(0,s.jsx)(P,{eventTime:e.event_time}):null})},e.data_editor_chunk_uuid))})},F=()=>{var e,r=(0,i.useRef)(null),{data:o,loading:t,mutate:l}=L({target:r}),{memorybaseId:n,searchValue:a}=M((0,h.N)(e=>({memorybaseId:e.memorybaseId,searchValue:e.searchValue})));return t&&(!o||0===o.list.length)?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(m.Spin,{size:"large"})}):o&&0!==o.list.length?(0,s.jsx)("div",{className:"flex-1 overflow-auto px-2 py-2",ref:r,children:(0,s.jsx)(X,{chunks:(null==o?void 0:null===(e=o.list)||void 0===e?void 0:e.map(e=>{var r,o;return(0,v._)((0,_._)({},e),{data_editor_chunk_uuid:null!==(r=e.memory_id)&&void 0!==r?r:"",slice_id:null!==(o=e.memory_id)&&void 0!==o?o:""})}))||[],memoryId:n,onChange:e=>l((0,v._)((0,_._)({},o),{list:e}))})}):(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-full pb-[5%]",children:(0,s.jsx)(m.EmptyState,{size:"large",icon:a?(0,s.jsx)(O.xs,{style:{width:150,height:"100%"}}):(0,s.jsx)(D.s9d,{style:{width:150,height:"100%"}}),title:a?c.o.t("knowledge_no_result"):c.o.t("memory_library_general_empty_memory")})})},K=()=>{var{memoryMetaInfo:e}=M((0,h.N)(e=>({memoryMetaInfo:e.memoryMetaInfo})));return(0,s.jsx)(m.Spin,{spinning:e.loading,size:"large",wrapperClassName:"!h-full !w-full flex-grow rounded-r-[8px] overflow-hidden",childStyle:{height:"100%",flexGrow:1,width:"100%"},children:(0,s.jsxs)("div",{className:"flex flex-col h-full coz-bg-max",children:[(0,s.jsx)("div",{className:"flex items-center gap-1 py-3 px-4 border-0 border-b border-solid coz-stroke-primary",children:(0,s.jsx)("span",{className:"text-[14px] coz-fg-plus font-medium w-14 flex-shrink-0",children:c.o.t("memory_library_general_memory_storage")})}),(0,s.jsx)(F,{})]})})},J=()=>(0,s.jsxs)("div",{className:w()("flex flex-grow border border-solid coz-stroke-primary coz-bg-max","h-[812px] rounded-[8px] overflow-hidden"),children:[(0,s.jsx)("div",{className:w()("w-[300px] h-full flex-shrink-0","border-0 border-r border-solid coz-stroke-primary coz-bg-max"),children:(0,s.jsx)(U,{})}),(0,s.jsx)("div",{className:"flex-grow h-full overflow-hidden",children:(0,s.jsx)(K,{})})]}),Q=o("842197"),$=()=>{var e=M(e=>e.memorybaseId),{runAsync:r,loading:o}=(0,a.Z)((0,n._)(function*(){try{return yield u.v6.DeleteMemorybase({id:e}),{success:!0}}catch(e){return{success:!1,error:e}}}),{manual:!0});return{deleteMemorybase:r,loading:o}},ee=e=>{var{spaceId:r}=e,{updateConnectorListByImmer:o}=M((0,h.N)(e=>({updateConnectorListByImmer:e.updateConnectorListByImmer}))),{loading:t,data:l}=(0,a.Z)((0,n._)(function*(){var e;return null===(e=(yield u.v6.GetConnectorNameForMemoryLib({SpaceId:r||"",ListAll:!0})).ConnectorList)||void 0===e?void 0:e.map(e=>({connectorId:e.ConnectorIDStr||"",connectorName:e.ConnectorName||""}))}),{manual:!1,refreshDeps:[r],ready:!!r,onSuccess:e=>{o(r=>({connectorList:{data:e,loading:!1}}))}});return(0,i.useEffect)(()=>{o(e=>{e.connectorList.loading=t})},[t]),{connectorList:l||[],loading:t}},er=o("494589"),eo=o("753940"),et=o("929635"),el=e=>{if(e<=9999)return e.toString();if(e>0x5f5e0ff)return"9999w+";if(e>=1e4){var r=e/1e4;return r%1==0?"".concat(r,"w"):"".concat(r.toFixed(0),"w")}return e.toString()},en=o("280067"),es=e=>{var r;return null===(r=(0,en.LZ)(e=>e.plansCN).find(r=>{var o;return r.member_version===(null==e?void 0:null===(o=e.volcano_account_info)||void 0===o?void 0:o.user_level)}))||void 0===r?void 0:r.configuration_name},ei=e=>{var r,o,t,l,n,{className:a,size:d,memorybaseInfo:u}=e,{node:p,open:x}=(0,eo.zv)({scene:eo.ej.MemoryLibrary}),h=null==u?void 0:null===(o=u.data)||void 0===o?void 0:null===(r=o.volcano_account_info)||void 0===r?void 0:r.can_upgrade,y=es((null==u?void 0:u.data)||{}),[_,v]=(0,i.useState)(!1),f=(0,s.jsx)("div",{className:"w-80 p-3",children:(0,s.jsxs)("div",{className:"relative z-10 flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(C.sWZ,{className:"coz-fg-hglt"}),(0,s.jsx)("span",{className:"text-[16px] coz-fg-plus font-medium",children:c.o.t("memory_library_general_continue_write",{count:el(Number(null==u?void 0:null===(t=u.data)||void 0===t?void 0:t.remain_memory_items_cnt)||0)})})]}),(0,s.jsxs)("ul",{className:"text-[14px] coz-fg-primary m-0 pl-[20px]",children:[(0,s.jsxs)("li",{children:[y,c.o.t("memory_library_general_memory_lib_9",{count:el(Number(null==u?void 0:null===(l=u.data)||void 0===l?void 0:l.total_memory_items_cnt)||0)})]}),(0,s.jsx)("li",{children:c.o.t("memory_library_action_please_upgrade_delete_existing")}),(0,s.jsxs)("li",{children:[c.o.t("memory_library_general_more_description_see_details"),(0,s.jsx)("a",{href:"https://www.coze.cn/open/docs/guides/long_term_memory#42e2a675",target:"_blank",rel:"noopener noreferrer",className:"coz-fg-hglt ml-1 no-underline",children:c.o.t("memory_library_general_long_term_memory_quota_descript")})]})]}),h?(0,s.jsx)(et.mw,{onClick:e=>{e.stopPropagation(),e.preventDefault(),v(!1),x()},children:c.o.t("memory_library_general_upgrade_get_more_memory")}):null]})});return(0,s.jsxs)(s.Fragment,{children:[p,(0,s.jsx)(m.Popover,{stopPropagation:!0,content:f,trigger:"hover",position:"bottom",className:a,visible:_,onVisibleChange:v,children:(0,s.jsx)(m.Tag,{color:"yellow",prefixIcon:(0,s.jsx)(C.sWZ,{}),size:d,children:(0,s.jsxs)("span",{children:[el(Number(null==u?void 0:null===(n=u.data)||void 0===n?void 0:n.total_memory_items_cnt)||0),c.o.t("memory_library_general_count_quota")]})})})]})},ea=e=>{var r,o,t,l,n,{className:a,memorybaseInfo:d}=e,{node:u,open:p}=(0,eo.zv)({scene:eo.ej.MemoryLibrary}),[x,h]=(0,i.useState)(!1),y=null==d?void 0:null===(o=d.data)||void 0===o?void 0:null===(r=o.volcano_account_info)||void 0===r?void 0:r.can_upgrade,_=es((null==d?void 0:d.data)||{}),v=(0,s.jsx)("div",{className:"w-80 py-3 px-4",children:(0,s.jsxs)("div",{className:"relative z-10 flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(C.sWZ,{className:"coz-fg-hglt"}),(0,s.jsx)("span",{className:"text-[16px] coz-fg-plus font-medium",children:c.o.t("memory_library_general_continue_write",{count:el(Number(null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.remain_memory_items_cnt)||0)})})]}),(0,s.jsxs)("ul",{className:"text-[14px] coz-fg-primary m-0 pl-[20px]",children:[(0,s.jsxs)("li",{children:[_,c.o.t("memory_library_general_memory_lib_9",{count:el(Number(null==d?void 0:null===(l=d.data)||void 0===l?void 0:l.total_memory_items_cnt)||0)})]}),(0,s.jsxs)("li",{children:[c.o.t("memory_library_general_more_description_see_details"),(0,s.jsx)("a",{href:"https://www.coze.cn/open/docs/guides/long_term_memory#42e2a675",target:"_blank",rel:"noopener noreferrer",className:"coz-fg-hglt ml-1 no-underline",children:c.o.t("memory_library_general_long_term_memory_quota_descript")})]})]}),y?(0,s.jsx)(et.mw,{onClick:()=>{h(!1),p()},children:c.o.t("memory_library_general_upgrade_get_more_memory")}):null]})});return(0,s.jsxs)(s.Fragment,{children:[u,(0,s.jsx)(m.Popover,{stopPropagation:!0,content:v,trigger:"hover",position:"bottom",className:a,visible:x,onVisibleChange:h,children:(0,s.jsx)(m.Tag,{color:"brand",prefixIcon:(0,s.jsx)(C.sWZ,{}),children:(0,s.jsx)("span",{children:c.o.t("memory_library_general_text",{count:el(Number(null==d?void 0:null===(n=d.data)||void 0===n?void 0:n.used_memory_items_cnt)||0)})})})})]})},ed=e=>{var{className:r,recycleTime:o,renderTrigger:t,showUpgradeButton:l=!0,customTitle:n}=e,{node:i,open:a}=(0,eo.zv)({scene:eo.ej.MemoryLibrary}),d=Math.ceil((Number(o)-Date.now())/864e5),u=(0,s.jsx)("div",{className:"w-80 p-3",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"relative z-10 flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(C.sWZ,{className:"coz-fg-hglt"}),(0,s.jsx)("span",{className:"text-[16px] coz-fg-plus font-medium",children:n||c.o.t("memory_library_action_account_arrears_data_days",{recycleDays:d})})]}),(0,s.jsxs)("ul",{className:"text-[14px] coz-fg-primary m-0 pl-[20px]",children:[(0,s.jsxs)("li",{children:[c.o.t("memory_library_action_delete_date"),Y()(Number(o)).format("YYYY.MM.DD")]}),(0,s.jsxs)("li",{children:[c.o.t("memory_library_general_more_description_see_details"),(0,s.jsx)("a",{href:"https://www.coze.cn/open/docs/guides/long_term_memory#42e2a675",target:"_blank",rel:"noopener noreferrer",className:"coz-fg-hglt ml-1 no-underline",children:c.o.t("memory_library_general_long_term_memory_data_descripti")})]})]}),l?(0,s.jsx)(et.mw,{onClick:e=>{e.stopPropagation(),a()},children:c.o.t("memory_library_general_immediately_renew")}):null]})});return(0,s.jsxs)(s.Fragment,{children:[i,(0,s.jsx)(m.Popover,{content:u,trigger:"hover",position:"bottom",className:r,children:t(d)})]})},ec=e=>{var r,{memorybaseInfo:o}=e;return(0,s.jsx)(ed,{recycleTime:(null===(r=o.data)||void 0===r?void 0:r.recycle_time)||"",renderTrigger:e=>(0,s.jsx)(m.Tag,{color:"red",children:c.o.t("memory_library_action_data_will_be_days_after",{recycleDays:e})})})},em=()=>{var e,r,o,{memorybaseInfo:t}=M((0,h.N)(e=>({memorybaseInfo:e.memorybaseInfo})));return(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.recycle_status)&&(null==t?void 0:null===(r=t.data)||void 0===r?void 0:r.recycle_status)!==er.qr.Normal?(0,s.jsx)(ec,{memorybaseInfo:t}):(null==t?void 0:null===(o=t.data)||void 0===o?void 0:o.exceed_limit)?(0,s.jsx)(ei,{memorybaseInfo:t}):(0,s.jsx)(ea,{memorybaseInfo:t})},eu=()=>{var e,r,o,t,l,i=(0,Q.useNavigate)(),a=(0,Q.useParams)(),{memorybaseInfo:d,memorybaseId:u,searchValue:p,selectedConnectorIds:y,setSearchValue:_,setSelectedConnectorIds:v,updateMemorybaseInfoByImmer:f}=M((0,h.N)(e=>({memorybaseInfo:e.memorybaseInfo,updateMemorybaseInfoByImmer:e.updateMemorybaseInfoByImmer,memorybaseId:e.memorybaseId,searchValue:e.searchValue,selectedConnectorIds:e.selectedConnectorIds,setSearchValue:e.setSearchValue,setSelectedConnectorIds:e.setSelectedConnectorIds}))),{connectorList:g}=ee({spaceId:null!==(t=a.space_id)&&void 0!==t?t:""}),{modal:j,open:b}=x({spaceId:null!==(l=a.space_id)&&void 0!==l?l:"",libraryId:u,mode:"edit",onSuccess:e=>{f(r=>{if(!!r.memorybaseInfo.data)r.memorybaseInfo.data.name=e.name,r.memorybaseInfo.data.desc=e.description})}}),{deleteMemorybase:I,loading:N}=$();return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[j,(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.IconButton,{color:"secondary",icon:(0,s.jsx)(C.$1i,{className:"text-[24px]"}),iconPosition:"left",onClick:()=>{i("/space/".concat(a.space_id,"/library"))},className:"w-6 h-6 flex-shrink-0"}),(0,s.jsx)(D.FKX,{className:"text-[24px] flex-shrink-0"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.Typography.Text,{className:"text-[16px] font-medium leading-[22px]",weight:500,ellipsis:{showTooltip:{opts:{content:null==d?void 0:null===(e=d.data)||void 0===e?void 0:e.name}}},children:null==d?void 0:null===(r=d.data)||void 0===r?void 0:r.name}),(null===(o=d.data)||void 0===o?void 0:o.can_edit)?(0,s.jsx)(m.Tooltip,{content:c.o.t("datasets_segment_edit"),children:(0,s.jsx)(m.IconButton,{size:"mini",color:"secondary",icon:(0,s.jsx)(C.JAz,{className:"text-[12px]"}),iconPosition:"left",wrapperClass:"text-[0] leading-none",className:"coz-fg-secondary w-3 h-3 flex-shrink-0",onClick:b})}):null]})}),(0,s.jsx)(em,{})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Search,{placeholder:c.o.t("memory_library_general_search_user"),value:p,onChange:e=>_(e),className:"w-[235px]"}),(0,s.jsx)(m.Select,{multiple:!0,placeholder:c.o.t("memory_library_form_select_channel"),maxTagCount:2,value:y,onChange:e=>v(e),className:"min-w-[173px]",children:g.map(e=>(0,s.jsx)(m.Select.Option,{value:e.connectorId,children:e.connectorName},e.connectorId))}),(0,s.jsx)(m.Button,{onClick:()=>window.open("https://www.coze.cn/open/docs/guides/long_term_memory#42e2a675","_blank"),color:"primary",children:c.o.t("memory_library_general_billing_detail_reference")}),(0,s.jsx)(m.Button,{onClick:()=>{m.Modal.confirm({title:c.o.t("memory_library_action_confirm_delete_memory_lib"),content:c.o.t("memory_library_action_delete_after_rollback"),okButtonProps:{className:"!coz-mg-hglt-plus-red"},okText:c.o.t("Delete"),cancelText:c.o.t("Cancel"),onOk:(0,n._)(function*(){yield I(),i("/space/".concat(a.space_id,"/library"))})})},color:"primary",icon:(0,s.jsx)(C.dVD,{}),loading:N})]})]})},ep=e=>{var{memorybaseId:r,className:o}=e;return(0,s.jsx)(N,{className:o,renderNavBar:()=>(0,s.jsx)(eu,{}),renderContent:()=>(0,s.jsx)(J,{}),memorybaseId:r})},ex=e=>(0,n._)(function*(){var r,o=yield u.v6.ListMemorybase({space_id:e.spaceId,name:e.searchValue||void 0,search_scope:e.scope,offset:e.offset||0,limit:e.limit||20,order_by:[{field:"update_time",direction:er.Sr.Desc}]});if(0===o.code)return{list:o.memorybase_info_list||[],hasMore:o.has_more||!1,totalCount:null===(r=o.total_count)||void 0===r?void 0:r.toString()};throw Error(o.msg||"\u83B7\u53D6\u8BB0\u5FC6\u5E93\u5217\u8868\u5931\u8D25")})(),eh=e=>{var r,{spaceId:o,searchValue:t,scope:l,containerRef:s}=e;return(0,k.Z)((r=(0,n._)(function*(e){var r=e?e.list.length:0;return yield ex({spaceId:o,searchValue:t,offset:r,limit:20,scope:l})}),function(e){return r.apply(this,arguments)}),{target:s,isNoMore:e=>!(null==e?void 0:e.hasMore),reloadDeps:[t,l,o],manual:!1})},ey=e=>(0,s.jsxs)("svg",(0,v._)((0,_._)({xmlns:"http://www.w3.org/2000/svg",width:366,height:184,fill:"none",viewBox:"0 0 366 184"},e),{children:[(0,s.jsxs)("g",{opacity:.4,children:[(0,s.jsx)("mask",{id:"icon-query-empty_svg__b",width:366,height:184,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"},children:(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__a)",d:"M.455.728h365.09v182.545H.455z"})}),(0,s.jsxs)("g",{mask:"url(#icon-query-empty_svg__b)",children:[(0,s.jsx)("mask",{id:"icon-query-empty_svg__d",width:366,height:184,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"},children:(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__c)",d:"M.455.728h365.09v182.545H.455z"})}),(0,s.jsxs)("g",{stroke:"#3C445C",strokeWidth:.634,mask:"url(#icon-query-empty_svg__d)",children:[(0,s.jsx)("path",{d:"M.455.728h30.424v30.424H.455z"}),(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__e)",d:"M30.879.728h30.424v30.424H30.879z"}),(0,s.jsx)("path",{d:"M61.303.728h30.424v30.424H61.303zM91.728.728h30.424v30.424H91.728zM122.152.728h30.424v30.424h-30.424zM152.576.728H183v30.424h-30.424zM183 .728h30.424v30.424H183zM213.424.728h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M243.848.728h30.424v30.424h-30.424zM274.272.728h30.424v30.424h-30.424zM304.697.728h30.424v30.424h-30.424zM335.121.728h30.424v30.424h-30.424zM.455 31.151h30.424v30.424H.455zM30.879 31.151h30.424v30.424H30.879zM61.303 31.151h30.424v30.424H61.303zM91.728 31.151h30.424v30.424H91.728z"}),(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__f)",d:"M122.152 31.151h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M152.576 31.151H183v30.424h-30.424zM183 31.151h30.424v30.424H183zM213.424 31.151h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M243.848 31.151h30.424v30.424h-30.424zM274.272 31.151h30.424v30.424h-30.424zM304.697 31.151h30.424v30.424h-30.424zM335.121 31.151h30.424v30.424h-30.424zM.455 61.576h30.424V92H.455zM30.879 61.576h30.424V92H30.879zM61.303 61.576h30.424V92H61.303zM91.728 61.576h30.424V92H91.728zM122.152 61.576h30.424V92h-30.424zM152.576 61.576H183V92h-30.424zM183 61.576h30.424V92H183z"}),(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__g)",d:"M213.424 61.576h30.424V92h-30.424z"}),(0,s.jsx)("path",{d:"M243.848 61.576h30.424V92h-30.424zM274.272 61.576h30.424V92h-30.424zM304.697 61.576h30.424V92h-30.424zM335.121 61.576h30.424V92h-30.424zM.455 92h30.424v30.424H.455zM30.879 92h30.424v30.424H30.879zM61.303 92h30.424v30.424H61.303zM91.728 92h30.424v30.424H91.728zM122.152 92h30.424v30.424h-30.424zM152.576 92H183v30.424h-30.424zM183 92h30.424v30.424H183zM213.424 92h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M243.848 92h30.424v30.424h-30.424zM274.272 92h30.424v30.424h-30.424zM304.697 92h30.424v30.424h-30.424zM335.121 92h30.424v30.424h-30.424zM.455 122.424h30.424v30.424H.455zM30.879 122.424h30.424v30.424H30.879zM61.303 122.424h30.424v30.424H61.303zM91.728 122.424h30.424v30.424H91.728zM122.152 122.424h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__h)",d:"M152.576 122.424H183v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M183 122.424h30.424v30.424H183zM213.424 122.424h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M243.848 122.424h30.424v30.424h-30.424zM274.272 122.424h30.424v30.424h-30.424zM304.697 122.424h30.424v30.424h-30.424zM335.121 122.424h30.424v30.424h-30.424zM.455 152.849h30.424v30.424H.455zM30.879 152.849h30.424v30.424H30.879zM61.303 152.849h30.424v30.424H61.303zM91.728 152.849h30.424v30.424H91.728zM122.152 152.849h30.424v30.424h-30.424zM152.576 152.849H183v30.424h-30.424zM183 152.849h30.424v30.424H183zM213.424 152.849h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M243.848 152.849h30.424v30.424h-30.424zM274.272 152.849h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__i)",d:"M304.697 152.849h30.424v30.424h-30.424z"}),(0,s.jsx)("path",{d:"M335.121 152.849h30.424v30.424h-30.424z"})]})]})]}),(0,s.jsx)("rect",{width:177.474,height:64.651,x:94.263,y:118.615,fill:"#fff",rx:5.071}),(0,s.jsx)("rect",{width:176.84,height:64.017,x:94.58,y:118.932,stroke:"#060709",strokeOpacity:.1,strokeWidth:.634,rx:4.754}),(0,s.jsx)("rect",{width:65.919,height:8.874,x:104.404,y:130.024,fill:"#060709",fillOpacity:.3,rx:4.437}),(0,s.jsx)("rect",{width:111.555,height:8.874,x:104.404,y:143.969,fill:"#060709",fillOpacity:.3,rx:4.437}),(0,s.jsxs)("g",{filter:"url(#icon-query-empty_svg__j)",children:[(0,s.jsx)("path",{fill:"url(#icon-query-empty_svg__k)",d:"M223.565 141.434c0-7.002 5.676-12.677 12.677-12.677h12.677c7.001 0 12.677 5.675 12.677 12.677s-5.676 12.676-12.677 12.676h-12.677c-7.001 0-12.677-5.675-12.677-12.676"}),(0,s.jsx)("path",{stroke:"#000",strokeOpacity:.08,strokeWidth:.127,d:"M236.242 128.82h12.677c6.966 0 12.613 5.647 12.613 12.614 0 6.966-5.647 12.613-12.613 12.613h-12.677c-6.966 0-12.613-5.647-12.613-12.613 0-6.967 5.647-12.614 12.613-12.614Z"})]}),(0,s.jsx)("rect",{width:157.191,height:8.874,x:104.404,y:164.251,fill:"#060709",fillOpacity:.3,rx:4.437}),(0,s.jsxs)("defs",{children:[(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__a",x1:365.545,x2:.455,y1:92,y2:92,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:0}),(0,s.jsx)("stop",{offset:.5,stopColor:"#D9D9D9"}),(0,s.jsx)("stop",{offset:1,stopColor:"#D9D9D9",stopOpacity:0})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__c",x1:183,x2:183,y1:.728,y2:183.272,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#D9D9D9",stopOpacity:0}),(0,s.jsx)("stop",{offset:.494,stopColor:"#D9D9D9"}),(0,s.jsx)("stop",{offset:1,stopColor:"#D9D9D9",stopOpacity:0})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__e",x1:46.092,x2:46.092,y1:.728,y2:31.152,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#3C445C",stopOpacity:0}),(0,s.jsx)("stop",{offset:1,stopColor:"#3C445C"})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__f",x1:137.364,x2:137.364,y1:31.151,y2:61.575,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#3C445C",stopOpacity:0}),(0,s.jsx)("stop",{offset:1,stopColor:"#3C445C"})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__g",x1:228.636,x2:228.636,y1:61.576,y2:92,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#3C445C",stopOpacity:0}),(0,s.jsx)("stop",{offset:1,stopColor:"#3C445C"})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__h",x1:167.788,x2:167.788,y1:122.424,y2:152.848,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#3C445C",stopOpacity:0}),(0,s.jsx)("stop",{offset:1,stopColor:"#3C445C"})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__i",x1:319.909,x2:319.909,y1:152.849,y2:183.273,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#3C445C",stopOpacity:0}),(0,s.jsx)("stop",{offset:1,stopColor:"#3C445C"})]}),(0,s.jsxs)("linearGradient",{id:"icon-query-empty_svg__k",x1:242.581,x2:242.581,y1:128.757,y2:154.11,gradientUnits:"userSpaceOnUse",children:[(0,s.jsx)("stop",{stopColor:"#F45D68"}),(0,s.jsx)("stop",{offset:1,stopColor:"#FFCA00"})]}),(0,s.jsxs)("filter",{id:"icon-query-empty_svg__j",width:48.896,height:36.219,x:218.133,y:125.135,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,s.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,s.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,s.jsx)("feOffset",{dy:1.811}),(0,s.jsx)("feGaussianBlur",{stdDeviation:2.716}),(0,s.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,s.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09 0"}),(0,s.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1143_835766"}),(0,s.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1143_835766",result:"shape"})]})]})]})),e_=new class e{highlightText(e,r){if(!r)return e;var o=e.split(RegExp("(".concat(r,")"),"gi"));return(0,s.jsx)(s.Fragment,{children:o.map((e,o)=>e.toLowerCase()===r.toLowerCase()?(0,s.jsx)("span",{className:"coz-fg-hglt-yellow",children:e},o):e)})}},ev=e=>{var{memoryLibrary:r,searchValue:o,onClick:t}=e;return(0,s.jsx)("div",{className:w()("group relative flex items-center p-4 cursor-pointer transition-all duration-200","border-b coz-stroke-primary border-solid border-0","hover:bg-[#F5F5F7] hover:rounded-lg"),onClick:t,children:(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("img",{className:"w-[36px] h-[36px] rounded-lg object-cover border border-[#e2e4ef]",src:"data:image/png;base64,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"})}),(0,s.jsxs)("div",{className:"flex flex-col flex-1 min-w-0 gap-[6px]",children:[(0,s.jsx)(m.Typography.Text,{className:"!text-[14px] !font-medium !coz-fg-primary block truncate leading-5",ellipsis:!0,children:e_.highlightText(r.name||c.o.t("memory_library_general_unnamed_memory_lib"),o)}),r.desc?(0,s.jsx)(m.Typography.Text,{className:"text-xs text-[#2029459e] block truncate leading-4",ellipsis:!0,children:e_.highlightText(r.desc,o)}):null,(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsxs)(m.Tag,{size:"small",color:"primary",className:"h-4 text-xs",children:[el(Number(r.total_memory_items_cnt)),c.o.t("memory_library_general_count")]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs coz-fg-secondary",children:[r.avatar_url?(0,s.jsx)("img",{className:"w-[14px] h-[14px] rounded-lg object-cover border border-[#e2e4ef]",src:r.avatar_url}):null,(0,s.jsx)("span",{children:r.creator_name}),(0,s.jsx)(m.Divider,{className:"h-2",layout:"vertical"}),(0,s.jsx)("span",{children:Y().unix(Number(r.update_time)).format("YYYY-MM-DD HH:mm")})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsx)(m.Button,{color:"primary",className:"w-[88px]",children:c.o.t("memory_library_general_add")})})]})})},ef=e=>{var{loading:r,loadingMore:o,noMore:t,data:l,searchValue:n,onSelect:i}=e;return r?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)(m.Spin,{})}):(null==l?void 0:l.list.length)?(0,s.jsx)("div",{className:"h-full overflow-y-auto styled-scrollbar",children:(0,s.jsxs)("div",{children:[l.list.map(e=>(0,s.jsx)(ev,{memoryLibrary:e,searchValue:n,onClick:()=>i(e)},e.id)),o?(0,s.jsxs)("div",{className:"flex items-center justify-center py-6",children:[(0,s.jsx)(m.IconButton,{icon:(0,s.jsx)(C.j2n,{}),loading:!0,color:"secondary",className:"!w-6 !h-6"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-[#666666]",children:c.o.t("memory_library_general_load")})]}):null,t&&l.list.length>0?(0,s.jsx)("div",{className:"text-center py-6 text-sm text-[#999999]",children:c.o.t("memory_library_general_load_all_memory_lib")}):null]})}):(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,s.jsx)(C.nL$,{className:"w-12 h-12 text-[#B8B8C7]"}),(0,s.jsx)("div",{className:"text-sm text-[#666666] mt-3",children:c.o.t("memory_library_general_empty_memory_lib")})]})},eg=e=>{var{visible:r,spaceId:o,isPersonal:t,onSelect:l,onCreate:n,onCancel:a}=e,d=(0,i.useRef)(null),[u,p]=(0,i.useState)(""),[h,y]=(0,i.useState)(er.Cn.All),{loading:_,data:v,loadingMore:f,noMore:g,reload:j}=eh({spaceId:o,searchValue:u,scope:h,containerRef:d}),{open:b,modal:M}=x({spaceId:o,mode:"create",onSuccess:e=>{var{memoryLibraryId:r}=e;j(),null==n||n(r)}});return(0,s.jsx)(m.Modal,{visible:r,onCancel:a,width:800,title:c.o.t("memory_library_form_select_long_term_memory"),footer:null,centered:!0,children:(0,s.jsxs)("div",{className:"flex flex-col h-[588px]",children:[(0,s.jsx)("div",{className:"flex items-center justify-between py-4 border-b border-[#E8E8F0]",children:(0,s.jsxs)("div",{className:"flex justify-between items-center w-full",children:[t?null:(0,s.jsxs)(m.Select,{value:h,onChange:e=>y(e),style:{width:115},placeholder:c.o.t("memory_library_general_everyone"),children:[(0,s.jsx)(m.Select.Option,{value:er.Cn.All,children:c.o.t("memory_library_general_everyone")}),(0,s.jsx)(m.Select.Option,{value:er.Cn.CreateByMe,children:c.o.t("memory_library_general_only_self")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,s.jsx)(m.Search,{placeholder:c.o.t("memory_library_general_search"),value:u,onChange:p,showClear:!0,style:{width:146}}),(0,s.jsx)(m.Button,{color:"highlight",icon:(0,s.jsx)(C.PwN,{}),iconPosition:"left",onClick:b,children:c.o.t("memory_library_general_create")})]})]})}),(0,s.jsx)("div",{ref:d,className:"flex-1 overflow-hidden",children:_||(null==v?void 0:v.list.length)?(0,s.jsx)(ef,{loading:_,loadingMore:f,noMore:g,data:v,searchValue:u,onSelect:e=>{null==l||l(e)}}):(0,s.jsx)("div",{className:"flex flex-col justify-center items-center h-full",children:(0,s.jsx)(m.EmptyState,{icon:(0,s.jsx)(ey,{}),title:u?c.o.t("memory_library_general_empty_search_result"):c.o.t("memory_library_general_empty_memory_lib")})})}),M]})})},ej=e=>{var{spaceId:r,onSelect:o,onCreate:t,isPersonal:l}=e,[n,a]=(0,i.useState)(!1);return{open:()=>a(!0),close:()=>a(!1),modal:n&&(0,s.jsx)(eg,{visible:!0,spaceId:r,isPersonal:l,onSelect:e=>{null==o||o(e),a(!1)},onCreate:t,onCancel:()=>a(!1)})}},eb=o("556923"),eM=o("301464"),eI=o("244189");function eN(e){var{showTitle:r,showSubType:o,className:t}=e,l=["17934556361","17934556363"],[n,d]=(0,i.useState)([]),c=n.length>1,[p,x]=(0,i.useState)(l[0]),h=n.find(e=>e.resource_id===p),y=l.join(","),{loading:_}=(0,a.Z)(()=>u.c3.PublicGetResourceBillingDetail({resource_type:eI.ol.LongTermMemory,resource_ids:l},{paramsSerializer:e=>eM.Z.stringify(e,{arrayFormat:"comma"})}),{refreshDeps:[y],onBefore:()=>{d([]),x("")},onSuccess:e=>{var r,o,t,l,n=null!==(t=null===(r=e.data)||void 0===r?void 0:r.resource_billing_details)&&void 0!==t?t:[];d(n),x(null!==(l=null===(o=n[0])||void 0===o?void 0:o.resource_id)&&void 0!==l?l:"")}});return _?(0,s.jsx)(m.Spin,{spinning:!0,wrapperClassName:w()("w-full",t),style:{minHeight:130}}):(0,s.jsxs)(s.Fragment,{children:[c?(0,s.jsx)("div",{className:"flex gap-[6px] mb-[12px] flex-wrap",children:n.map(e=>{var r=e.resource_id===p;return(0,s.jsx)(m.Button,{color:r?"highlight":"secondary",onClick:()=>{var r;return x(null!==(r=e.resource_id)&&void 0!==r?r:"")},className:w()("!border border-solid",{"coz-stroke-hglt":r,"coz-stroke-primary":!r}),children:e.resource_name},e.resource_id)})}):null,h?(0,s.jsx)(ez,{billing:h,showTitle:!c&&!1!==r,showSubType:o,className:"w-full"}):null]})}function ez(e){var r,o,t,{billing:l,showTitle:n,showSubType:i,className:a}=e,{extra_info:d,billing_standards:u,default_benefit_amount:p}=l,x=null==u?void 0:u.some(e=>e.billing_cost),h=null==p?void 0:p[eI.Sj.PluginRunQPS],y=null==h?void 0:null===(r=h.find(e=>e.user_level===eI.aZ.ProPersonal||e.user_level===eI.aZ.Team))||void 0===r?void 0:r.default_amount,_=null==h?void 0:null===(o=h.find(e=>e.user_level===eI.aZ.Enterprise))||void 0===o?void 0:o.default_amount;return(0,s.jsxs)("div",{className:w()("flex flex-col gap-[12px]",a),children:[n?(0,s.jsxs)(m.Typography.Title,{fontSize:"14px",children:[l.resource_name,i?(0,s.jsx)(m.Tag,{color:"brand",className:"font-medium shrink-0 ml-[8px]",style:{height:20,padding:"2px 4px"},prefixIcon:(0,s.jsx)(C.sWZ,{className:"coz-fg-hglt text-[14px]"}),children:c.o.t(l.sub_type===eI.Op.Official?"official_payment":"third_party_payment")}):null]}):null,(null==d?void 0:d.notify_content)?(0,s.jsx)("div",{className:"h-[32px] px-[16px] py-[8px] flex items-center justify-center rounded-[8px] coz-mg-hglt-secondary",children:(0,s.jsx)(m.Typography.Text,{fontSize:"14px",children:d.notify_content})}):null,(0,s.jsxs)("div",{className:"flex flex-col gap-[6px]",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(m.Typography.Title,{fontSize:"14px",children:c.o.t("plugin_billing_strandard")})}),(0,s.jsxs)("div",{className:"flex flex-col p-[8px] text-end coz-mg-secondary coz-fg-secondary border-[0.5px] border-solid coz-stroke-primary rounded-[8px]",children:[(0,s.jsxs)("div",{className:"h-[24px] flex items-center text-[12px] font-medium border-0 border-b border-solid coz-stroke-primary",children:[(0,s.jsx)("div",{className:"px-[8px] grow text-start",children:c.o.t("billing_item")}),x?(0,s.jsx)("div",{className:"px-[8px] basis-[120px]",children:c.o.t("plugin_consumption")}):null,(0,s.jsx)("div",{className:"px-[8px] basis-[120px]",children:c.o.t("plugin_free_quota")}),(0,s.jsx)("div",{className:"px-[8px] basis-[80px]",children:c.o.t("plugin_price")})]}),null===(t=l.billing_standards)||void 0===t?void 0:t.map((e,r)=>(0,s.jsxs)("div",{className:"h-[40px] flex items-center text-[14px]",children:[(0,s.jsx)("div",{className:"px-[8px] grow text-start",children:e.billing_name}),x?(0,s.jsx)("div",{className:"px-[8px] basis-[120px]",children:e.billing_cost}):null,(0,s.jsx)("div",{className:"px-[8px] basis-[120px]",children:e.free_quota}),(0,s.jsx)("div",{className:"px-[8px] basis-[80px] font-medium coz-fg-primary",children:e.billing_price})]},r))]}),l.sub_type===eI.Op.WyThirdParty?(0,s.jsx)(m.Typography.Text,{fontSize:"14px",type:"secondary",children:c.o.t("plugin_billing_third_party_tip")}):null]}),(null==h?void 0:h.length)?(0,s.jsxs)("div",{className:"flex flex-col gap-[6px]",children:[(0,s.jsx)(m.Typography.Title,{fontSize:"14px",children:c.o.t("plugin_single_account_amount")}),(0,s.jsxs)(m.Typography.Text,{fontSize:"14px",type:"secondary",children:["".concat(c.o.t("enterprise_amount")," ").concat(_,"QPS"),(0,s.jsx)("span",{className:"inline-block w-[24px]",children:" "}),"".concat(c.o.t("non_enterprise_amount")," ").concat(y,"QPS")]})]}):null,(null==d?void 0:d.billing_case)?(0,s.jsxs)("div",{className:"flex flex-col gap-[6px]",children:[(0,s.jsx)(m.Typography.Title,{fontSize:"14px",children:c.o.t("billing_example")}),(0,s.jsx)(m.Typography.Text,{fontSize:"14px",type:"secondary",children:null==d?void 0:d.billing_case})]}):null]})}function ew(e){var{groupTitle:r,showSubType:o=!1,visible:t,trigger:l,position:n,onVisibleChange:a,onMouseEnter:d,onMouseLeave:u}=e,p=(0,eb._)(e,["groupTitle","showSubType","visible","trigger","position","onVisibleChange","onMouseEnter","onMouseLeave"]),[x,h]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t&&h(!0)},[t]),(0,s.jsx)(m.Popover,(0,_._)({visible:t,onVisibleChange:a,style:{padding:0,width:560,maxHeight:640},showArrow:!1,position:n,spacing:{x:12,y:0},trigger:l,keepDOM:!0,content:(0,s.jsxs)("div",{className:"p-[16px] flex flex-col gap-[12px]",onClick:e=>e.stopPropagation(),onMouseEnter:d,onMouseLeave:u,children:[r?(0,s.jsx)(m.Typography.Text,{fontSize:"14px",weight:500,children:c.o.t("contains_multiple_paid_plugins",{group:r,num:2})}):null,x?(0,s.jsx)(eN,{showSubType:o}):null]})},p))}}}]);
//# sourceMappingURL=https://sourcemap-redirect.coze.cn/obj/coze-sourcemap/ol-sourcemap/bot/1.0.2.2232/71072.21ea7dba.js.map