# 深色模式颜色配置说明

## 问题描述

在深色模式下，浏览历史页面和清空弹窗的文字和背景对比度很差，几乎看不清内容。

## 解决方案

为深色模式添加了完整的颜色定义，确保在浅色和深色模式下都有良好的可读性。

## 颜色配置对比

### 浅色模式 (base/element/color.json)

| 颜色名称 | 值 | 用途 | 说明 |
|---------|-----|------|------|
| `text_primary` | `#FF000000` | 主要文字 | 黑色，用于标题和重要文字 |
| `text_secondary` | `#99000000` | 次要文字 | 60% 透明度的黑色 |
| `button_secondary_bg` | `#1A000000` | 次要按钮背景 | 10% 透明度的黑色 |
| `news_list_item_bg` | `#FFFFFFFF` | 列表项背景 | 白色 |
| `dialog_bg` | `#FFFFFFFF` | 对话框背景 | 白色 |
| `dialog_mask` | `#80000000` | 对话框遮罩 | 50% 透明度的黑色 |
| `brand` | `#FF3042FF` | 品牌色 | 蓝色，用于主要按钮 |

### 深色模式 (dark/element/color.json)

| 颜色名称 | 值 | 用途 | 说明 |
|---------|-----|------|------|
| `text_primary` | `#FFFFFFFF` | 主要文字 | 白色，用于标题和重要文字 |
| `text_secondary` | `#99FFFFFF` | 次要文字 | 60% 透明度的白色 |
| `button_secondary_bg` | `#33FFFFFF` | 次要按钮背景 | 20% 透明度的白色 |
| `news_list_item_bg` | `#1A1A1A` | 列表项背景 | 深灰色 |
| `dialog_bg` | `#2A2A2A` | 对话框背景 | 中灰色 |
| `dialog_mask` | `#CC000000` | 对话框遮罩 | 80% 透明度的黑色 |
| `brand` | `#FF00FFFF` | 品牌色 | 青色，用于主要按钮 |
| `color_change_button_background` | `#FFFFFFFF` | 颜色切换按钮背景 | 白色 |

## 设计原则

### 1. 对比度

**浅色模式**：
- 背景：白色 (#FFFFFF)
- 主要文字：黑色 (#000000)
- 对比度：21:1（WCAG AAA 级别）

**深色模式**：
- 背景：深灰色 (#1A1A1A)
- 主要文字：白色 (#FFFFFF)
- 对比度：18:1（WCAG AAA 级别）

### 2. 层次感

通过不同的背景色创建视觉层次：

**浅色模式**：
```
页面背景（渐变） > 列表项背景（白色 #FFFFFF） > 对话框背景（白色 #FFFFFF）
```

**深色模式**：
```
页面背景（渐变） > 列表项背景（深灰 #1A1A1A） > 对话框背景（中灰 #2A2A2A）
```

### 3. 透明度使用

- **文字透明度**：
  - 主要文字：100% 不透明
  - 次要文字：60% 透明度（#99）
  
- **背景透明度**：
  - 次要按钮：浅色 10%（#1A），深色 20%（#33）
  - 对话框遮罩：浅色 50%（#80），深色 80%（#CC）

### 4. 品牌色适配

- **浅色模式**：蓝色 (#3042FF) - 在白色背景上清晰可见
- **深色模式**：青色 (#00FFFF) - 在深色背景上更加醒目

## 应用位置

### 浏览历史页面

```typescript
// 标题文字
Text('浏览历史')
  .fontColor($r('app.color.text_primary'))  // 自动适配深浅色

// 次要文字（来源、时间）
Text(item.article.source)
  .fontColor($r('app.color.text_secondary'))  // 自动适配深浅色

// 列表项背景
Row() { ... }
  .backgroundColor($r('app.color.news_list_item_bg'))  // 自动适配深浅色
```

### 清空确认对话框

```typescript
// 对话框背景
Column() { ... }
  .backgroundColor($r('app.color.dialog_bg'))  // 自动适配深浅色

// 遮罩层
Column() { ... }
  .backgroundColor($r('app.color.dialog_mask'))  // 自动适配深浅色

// 标题文字
Text('清空历史记录')
  .fontColor($r('app.color.text_primary'))  // 自动适配深浅色

// 次要按钮
Button('取消')
  .backgroundColor($r('app.color.button_secondary_bg'))  // 自动适配深浅色
  .fontColor($r('app.color.text_primary'))  // 自动适配深浅色

// 主要按钮
Button('确定')
  .backgroundColor($r('app.color.brand'))  // 自动适配深浅色
  .fontColor(Color.White)  // 白色在两种模式下都清晰
```

## 颜色资源使用规范

### 1. 使用资源引用

✅ **推荐**：
```typescript
.fontColor($r('app.color.text_primary'))
.backgroundColor($r('app.color.dialog_bg'))
```

❌ **不推荐**：
```typescript
.fontColor('#000000')  // 硬编码，不支持深色模式
.backgroundColor('rgba(0, 0, 0, 0.5)')  // 硬编码，不支持深色模式
```

### 2. 颜色命名规范

- 使用语义化命名：`text_primary`、`button_secondary_bg`
- 避免使用颜色值命名：`black_text`、`white_bg`
- 使用下划线分隔：`dialog_mask`、`news_list_item_bg`

### 3. 新增颜色资源

当需要新增颜色时，必须同时在两个文件中定义：

1. `product/default/src/main/resources/base/element/color.json` - 浅色模式
2. `product/default/src/main/resources/dark/element/color.json` - 深色模式

## 测试建议

### 1. 视觉测试

- [ ] 在浅色模式下查看浏览历史页面
- [ ] 在深色模式下查看浏览历史页面
- [ ] 在浅色模式下打开清空确认对话框
- [ ] 在深色模式下打开清空确认对话框
- [ ] 切换深浅色模式，检查颜色是否正确切换

### 2. 对比度测试

使用对比度检查工具（如 WebAIM Contrast Checker）验证：
- 主要文字与背景的对比度 ≥ 7:1（AAA 级别）
- 次要文字与背景的对比度 ≥ 4.5:1（AA 级别）

### 3. 可读性测试

- [ ] 标题文字清晰可读
- [ ] 次要文字（来源、时间）清晰可读
- [ ] 按钮文字清晰可读
- [ ] 对话框内容清晰可读

## 效果对比

### 修复前 ❌

**深色模式问题**：
- 列表项背景：黑色 (#000000)
- 主要文字：黑色（未定义，使用默认值）
- 结果：黑色文字在黑色背景上，完全看不见

**对话框问题**：
- 对话框背景：黑色
- 标题文字：黑色（未定义）
- 结果：黑色文字在黑色背景上，完全看不见

### 修复后 ✅

**深色模式**：
- 列表项背景：深灰色 (#1A1A1A)
- 主要文字：白色 (#FFFFFF)
- 结果：白色文字在深灰色背景上，清晰可见

**对话框**：
- 对话框背景：中灰色 (#2A2A2A)
- 标题文字：白色 (#FFFFFF)
- 遮罩层：80% 透明度的黑色
- 结果：所有文字清晰可见，层次分明

## 未来优化方向

### 1. 动态颜色

根据系统壁纸自动生成主题色（Material You 风格）

### 2. 自定义主题

允许用户自定义品牌色和强调色

### 3. 高对比度模式

为视力障碍用户提供更高对比度的配色方案

### 4. 颜色无障碍

- 支持色盲模式
- 提供纹理或图案辅助区分

## 总结

通过完善深色模式的颜色配置，现在浏览历史功能在深浅色模式下都有良好的可读性和视觉效果：

✅ **对比度充足** - 文字清晰可读
✅ **层次分明** - 视觉结构清晰
✅ **自动适配** - 无需手动切换
✅ **符合规范** - 遵循 WCAG 无障碍标准

所有颜色都使用资源引用，确保在深浅色模式切换时自动应用正确的颜色值。
